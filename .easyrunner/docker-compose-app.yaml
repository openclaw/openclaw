name: easyrunner
services:
  moltbot-gateway:
    image: localhost/moltbot:latest
    # Override CMD to run the gateway server (Dockerfile default just runs CLI)
    # NOTE: easyrunner currently doesn't support command overrides yet. So for now this fix has been applied to the dockerfile directly.
    # this is not ideal because updates from upstream will overwrite it.
    command: ["node", "dist/index.js", "gateway", "--bind", "lan", "--port", "18789", "--allow-unconfigured"]
    environment:
      - NODE_ENV=production
      - HOME=/home/node
      - TERM=xterm-256color
      # Gateway token for auth - token auth allows skipping device pairing
      # Generate a secure token with: openssl rand -hex 32
      - OPENCLAW_GATEWAY_TOKEN=khs£"$#j3S8lkakhlcpviy£$ASDfjih234%^sSSfkjfoiuz"£
      # State directory for persistent config
      - CLAWDBOT_STATE_DIR=/home/node/.moltbot      
    restart: unless-stopped
    networks:
      - easyrunner_proxy_network
    labels:
      xyz.easyrunner.appFramework: standardbackend
      xyz.easyrunner.appIsPublic: true
      xyz.easyrunner.appContainerInternalPort: 18789
    # Skip volumes for now - rootless Podman has permission issues with named volumes
    # TODO: Add volume mounts once initial deployment works

networks:
  easyrunner_proxy_network:
    name: easyrunner_proxy_network
    external: true
    driver: bridge
