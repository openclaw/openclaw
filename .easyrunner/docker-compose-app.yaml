name: easyrunner
services:
  moltbot-gateway:
    image: localhost/moltbot:latest
    # Uses the docker-entrypoint.sh which creates minimal config on first run
    environment:
      - NODE_ENV=production
      - HOME=/home/node
      - TERM=xterm-256color
      # Gateway token for auth - required for remote CLI access
      # Use only hex characters (a-f, 0-9) to avoid encoding issues
      - OPENCLAW_GATEWAY_TOKEN=79da707a00cce6f610d7dea17e2903346294a4fc8acd2a89021f6c06400b7d31
      # State directory - must match the volume mount path
      - OPENCLAW_STATE_DIR=/home/node/.openclaw
      # Resolve the reverse proxy IP dynamically for trustedProxies
      - OPENCLAW_TRUSTED_PROXY_HOST=systemd-easyrunner__caddy
    restart: unless-stopped
    networks:
      - easyrunner_proxy_network
    labels:
      xyz.easyrunner.appFramework: standardbackend
      xyz.easyrunner.appIsPublic: true
      xyz.easyrunner.appContainerInternalPort: 18789
    volumes:
      # Persistent state directory - stores config, sessions, credentials
      # The :U flag tells Podman to recursively chown the volume to the container user (node, uid 1000)
      - moltbot_state:/home/node/.openclaw:U

volumes:
  moltbot_state:
    driver: local

networks:
  easyrunner_proxy_network:
    name: easyrunner_proxy_network
    external: true
    driver: bridge
