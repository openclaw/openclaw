# CHECKLISTS.md — Детальные алгоритмы для каждого ответа

## Философия

Чеклисты — не бюрократия, а **защита от моих же ошибок**:
- Забываю контекст → PRE заставляет прочитать
- Не слежу инструкциям → POST валидирует перед отправкой
- Теряю память → POST заставляет записать

---

# 🔵 PRE-CHECKLIST (Алгоритм ДО ответа)

## Шаг 1: Загрузка контекста (ВСЕГДА)

```
ЕСЛИ существует SESSION-STATE.md:
  → Прочитать его ПЕРВЫМ
  → Это горячая память — что делаю прямо сейчас
  
ЕСЛИ вопрос о прошлом (когда, что делали, решили, договорились):
  → memory_search по ключевым словам
  → Не гадать, искать

ЕСЛИ начало дня / новая сессия:
  → Прочитать memory/YYYY-MM-DD.md (сегодня)
  → Проверить незакрытые задачи
```

## Шаг 2: Классификация задачи (ОБЯЗАТЕЛЬНО)

```
СКАНИРОВАТЬ сообщение на ключевые слова:

ЕСЛИ содержит [код, фича, баг, сделай, напиши, исправь, implement, fix, create]:
  → ТИП = РАЗРАБОТКА
  → ПРОТОКОЛ = THE LOOP
  → ДЕЙСТВИЕ = Читать skills/the-loop/SKILL.md, запустить Claude Code
  
ЕСЛИ содержит [идея, brainstorm, подумай, что думаешь, обсудим, как считаешь]:
  → ТИП = BRAINSTORM  
  → ПРОТОКОЛ = creative-thought-partner
  → ДЕЙСТВИЕ = Читать скилл, вести диалог по протоколу
  
ЕСЛИ содержит [найди, изучи, ресёрч, проверь что там, узнай]:
  → ТИП = РЕСЁРЧ
  → ПРОТОКОЛ = Subagent spawn
  → ДЕЙСТВИЕ = sessions_spawn с задачей, дождаться результата
  
ЕСЛИ содержит [ошибка, сломалось, не работает, баг, crash]:
  → ТИП = ДИАГНОСТИКА
  → ПРОТОКОЛ = Логи первым делом
  → ДЕЙСТВИЕ = ./scripts/clawlog.sh, session JSONL, потом гипотезы
  
ЕСЛИ содержит [напомни, добавь задачу, запиши]:
  → ТИП = ПАМЯТЬ/ЗАДАЧА
  → ПРОТОКОЛ = cron reminder или memory write
  → ДЕЙСТВИЕ = Записать куда нужно, подтвердить

ИНАЧЕ:
  → ТИП = ПРЯМОЙ ОТВЕТ
  → ПРОТОКОЛ = Краткий точный ответ
  → ДЕЙСТВИЕ = Отвечать без лишнего
```

## Шаг 3: Подготовка скилла (если нужен)

```
ЕСЛИ определён скилл для задачи:
  → Прочитать SKILL.md этого скилла
  → НЕ пропускать, даже если "помню"
  
ЕСЛИ работа с конкретным проектом:
  → Проверить существует ли memory/learnings/{project}.md
  → ЕСЛИ да → прочитать, не повторять ошибки
```

## Шаг 4: Определить формат output

```
ОПРЕДЕЛИТЬ что Влад ожидает получить:
  - Код? → Claude Code, не руками
  - Файл? → Записать в нужное место
  - Текст/ответ? → Краткий, по делу
  - Действие? → Сделать и подтвердить
  
ЗАПИСАТЬ в голове: "Output = ..."
```

---

# 🟢 POST-CHECKLIST (Алгоритм ПОСЛЕ формирования, ДО отправки)

## Шаг 1: Проверка полноты (КРИТИЧНО)

```
ПЕРЕЧИТАТЬ сообщение Влада.
СОСТАВИТЬ список всех пунктов/вопросов.
ПРОВЕРИТЬ: на каждый пункт есть ответ?

ЕСЛИ пропустил что-то:
  → СТОП
  → Дополнить ответ
  → НЕ отправлять неполный ответ

ПРАВИЛО: Output >= Input (ответил на всё + возможно больше)
```

## Шаг 2: Проверка качества

```
СКАНИРОВАТЬ свой ответ на:

❌ ЗАПРЕЩЕНО (удалить если есть):
  - "Отличный вопрос!"
  - "Конечно!"
  - "Буду рад помочь"
  - "Это интересно"
  - Любая вода и корпоратив

✅ ОБЯЗАТЕЛЬНО:
  - Если не уверен → сказать прямо "не уверен в X"
  - Если что-то предположение → пометить как предположение
  - Подтверждение: "Понял, делаю X" или "Записал"
```

## Шаг 3: Проверка стриминга (если работа была долгой)

```
ЕСЛИ работал > 30 секунд:
  → Были ли промежуточные апдейты в чат?
  → ЕСЛИ нет → в следующий раз стримить
  
ЕСЛИ запускал Claude Code / subagent:
  → Стримил ли прогресс?
  → ЕСЛИ нет → ошибка, записать в learnings
```

## Шаг 4: Память (ОБЯЗАТЕЛЬНО КАЖДЫЙ РАЗ)

```
ПОСЛЕ КАЖДОГО обмена сообщениями, ПРОВЕРИТЬ:

ЕСЛИ было новое:
  - Решение (выбрали X вместо Y)
  - Предпочтение Влада (хочет так, не хочет так)
  - Баг/проблема и решение
  - Урок/инсайт
  
  → ЗАПИСАТЬ в memory/YYYY-MM-DD.md (1-3 строки)

ЕСЛИ была МОЯ ошибка:
  - Забыл скилл
  - Не стримил
  - Не ответил на всё
  - Сделал что не просили
  
  → ЗАПИСАТЬ в memory/learnings/global.md
  → Формат: Что / Почему / Фикс

ЕСЛИ контекст задачи изменился:
  → Обновить SESSION-STATE.md

ЕСЛИ ничего значимого:
  → Можно не записывать (рутина типа "ок", "понял")
```

## Шаг 5: Финальная валидация

```
ПЕРЕД ОТПРАВКОЙ, спросить себя:

1. Ответил на ВСЁ что Влад спросил? [да/нет]
2. Нет воды и корпоратива? [да/нет]
3. Если была работа — записал в память? [да/нет]
4. Подтвердил что понял/сделал? [да/нет]

ЕСЛИ хотя бы один [нет]:
  → СТОП
  → Исправить
  → Повторить валидацию
```

---

# 🔴 АЛГОРИТМ ПОЛНОГО ЦИКЛА

```
┌─────────────────────────────────────────────┐
│           ПОЛУЧИЛ СООБЩЕНИЕ                 │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  PRE-CHECKLIST                              │
│  1. Загрузить контекст (SESSION-STATE.md)   │
│  2. Классифицировать задачу → сценарий      │
│  3. Прочитать нужный скилл                  │
│  4. Определить формат output                │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│           ВЫПОЛНЯЮ РАБОТУ                   │
│  - Следую протоколу сценария                │
│  - Стримлю прогресс если > 30 сек           │
│  - Код = через Claude Code                  │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  POST-CHECKLIST                             │
│  1. Проверить полноту (все пункты?)         │
│  2. Проверить качество (нет воды?)          │
│  3. Проверить стриминг (были апдейты?)      │
│  4. Записать в память (если было что)       │
│  5. Финальная валидация                     │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│           ОТПРАВЛЯЮ ОТВЕТ                   │
└─────────────────────────────────────────────┘
```

---

# 📌 ПАМЯТКА (короткая версия для быстрой проверки)

## PRE (до ответа):
1. SESSION-STATE.md?
2. Тип задачи → сценарий?
3. Скилл прочитан?

## POST (до отправки):
1. Ответил на ВСЁ?
2. Нет воды?
3. Память записал?
4. Подтвердил?
