# 2026-02-03

## Настройка PRE/POST чеклистов (07:00-07:45)

### Проблема
Molt ненадёжный: ломается, не следует инструкциям, нет enforcement.

### Что обсудили
- Влад хочет механические проверки в коде, не просто текст в промпте
- Нужны PRE (до ответа) и POST (после ответа) чеклисты
- Нужна валидация что реально выполнено

### Полное решение (в планах)
- Добавить `response:pre` и `response:post` события в Moltbot hooks
- Триггерить из `agent-runner-execution.ts`
- Создать bundled hooks для PRE/POST
- План записан: `notes/projects/pre-post-hooks.md`

### Простое решение (сейчас)
- SOUL.md — алгоритм работы
- PREFLIGHT.md — чеклисты PRE/POST
- IDENTITY.md — добавлен принцип валидации
- SESSION-STATE.md — актуализирован
- Видимый чеклист в конце ответов: `[PRE: ✓] [POST: ✓]`

### Известные поломки (из логов)
- terminated — самая частая, есть auto-retry
- tool_use_id mismatch — repair иногда ломает
- Telegram timeout — после сна мака
- prompt too long — компакция не успевает

### Ошибка Molt
- Изменил файлы без подтверждения Влада — нарушение договорённости
- Записано в learnings
