## Summary

Adds **CoreMemories**: a local-first memory store for OpenClaw that captures recent chat into a lightweight “Flash” layer, supports optional compression into “Warm”, and provides fast keyword-based retrieval.

This PR is designed to be **best-effort** (must never break message handling) and **portable** (no reliance on process cwd).

## What’s included

### 1) New package: `packages/core-memories` (`@openclaw/core-memories`)

- **Flash (hot)**: last ~48h of entries stored on disk
- **Warm (hot)**: compressed entries (rule-based by default; optional Ollama-assisted compression)
- **Per-session storage**: CoreMemories data is stored under a session-scoped directory (passed in via `memoryDir`) so different chats don’t contaminate each other.
- **Per-session index**: `index.json` maintains a simple keyword → entryId map.

### 2) Ingestion hook (best-effort)

- `src/auto-reply/reply/dispatch-from-config.ts` records:
  - inbound user text as `conversation`
  - assistant outputs (tool/block/final/abort text) as `assistant_reply`
- Ingestion uses a deterministic `memoryDir` derived from the agent workspace and sessionKey.
- All ingestion is wrapped in try/catch and is non-blocking.

### 3) Global keyword “links” index (cross-session)

To avoid scanning many session folders when doing keyword lookup, this adds a **global links index**:

- **Write path:** append-only JSONL log
  - `<agentWorkspace>/.openclaw/memory/links/links.jsonl`
- **Read path:** compacted index
  - `<agentWorkspace>/.openclaw/memory/links/index.json`
- **Compaction:** periodic rebuild from JSONL to JSON (best-effort), keeping writes O(1) and reads fast.

### 4) Repo integration

- Root `package.json` includes `@openclaw/core-memories` as `workspace:*` so the gateway’s dynamic import can typecheck in CI.

## Why

- Loading large static memory files at startup doesn’t scale.
- Recent context is valuable, but needs:
  - bounded retention
  - fast retrieval
  - safe persistence
  - isolation between sessions

CoreMemories provides a pragmatic baseline with minimal risk: a keyword index and storage layout that can later be extended (semantic retrieval, UI, better compaction policies) without changing the ingestion contract.

## Storage layout

When `memoryDir` points at a session directory:

- `.../memory/sessions/<session>/hot/flash/current.json`
- `.../memory/sessions/<session>/hot/warm/week-*.json`
- `.../memory/sessions/<session>/index.json`

Global links:

- `.../memory/links/links.jsonl`
- `.../memory/links/index.json`
- `.../memory/links/meta.json`

## Testing

- `pnpm -C packages/core-memories lint`
- `pnpm -C packages/core-memories test`
- `pnpm -w check` (tsgo + lint + format)

## Notes / scope

- Ollama use is optional and best-effort; the system falls back to rule-based compression.
- This PR intentionally focuses on:
  - safe ingestion
  - deterministic storage paths
  - keyword routing (including cross-session via global links)

Follow-ups (not required for merge): richer retrieval UX/tools, semantic retrieval, improved compaction scheduling/config.
