---
summary: "استمرارية أذونات macOS ‏(TCC) ومتطلبات التوقيع"
read_when:
  - استكشاف أخطاء مطالبات أذونات macOS المفقودة أو العالقة
  - حزم تطبيق macOS أو توقيعه
  - تغيير معرّفات الحِزمة أو مسارات تثبيت التطبيق
title: "أذونات macOS"
---

# أذونات macOS ‏(TCC)

منح الأذونات في macOS هشّ. يربط TCC منحة الإذن بتوقيع كود التطبيق، ومعرّف الحِزمة، والمسار على القرص. إذا تغيّر أيٌّ من ذلك، يتعامل macOS مع التطبيق على أنه جديد وقد يُسقِط المطالبات أو يُخفيها.

## المتطلبات لضمان أذونات مستقرة

- المسار نفسه: شغّل التطبيق من موقع ثابت (بالنسبة إلى OpenClaw، `dist/OpenClaw.app`).
- معرّف الحِزمة نفسه: تغيير معرّف الحِزمة ينشئ هوية أذونات جديدة.
- تطبيق مُوقَّع: الإصدارات غير الموقَّعة أو الموقَّعة بتوقيع ad-hoc لا تُحافِظ على الأذونات.
- توقيع متّسق: استخدم شهادة Apple Development أو Developer ID حقيقية
  حتى يبقى التوقيع ثابتًا عبر عمليات إعادة البناء.

تُنشئ توقيعات ad-hoc هوية جديدة مع كل عملية بناء. سينسى macOS المنح السابقة،
وقد تختفي المطالبات تمامًا إلى أن يتم مسح الإدخالات القديمة.

## قائمة الاستعادة عند اختفاء المطالبات

1. أغلِق التطبيق.
2. أزِل إدخال التطبيق في إعدادات النظام -> الخصوصية والأمان.
3. أعد تشغيل التطبيق من المسار نفسه وأعد منح الأذونات.
4. إذا لم تظهر المطالبة بعد، أعد ضبط إدخالات TCC باستخدام `tccutil` وحاول مرة أخرى.
5. بعض الأذونات لا تعود إلا بعد إعادة تشغيل كاملة لنظام macOS.

أمثلة على إعادة الضبط (استبدل معرّف الحِزمة عند الحاجة):

```bash
sudo tccutil reset Accessibility bot.molt.mac
sudo tccutil reset ScreenCapture bot.molt.mac
sudo tccutil reset AppleEvents
```

## أذونات الملفات والمجلدات (سطح المكتب/المستندات/التنزيلات)

قد يقيّد macOS أيضًا الوصول إلى سطح المكتب والمستندات والتنزيلات لعمليات الطرفية/الخلفية. إذا علِقت قراءات الملفات أو قوائم الأدلة، فامنح الوصول لسياق العملية نفسه الذي يُجري عمليات الملفات (مثل Terminal/iTerm، أو تطبيق مُشغَّل عبر LaunchAgent، أو عملية SSH).

حلّ بديل: انقل الملفات إلى مساحة عمل OpenClaw ‏(`~/.openclaw/workspace`) إذا رغبت في تجنّب منح أذونات لكل مجلد على حدة.

إذا كنت تختبر الأذونات، فاحرص دائمًا على التوقيع بشهادة حقيقية. تُعدّ
الإصدارات الموقَّعة بتوقيع ad-hoc مقبولة فقط للتشغيل المحلي السريع حيث لا تهم الأذونات.
