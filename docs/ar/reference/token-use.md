---
summary: "كيف يبني OpenClaw سياق المُحفِّز ويُبلِغ عن استخدام الرموز والتكاليف"
read_when:
  - شرح استخدام الرموز أو التكاليف أو نوافذ السياق
  - تصحيح نمو السياق أو سلوك الضغط
title: "استخدام الرموز والتكاليف"
---

# استخدام الرموز والتكاليف

يتتبّع OpenClaw **الرموز (tokens)**، وليس الأحرف. تختلف الرموز حسب النموذج، لكن معظم
نماذج نمط OpenAI يبلغ متوسطها نحو ~4 أحرف لكل رمز في النص الإنجليزي.

## كيف يتم بناء مُحفِّز النظام

يقوم OpenClaw بتجميع مُحفِّز النظام الخاص به في كل تشغيل. ويتضمن:

- قائمة الأدوات + أوصاف قصيرة
- قائمة Skills (البيانات الوصفية فقط؛ تُحمَّل التعليمات عند الطلب باستخدام `read`)
- تعليمات التحديث الذاتي
- مساحة العمل + ملفات الإقلاع (`AGENTS.md`، `SOUL.md`، `TOOLS.md`، `IDENTITY.md`، `USER.md`، `HEARTBEAT.md`، `BOOTSTRAP.md` عند الإضافة الجديدة). تُقتطع الملفات الكبيرة بواسطة `agents.defaults.bootstrapMaxChars` (الافتراضي: 20000).
- الوقت (UTC + المنطقة الزمنية للمستخدم)
- وسوم الرد + سلوك نبضات الحياة
- بيانات وقت التشغيل الوصفية (المضيف/نظام التشغيل/النموذج/التفكير)

اطّلع على التفصيل الكامل في [System Prompt](/concepts/system-prompt).

## ما الذي يُحتسب ضمن نافذة السياق

كل ما يستلمه النموذج يُحتسب ضمن حدّ السياق:

- مُحفِّز النظام (جميع الأقسام المذكورة أعلاه)
- سجلّ المحادثة (رسائل المستخدم + المساعد)
- استدعاءات الأدوات ونتائج الأدوات
- المرفقات/النصوص المفرَّغة (صور، صوت، ملفات)
- ملخصات للميثاق وقطع الفنون المشبعة
- مغلّفات المزوّد أو رؤوس الأمان (غير مرئية، لكنها تُحتسب)

لتحليل عملي (لكل ملف مُدرج، والأدوات، والـ Skills، وحجم مُحفِّز النظام)، استخدم `/context list` أو `/context detail`. راجع [Context](/concepts/context).

## كيفية عرض استخدام الرموز الحالي

استخدم ما يلي داخل الدردشة:

- `/status` → **بطاقة حالة غنية بالرموز التعبيرية** تعرض نموذج الجلسة، استخدام السياق،
  رموز الإدخال/الإخراج لآخر رد، و**التكلفة التقديرية** (مفتاح API فقط).
- `/usage off|tokens|full` → يضيف **تذييل استخدام لكل رد** إلى كل إجابة.
  - يستمر لكل جلسة (يُخزَّن باسم `responseUsage`).
  - مصادقة OAuth **تُخفي التكلفة** (الرموز فقط).
- `/usage cost` → يعرض ملخص تكلفة محليًا من سجلات جلسة OpenClaw.

واجهات أخرى:

- **TUI/Web TUI:** مدعومان `/status` + `/usage`.
- **CLI:** يعرض `openclaw status --usage` و`openclaw channels list`
  نوافذ حصص المزوّد (وليس تكاليف لكل رد).

## تقدير التكلفة (عند العرض)

تُقدَّر التكاليف من تهيئة تسعير النموذج لديك:

```
models.providers.<provider>.models[].cost
```

هذه **دولارات أمريكية لكل 1 مليون رمز** لـ `input` و`output` و`cacheRead` و
`cacheWrite`. إذا كانت التسعيرة مفقودة، يعرض OpenClaw عدد الرموز فقط. رموز OAuth
لا تُظهر تكلفة بالدولار مطلقًا.

## تأثير TTL للتخزين المؤقت والتقليم

ينطبق التخزين المؤقت لمُحفِّز المزوّد فقط ضمن نافذة TTL للتخزين المؤقت. يمكن لـ OpenClaw
تشغيل **تقليـم cache-ttl** اختياريًا: حيث يُقلِّم الجلسة بمجرد انتهاء TTL للتخزين المؤقت،
ثم يعيد تعيين نافذة التخزين المؤقت بحيث يمكن للطلبات اللاحقة إعادة استخدام السياق
المخزَّن حديثًا بدلًا من إعادة تخزين السجل الكامل. يُبقي ذلك تكاليف كتابة التخزين المؤقت
أقل عندما تبقى الجلسة خاملة بعد تجاوز TTL.

قم بتهيئته في [تهيئة Gateway](/gateway/configuration) واطّلع على تفاصيل السلوك في
[Session pruning](/concepts/session-pruning).

يمكن لنبضات الحياة إبقاء التخزين المؤقت **دافئًا** عبر فترات الخمول. إذا كان TTL لتخزين
النموذج لديك هو `1h`، فإن تعيين فاصل نبضات الحياة أقل بقليل من ذلك
(مثل `55m`) يمكن أن يتجنب إعادة تخزين المُحفِّز الكامل، مما يقلّل تكاليف كتابة
التخزين المؤقت.

بالنسبة لتسعير واجهة Anthropic API، تكون قراءات التخزين المؤقت أرخص بكثير من رموز الإدخال،
بينما تُحاسَب كتابات التخزين المؤقت بمعامل أعلى. اطّلع على تسعير التخزين المؤقت للمُحفِّز
لدى Anthropic لأحدث المعدلات ومضاعِفات TTL:
[https://docs.anthropic.com/docs/build-with-claude/prompt-caching](https://docs.anthropic.com/docs/build-with-claude/prompt-caching)

### مثال: إبقاء تخزين مؤقت لمدة 1 ساعة دافئًا باستخدام نبضات الحياة

```yaml
agents:
  defaults:
    model:
      primary: "anthropic/claude-opus-4-6"
    models:
      "anthropic/claude-opus-4-6":
        params:
          cacheRetention: "long"
    heartbeat:
      every: "55m"
```

## نصائح لتقليل ضغط الرموز

- استخدم `/compact` لتلخيص الجلسات الطويلة.
- قلِّم مخرجات الأدوات الكبيرة ضمن سير العمل لديك.
- أبقِ أوصاف المهارات قصيرة (تُدرج قائمة Skills في المُحفِّز).
- فَضِّل النماذج الأصغر للأعمال الاستكشافية المطوّلة.

راجع [Skills](/tools/skills) لصيغة الحمل الإضافي الدقيقة لقائمة المهارات.
