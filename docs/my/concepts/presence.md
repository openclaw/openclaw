---
summary: "OpenClaw presence အင်ထရီများကို မည်သို့ ထုတ်လုပ်၊ ပေါင်းစည်း၊ ပြသသည်ကို ရှင်းလင်းဖော်ပြခြင်း"
read_when:
  - Instances တဘ်ကို ဒီဘဂ်လုပ်နေချိန်
  - ထပ်နေသော သို့မဟုတ် အဟောင်းကျန်နေသည့် instance အတန်းများကို စစ်ဆေးနေချိန်
  - Gateway WS ချိတ်ဆက်မှု သို့မဟုတ် system-event beacon များကို ပြောင်းလဲနေချိန်
title: "Presence"
x-i18n:
  source_path: concepts/presence.md
  source_hash: c752c76a880878fe
  provider: openai
  model: gpt-5.2-chat-latest
  workflow: v1
  generated_at: 2026-02-08T10:54:26Z
---

# Presence

OpenClaw “presence” သည် ပေါ့ပါးပြီး အကောင်းဆုံးကြိုးပမ်းမှုအခြေပြု မြင်ကွင်းတစ်ခုဖြစ်ပြီး—

- **Gateway** ကိုယ်တိုင်နှင့်
- **Gateway နှင့် ချိတ်ဆက်ထားသော client များ** (mac app, WebChat, CLI စသည်)

တို့ကို ပြသပေးသည်။

Presence ကို အဓိကအားဖြင့် macOS app ရဲ့ **Instances** တဘ်ကို ပြသရန်နှင့်
အော်ပရေတာများအတွက် လျင်မြန်သော မြင်နိုင်စွမ်းကို ပံ့ပိုးရန် အသုံးပြုသည်။

## Presence fields (ပြသ되는 အချက်အလက်များ)

Presence အင်ထရီများသည် အောက်ပါကဲ့သို့သော field များပါဝင်သည့် ဖွဲ့စည်းထားသော အရာဝတ္ထုများဖြစ်သည်—

- `instanceId` (ရွေးချယ်နိုင်သော်လည်း အလွန်အကြံပြုသည်): တည်ငြိမ်သော client အမှတ်အသား (အများအားဖြင့် `connect.client.instanceId`)
- `host`: လူဖတ်လွယ်သော ဟို့စ်အမည်
- `ip`: အကောင်းဆုံးကြိုးပမ်းမှုအခြေပြု IP လိပ်စာ
- `version`: client ဗားရှင်း စာတန်း
- `deviceFamily` / `modelIdentifier`: ဟာ့ဒ်ဝဲ ဆိုင်ရာ အညွှန်းများ
- `mode`: `ui`, `webchat`, `cli`, `backend`, `probe`, `test`, `node`, ...
- `lastInputSeconds`: “နောက်ဆုံး အသုံးပြုသူ input မှ စက္ကန့်အရေအတွက်” (သိရှိပါက)
- `reason`: `self`, `connect`, `node-connected`, `periodic`, ...
- `ts`: နောက်ဆုံး အပ်ဒိတ် အချိန်အမှတ် (epoch မှ စ၍ ms)

## Producers (presence ကို ဘယ်နေရာမှ ရလာသလဲ)

Presence အင်ထရီများကို မျိုးစုံသော အရင်းအမြစ်များမှ ထုတ်လုပ်ပြီး **ပေါင်းစည်း** လုပ်ထားသည်။

### 1) Gateway ကိုယ်တိုင် အင်ထရီ

Gateway သည် စတင်အလုပ်လုပ်ချိန်တွင် “self” အင်ထရီတစ်ခုကို အမြဲ ထည့်သွင်းထားသည်။ ထို့ကြောင့် client များ မချိတ်ဆက်ရသေးခင်တည်းက UI များတွင် gateway ဟို့စ်ကို ပြသနိုင်သည်။

### 2) WebSocket ချိတ်ဆက်မှု

WS client တစ်ခုစီသည် `connect` တောင်းဆိုမှုဖြင့် စတင်သည်။ Handshake အောင်မြင်သည့်အခါ
Gateway သည် ထိုချိတ်ဆက်မှုအတွက် presence အင်ထရီကို upsert လုပ်သည်။

#### တစ်ကြိမ်သုံး CLI အမိန့်များ မပေါ်လာရခြင်း အကြောင်းရင်း

CLI သည် မကြာခဏ အချိန်တိုအတွင်း တစ်ကြိမ်သုံး အမိန့်များအတွက်သာ ချိတ်ဆက်သည်။ Instances စာရင်းကို များလွန်းအောင် မဖြစ်စေရန် `client.mode === "cli"` ကို presence အင်ထရီအဖြစ် **မ** ပြောင်းလဲပါ။

### 3) `system-event` beacon များ

Client များသည် `system-event` နည်းလမ်းကို အသုံးပြုပြီး ပိုမိုပြည့်စုံသော အချိန်အခါလိုက် beacon များကို ပို့နိုင်သည်။ mac app သည် ဟို့စ်အမည်၊ IP နှင့် `lastInputSeconds` ကို တင်ပြရန် ဤနည်းကို အသုံးပြုသည်။

### 4) Node ချိတ်ဆက်မှု (role: node)

Node တစ်ခုသည် Gateway WebSocket ကို `role: node` ဖြင့် ချိတ်ဆက်သောအခါ Gateway သည် ထို node အတွက် presence အင်ထရီကို upsert လုပ်သည် (အခြား WS client များနှင့် တူညီသော လုပ်ငန်းစဉ်)။

## Merge + dedupe စည်းမျဉ်းများ (`instanceId` အရေးပါရသည့် အကြောင်းရင်း)

Presence အင်ထရီများကို memory အတွင်းရှိ map တစ်ခုတည်းတွင် သိမ်းဆည်းထားသည်—

- အင်ထရီများကို **presence key** ဖြင့် ချိတ်ဆက်ထားသည်။
- အကောင်းဆုံး key သည် ပြန်လည်စတင်မှုများအကြားတောင် တည်တံ့နေသော `instanceId` ( `connect.client.instanceId` မှ ရရှိ) ဖြစ်သည်။
- Key များသည် အကြီးအသေး မခွဲခြားပါ။

Client တစ်ခုသည် တည်ငြိမ်သော `instanceId` မပါဘဲ ပြန်လည်ချိတ်ဆက်ပါက
**ထပ်နေသော** အတန်းအဖြစ် ပေါ်လာနိုင်သည်။

## TTL နှင့် အရွယ်အစား ကန့်သတ်ချက်

Presence ကို အလိုအလျောက် ပျောက်ကွယ်နိုင်သော အချက်အလက်အဖြစ် ရည်ရွယ်ထားသည်—

- **TTL:** မိနစ် ၅ ကျော်အဟောင်းဖြစ်သော အင်ထရီများကို ဖယ်ရှားသည်
- **အများဆုံး အင်ထရီအရေအတွက်:** ၂၀၀ (အဟောင်းဆုံးမှ စ၍ ဖယ်ရှားသည်)

ဤအရာသည် စာရင်းကို လတ်ဆတ်နေစေပြီး memory မကန့်သတ်ဘဲ ကြီးထွားသွားခြင်းကို တားဆီးပေးသည်။

## Remote/tunnel သတိပြုရန် (loopback IP များ)

Client တစ်ခုသည် SSH tunnel သို့မဟုတ် local port forward ဖြင့် ချိတ်ဆက်ပါက Gateway သည် အဝေးဘက်လိပ်စာကို `127.0.0.1` အဖြစ် မြင်နိုင်သည်။ Client က ကိုယ်တိုင်ပို့ထားသော ကောင်းမွန်သည့် IP ကို မရေးပေါ်မိစေရန် loopback remote address များကို လျစ်လျူရှုထားသည်။

## Consumers

### macOS Instances tab

macOS app သည် `system-presence` ၏ အထွက်ကို ပြသပြီး နောက်ဆုံး အပ်ဒိတ်၏ အသက်အရွယ်အပေါ် အခြေခံ၍ အခြေအနေ အညွှန်း (Active/Idle/Stale) သေးငယ်တစ်ခုကို အသုံးချသည်။

## Debugging အကြံပြုချက်များ

- raw စာရင်းကို ကြည့်ရန် Gateway သို့ `system-presence` ကို ခေါ်ပါ။
- ထပ်နေသည်များကို တွေ့ပါက—
  - client များသည် handshake အတွင်း တည်ငြိမ်သော `client.instanceId` ကို ပို့နေကြောင်း အတည်ပြုပါ
  - အချိန်အခါလိုက် beacon များသည် တူညီသော `instanceId` ကို အသုံးပြုနေကြောင်း အတည်ပြုပါ
  - ချိတ်ဆက်မှုမှ ဆင်းသက်လာသော အင်ထရီတွင် `instanceId` မရှိမရှိ စစ်ဆေးပါ (ထိုကိစ္စတွင် ထပ်နေခြင်းကို မျှော်လင့်ရသည်)
