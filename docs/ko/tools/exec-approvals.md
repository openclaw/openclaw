---
read_when:
    - 임원 승인 또는 허용 목록 구성
    - macOS 앱에서 실행 승인 UX 구현
    - 샌드박스 이스케이프 프롬프트 및 의미 검토
summary: Exec 승인, 허용 목록 및 샌드박스 이스케이프 프롬프트
title: 임원 승인
x-i18n:
    generated_at: "2026-02-08T16:13:26Z"
    model: gtx
    provider: google-translate
    source_hash: 66630b5d79671dd4b320cab9d018fa30c497480b955a17cb0b1c7fd609947983
    source_path: tools/exec-approvals.md
    workflow: 15
---

# 임원 승인

임원 승인은 **컴패니언 앱/노드 호스트 가드레일** 샌드박스 에이전트를 실행하도록 허용
실제 호스트에 대한 명령(`gateway` 또는 `node`). 안전 인터록처럼 생각해보세요.
정책 + 허용 목록 + (선택 사항) 사용자 승인이 모두 동의하는 경우에만 명령이 허용됩니다.
임원 승인은 다음과 같습니다. **게다가** 도구 정책 및 상승된 게이팅(상승된 게이팅이 다음으로 설정되지 않은 경우) `full`, 승인을 건너뜁니다).
효과적인 정책은 **더 엄격한** ~의 `tools.exec.*` 승인 기본값; 승인 필드가 생략된 경우 `tools.exec` 값이 사용됩니다.

컴패니언 앱 UI가 다음과 같은 경우 **이용할 수 없음**, 프롬프트가 필요한 모든 요청은
의해 해결됨 **대체 요청** (기본값: 거부).

## 적용되는 곳

Exec 승인은 실행 호스트에서 로컬로 적용됩니다.

- **게이트웨이 호스트** → `openclaw` 게이트웨이 머신의 프로세스
- **노드 호스트** → 노드 러너(macOS 동반 앱 또는 헤드리스 노드 호스트)

macOS 분할:

- **노드 호스트 서비스** 앞으로 `system.run` 에 **macOS 앱** 로컬 IPC를 통해.
- **macOS 앱** 승인을 시행하고 UI 컨텍스트에서 명령을 실행합니다.

## 설정 및 저장

승인은 실행 호스트의 로컬 JSON 파일에 있습니다.

`~/.openclaw/exec-approvals.json`

예제 스키마:

```json
{
  "version": 1,
  "socket": {
    "path": "~/.openclaw/exec-approvals.sock",
    "token": "base64url-token"
  },
  "defaults": {
    "security": "deny",
    "ask": "on-miss",
    "askFallback": "deny",
    "autoAllowSkills": false
  },
  "agents": {
    "main": {
      "security": "allowlist",
      "ask": "on-miss",
      "askFallback": "deny",
      "autoAllowSkills": true,
      "allowlist": [
        {
          "id": "B0C8C0B3-2C2D-4F8A-9A3C-5A4B3C2D1E0F",
          "pattern": "~/Projects/**/bin/rg",
          "lastUsedAt": 1737150000000,
          "lastUsedCommand": "rg -n TODO",
          "lastResolvedPath": "/Users/user/Projects/.../bin/rg"
        }
      ]
    }
  }
}
```

## 정책 손잡이

### 보안 (`exec.security`)

- **부인하다**: 모든 호스트 실행 요청을 차단합니다.
- **허용 목록**: 허용 목록에 있는 명령만 허용합니다.
- **가득한**: 모든 것을 허용합니다(상승된 것과 동일).

### 묻다 (`exec.ask`)

- **끄다**: 메시지를 표시하지 않습니다.
- **부재중**: 허용 목록이 일치하지 않는 경우에만 메시지를 표시합니다.
- **언제나**: 모든 명령에 대해 프롬프트를 표시합니다.

### 대체 요청(`askFallback`)

프롬프트가 필요하지만 UI에 접근할 수 없는 경우 대체는 다음을 결정합니다.

- **부인하다**: 차단하다.
- **허용 목록**: 허용 목록이 일치하는 경우에만 허용합니다.
- **가득한**: 허용하다.

## 허용 목록(에이전트당)

허용 목록은 다음과 같습니다. **에이전트당**. 상담원이 여러 명인 경우 어떤 상담원으로 전환하세요.
macOS 앱에서 편집. 패턴은 **대소문자를 구분하지 않는 전역 일치**.
패턴은 다음과 같이 해결되어야 합니다. **바이너리 경로** (기본 이름만 있는 항목은 무시됩니다).
유산 `agents.default` 항목은 다음으로 마이그레이션됩니다. `agents.main` 로드 중.

예:

- `~/Projects/**/bin/peekaboo`
- `~/.local/bin/*`
- `/opt/homebrew/bin/rg`

각 허용 목록 항목은 다음을 추적합니다.

- **ID** UI ID에 사용되는 안정적인 UUID(선택 사항)
- **마지막으로 사용한** 타임스탬프
- **마지막으로 사용한 명령**
- **마지막으로 해결된 경로**

## 기술 CLI 자동 허용

언제 **기술 CLI 자동 허용** 활성화되면 실행 파일이 알려진 기술에 의해 참조됩니다.
노드(macOS 노드 또는 헤드리스 노드 호스트)에서 허용 목록으로 처리됩니다. 이는 다음을 사용합니다.
`skills.bins` 기술 저장소 목록을 가져오기 위해 게이트웨이 RPC를 통해. 엄격한 수동 허용 목록을 원하는 경우 이 기능을 비활성화하세요.

## 금고(표준 입력 전용)

`tools.exec.safeBins` 작은 목록을 정의합니다 **표준 입력 전용** 바이너리(예를 들어 `jq`)
허용 목록 모드에서 실행될 수 있는 **없이** 명시적인 허용 목록 항목. 안전한 쓰레기통은 거부합니다
위치 파일 인수 및 경로 유사 토큰이므로 들어오는 스트림에서만 작동할 수 있습니다.
셸 연결 및 리디렉션은 허용 목록 모드에서 자동으로 허용되지 않습니다.

쉘 체인(`&&`, `||`, `;`)는 모든 최상위 세그먼트가 허용 목록을 충족하는 경우 허용됩니다.
(금고함이나 스킬 자동 허용 포함) 허용 목록 모드에서는 리디렉션이 지원되지 않습니다.
명령 대체(`$()` / 백틱)은 내부를 포함하여 허용 목록 구문 분석 중에 거부됩니다.
큰따옴표; 리터럴이 필요한 경우 작은따옴표를 사용하세요. `$()` 텍스트.

기본 금고: `jq`, `grep`, `cut`, `sort`, `uniq`, `head`, `tail`, `tr`, `wc`.

## 컨트롤 UI 편집

사용 **제어 UI → 노드 → 실행 승인** 에이전트별로 기본값을 편집할 수 있는 카드
재정의 및 허용 목록. 범위(기본값 또는 에이전트)를 선택하고, 정책을 조정하고,
허용 목록 패턴을 추가/제거한 다음 **구하다**. UI가 보여줍니다 **마지막으로 사용한** 메타데이터
패턴별로 목록을 깔끔하게 유지할 수 있습니다.

대상 선택자가 선택합니다. **게이트웨이** (현지 승인) 또는 **마디**. 노드
광고해야 함 `system.execApprovals.get/set` (macOS 앱 또는 헤드리스 노드 호스트)
노드가 아직 exec 승인을 알리지 않으면 로컬을 편집하십시오.
`~/.openclaw/exec-approvals.json` 곧장.

CLI: `openclaw approvals` 게이트웨이 또는 노드 편집을 지원합니다(참조: [승인 CLI](/cli/approvals)).

## 승인 흐름

프롬프트가 필요할 때 게이트웨이는 브로드캐스트합니다. `exec.approval.requested` 운영자 고객에게.
Control UI 및 macOS 앱은 다음을 통해 문제를 해결합니다. `exec.approval.resolve`, 게이트웨이는 다음을 전달합니다.
노드 호스트에 대한 요청이 승인되었습니다.

승인이 필요한 경우 실행 도구는 승인 ID와 함께 즉시 반환됩니다. 해당 ID를 사용하여
이후 시스템 이벤트의 상관 관계(`Exec finished` / `Exec denied`). 만약 그 이전에 결정이 나오지 않는다면
시간 초과된 경우 요청은 승인 시간 초과로 처리되고 거부 사유로 표시됩니다.

확인 대화 상자에는 다음이 포함됩니다.

- 명령 + 인수
- cwd
- 에이전트 ID
- 확인된 실행 파일 경로
- 호스트 + 정책 메타데이터

행위:

- **한 번만 허용** → 지금 실행
- **항상 허용** → 허용 목록에 추가 + 실행
- **부인하다** → 차단

## 채팅 채널로 승인 전달

실행 승인 메시지를 모든 채팅 채널(플러그인 채널 포함)에 전달하고 승인할 수 있습니다.
그들과 함께 `/approve`. 이는 일반적인 아웃바운드 전달 파이프라인을 사용합니다.

구성:

```json5
{
  approvals: {
    exec: {
      enabled: true,
      mode: "session", // "session" | "targets" | "both"
      agentFilter: ["main"],
      sessionFilter: ["discord"], // substring or regex
      targets: [
        { channel: "slack", to: "U12345678" },
        { channel: "telegram", to: "123456789" },
      ],
    },
  },
}
```

채팅으로 답장하기:

```
/approve <id> allow-once
/approve <id> allow-always
/approve <id> deny
```

### macOS IPC 흐름

```
Gateway -> Node Service (WS)
                 |  IPC (UDS + token + HMAC + TTL)
                 v
             Mac App (UI + approvals + system.run)
```

보안 참고사항:

- 유닉스 소켓 모드 `0600`, 다음에 저장된 토큰 `exec-approvals.json`.
- 동일한 UID 피어 확인.
- 챌린지/응답(nonce + HMAC 토큰 + 요청 해시) + 짧은 TTL.

## 시스템 이벤트

Exec 수명주기는 시스템 메시지로 표시됩니다.

- `Exec running` (명령이 실행 알림 임계값을 초과하는 경우에만)
- `Exec finished`
- `Exec denied`

이는 노드가 이벤트를 보고한 후 에이전트 세션에 게시됩니다.
게이트웨이-호스트 실행 승인은 명령이 완료될 때(그리고 선택적으로 임계값보다 오래 실행될 때) 동일한 수명 주기 이벤트를 내보냅니다.
승인 관리 임원은 승인 ID를 `runId` 쉬운 상관 관계를 위해 이러한 메시지에 포함됩니다.

## 시사점

- **가득한** 강력하다; 가능하다면 허용 목록을 선호하세요.
- **묻다** 빠른 승인을 허용하면서 루프를 계속 유지합니다.
- 에이전트별 허용 목록은 한 에이전트의 승인이 다른 에이전트로 유출되는 것을 방지합니다.
- 승인은 호스트 실행 요청에만 적용됩니다. **승인된 발신자**. 승인되지 않은 발신자는 발행할 수 없습니다. `/exec`.
- `/exec security=full` 승인된 운영자를 위한 세션 수준 편의를 제공하며 설계상 승인을 건너뜁니다.
  호스트 실행을 하드 차단하려면 승인 보안을 다음으로 설정하세요. `deny` 아니면 부정하거나 `exec` 도구 정책을 통한 도구.

관련된:

- [실행 도구](/tools/exec)
- [승격 모드](/tools/elevated)
- [기술](/tools/skills)
