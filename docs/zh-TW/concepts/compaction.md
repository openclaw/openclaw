---
summary: "上下文視窗 + 壓縮：OpenClaw 如何在模型限制內維持工作階段"
read_when:
  - 您想了解自動壓縮和 /compact 指令
  - 您正在偵錯遇到上下文限制的長時間工作階段
title: "壓縮"
---

# 上下文視窗與壓縮

每個模型都有一個**上下文視窗**（可見的最多 Token 數）。長時間執行的聊天會累積訊息和工具結果；一旦視窗變緊，OpenClaw 會**壓縮**較舊的歷史紀錄以保持在限制內。

## 什麼是壓縮

壓縮會將**較舊的對話內容摘要**成一個精簡的摘要條目，並保持近期訊息不變。摘要儲存在工作階段歷史中，因此未來的請求會使用：

- 壓縮摘要
- 壓縮點之後的近期訊息

壓縮會**持久化**在工作階段的 JSONL 歷史中。

## 設定

在您的 `openclaw.json` 中使用 `agents.defaults.compaction` 設定來配置壓縮行為（模式、目標 Token 數等）。

## 自動壓縮（預設開啟）

當一個工作階段接近或超出模型的上下文視窗時，OpenClaw 會觸發自動壓縮，並可能使用壓縮後的上下文重試原始請求。

您會看到：

- `🧹 自動壓縮完成` 在詳細模式下
- `/status` 顯示 `🧹 壓縮次數: <count>`

在壓縮之前，OpenClaw 可以執行一次**靜默記憶體清除**，將持久性筆記儲存到磁碟。有關詳情和設定，請參閱 [記憶體](/concepts/memory)。

## 手動壓縮

使用 `/compact`（可選地帶有說明）來強制執行一次壓縮：

```
/compact Focus on decisions and open questions
```

## 上下文視窗來源

上下文視窗是模型特有的。OpenClaw 使用配置的供應商目錄中的模型定義來確定限制。

## 壓縮與修剪的比較

- **壓縮**：摘要並**持久化**在 JSONL 中。
- **工作階段修剪**：僅修剪舊的**工具結果**，**在記憶體中**，每個請求一次。

有關修剪詳情，請參閱 [/concepts/session-pruning](/concepts/session-pruning)。

## 提示

- 當工作階段感覺陳舊或上下文內容過多時，使用 `/compact`。
- 大型工具輸出已經過截斷；修剪可以進一步減少工具結果的累積。
- 如果您需要重新開始，`/new` 或 `/reset` 會啟動一個新的工作階段 ID。
