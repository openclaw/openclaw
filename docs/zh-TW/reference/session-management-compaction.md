---
summary: "æ·±åº¦æ¢è¨ï¼šå·¥ä½œéšæ®µå„²å­˜ + é€å­—ç¨¿ã€ç”Ÿå‘½é€±æœŸåŠï¼ˆè‡ªå‹•ï¼‰å£“ç¸®å…§éƒ¨æ©Ÿåˆ¶"
read_when:
  - ä½ éœ€è¦å°å·¥ä½œéšæ®µ IDã€é€å­—ç¨¿ JSONL æˆ– sessions.json æ¬„ä½é€²è¡Œé™¤éŒ¯
  - ä½ æ­£åœ¨æ›´æ”¹è‡ªå‹•å£“ç¸®è¡Œç‚ºæˆ–å¢åŠ ã€Œé å£“ç¸®ã€ç¶­è­·å·¥ä½œ
  - ä½ æƒ³è¦å¯¦ä½œè¨˜æ†¶é«”æ¸…é™¤æˆ–éœé»˜ç³»çµ±è¼ªæ¬¡
title: "å·¥ä½œéšæ®µç®¡ç†æ·±åº¦æ¢è¨"
---

# å·¥ä½œéšæ®µç®¡ç†èˆ‡å£“ç¸®ï¼ˆæ·±åº¦æ¢è¨ï¼‰

æœ¬æ–‡ä»¶èªªæ˜ OpenClaw å¦‚ä½•ç«¯åˆ°ç«¯åœ°ç®¡ç†å·¥ä½œéšæ®µï¼š

- **å·¥ä½œéšæ®µè·¯ç”±**ï¼ˆå‚³å…¥è¨Šæ¯å¦‚ä½•å°æ‡‰åˆ° `sessionKey`ï¼‰
- **å·¥ä½œéšæ®µå„²å­˜**ï¼ˆ`sessions.json`ï¼‰åŠå…¶è¿½è¹¤çš„å…§å®¹
- **é€å­—ç¨¿æŒä¹…åŒ–**ï¼ˆ`*.jsonl`ï¼‰åŠå…¶çµæ§‹
- **é€å­—ç¨¿æ•´ç†**ï¼ˆåŸ·è¡Œå‰é‡å°ç‰¹å®šä¾›æ‡‰å•†çš„ä¿®æ­£ï¼‰
- **ä¸Šä¸‹æ–‡é™åˆ¶**ï¼ˆä¸Šä¸‹æ–‡è¦–çª— vs å·²è¿½è¹¤ Tokenï¼‰
- **å£“ç¸®**ï¼ˆæ‰‹å‹• + è‡ªå‹•å£“ç¸®ï¼‰ä»¥åŠåœ¨å“ªè£¡æ›è¼‰é å£“ç¸®å·¥ä½œ
- **éœé»˜ç¶­è­·**ï¼ˆä¾‹å¦‚ä¸æ‡‰ç”¢ç”Ÿä½¿ç”¨è€…å¯è¦‹è¼¸å‡ºçš„è¨˜æ†¶é«”å¯«å…¥ï¼‰

å¦‚æœä½ æƒ³å…ˆäº†è§£é«˜éšæ¦‚è§€ï¼Œè«‹å¾ä»¥ä¸‹å…§å®¹é–‹å§‹ï¼š

- [/concepts/session](/concepts/session)
- [/concepts/compaction](/concepts/compaction)
- [/concepts/session-pruning](/concepts/session-pruning)
- [/reference/transcript-hygiene](/reference/transcript-hygiene)

---

## å–®ä¸€äº‹å¯¦ä¾†æºï¼šGateway

OpenClaw æ˜¯åœç¹è‘—æ“æœ‰å·¥ä½œéšæ®µç‹€æ…‹çš„å–®ä¸€ **Gateway è™•ç†ç¨‹åº**æ‰€è¨­è¨ˆã€‚

- UIï¼ˆmacOS æ‡‰ç”¨ç¨‹å¼ã€ç¶²é æ§åˆ¶ UIã€TUIï¼‰æ‡‰å‘ Gateway æŸ¥è©¢å·¥ä½œéšæ®µåˆ—è¡¨å’Œ Token è¨ˆæ•¸ã€‚
- åœ¨é ç«¯æ¨¡å¼ä¸‹ï¼Œå·¥ä½œéšæ®µæª”æ¡ˆä½æ–¼é ç«¯ä¸»æ©Ÿä¸Šï¼›ã€Œæª¢æŸ¥æœ¬åœ° Mac æª”æ¡ˆã€å°‡ç„¡æ³•åæ˜  Gateway æ­£åœ¨ä½¿ç”¨çš„å…§å®¹ã€‚

---

## å…©å€‹æŒä¹…åŒ–å±¤

OpenClaw åœ¨å…©å€‹å±¤ç´šæŒä¹…åŒ–å·¥ä½œéšæ®µï¼š

1. **å·¥ä½œéšæ®µå„²å­˜ (`sessions.json`)**
   - éµ/å€¼æ˜ å°„ï¼š`sessionKey -> SessionEntry`
   - é«”ç©å°ã€å¯è®Šå‹•ï¼Œå¯ä»¥å®‰å…¨ç·¨è¼¯ï¼ˆæˆ–åˆªé™¤æ¢ç›®ï¼‰
   - è¿½è¹¤å·¥ä½œéšæ®µå…ƒæ•¸æ“šï¼ˆç›®å‰å·¥ä½œéšæ®µ IDã€æœ€å¾Œæ´»å‹•ã€åˆ‡æ›é–‹é—œã€Token è¨ˆæ•¸å™¨ç­‰ï¼‰

2. **é€å­—ç¨¿ (`<sessionId>.jsonl`)**
   - åƒ…é™é™„åŠ çš„é€å­—ç¨¿ï¼Œå…·æœ‰æ¨¹ç‹€çµæ§‹ï¼ˆæ¢ç›®å…·æœ‰ `id` + `parentId`ï¼‰
   - å„²å­˜å¯¦éš›å°è©± + å·¥å…·å‘¼å« + å£“ç¸®æ‘˜è¦
   - ç”¨æ–¼é‡å»ºæœªä¾†è¼ªæ¬¡çš„æ¨¡å‹ä¸Šä¸‹æ–‡

---

## ç£ç¢Ÿå„²å­˜ä½ç½®

åœ¨ Gateway ä¸»æ©Ÿä¸Šï¼Œæ¯å€‹æ™ºæ…§ä»£ç†çš„å„²å­˜ä½ç½®ï¼š

- å„²å­˜å€ï¼š`~/.openclaw/agents/<agentId>/sessions/sessions.json`
- é€å­—ç¨¿ï¼š`~/.openclaw/agents/<agentId>/sessions/<sessionId>.jsonl`
  - Telegram ä¸»é¡Œå·¥ä½œéšæ®µï¼š`.../<sessionId>-topic-<threadId>.jsonl`

OpenClaw é€é `src/config/sessions.ts` è§£æé€™äº›è·¯å¾‘ã€‚

---

## å·¥ä½œéšæ®µé‡‘é‘° (`sessionKey`)

`sessionKey` è­˜åˆ¥ä½ æ‰€åœ¨çš„ *å°è©±åˆ†æ¡¶*ï¼ˆè·¯ç”± + éš”é›¢ï¼‰ã€‚

å¸¸è¦‹æ¨¡å¼ï¼š

- ä¸»è¦/ç›´æ¥èŠå¤©ï¼ˆæ¯å€‹æ™ºæ…§ä»£ç†ï¼‰ï¼š`agent:<agentId>:<mainKey>`ï¼ˆé è¨­ç‚º `main`ï¼‰
- ç¾¤çµ„ï¼š`agent:<agentId>:<channel>:group:<id>`
- é »é“ï¼ˆDiscord/Slackï¼‰ï¼š`agent:<agentId>:<channel>:channel:<id>` æˆ– `...:room:<id>`
- Cronï¼š`cron:<job.id>`
- Webhookï¼š`hook:<uuid>`ï¼ˆé™¤éè¢«è¦†è“‹ï¼‰

æ¨™æº–è¦å‰‡æ–‡ä»¶è«‹è¦‹ [/concepts/session](/concepts/session)ã€‚

---

## å·¥ä½œéšæ®µ ID (`sessionId`)

æ¯å€‹ `sessionKey` æŒ‡å‘ä¸€å€‹ç›®å‰çš„ `sessionId`ï¼ˆç¹¼çºŒå°è©±çš„é€å­—ç¨¿æª”æ¡ˆï¼‰ã€‚

ç¶“é©—æ³•å‰‡ï¼š

- **é‡è¨­**ï¼ˆ`/new`, `/reset`ï¼‰æœƒç‚ºè©² `sessionKey` å»ºç«‹ä¸€å€‹æ–°çš„ `sessionId`ã€‚
- **æ¯æ—¥é‡è¨­**ï¼ˆé è¨­ç‚º Gateway ä¸»æ©Ÿæœ¬åœ°æ™‚é–“å‡Œæ™¨ 4:00ï¼‰æœƒåœ¨é‡è¨­ç•Œé™å¾Œçš„ä¸‹ä¸€æ¢è¨Šæ¯å»ºç«‹æ–°çš„ `sessionId`ã€‚
- **é–’ç½®éæœŸ**ï¼ˆ`session.reset.idleMinutes` æˆ–èˆŠç‰ˆçš„ `session.idleMinutes`ï¼‰æœƒåœ¨é–’ç½®è¦–çª—å¾Œè¨Šæ¯åˆ°é”æ™‚å»ºç«‹æ–°çš„ `sessionId`ã€‚ç•¶åŒæ™‚è¨­å®šæ¯æ—¥å’Œé–’ç½®é‡è¨­æ™‚ï¼Œä»¥å…ˆéæœŸè€…ç‚ºæº–ã€‚

å¯¦ä½œç´°ç¯€ï¼šæ±ºç­–ç™¼ç”Ÿåœ¨ `src/auto-reply/reply/session.ts` çš„ `initSessionState()` ä¸­ã€‚

---

## å·¥ä½œéšæ®µå„²å­˜çµæ§‹ (`sessions.json`)

å„²å­˜å€çš„å€¼é¡å‹æ˜¯ `src/config/sessions.ts` ä¸­çš„ `SessionEntry`ã€‚

é—œéµæ¬„ä½ï¼ˆéè©³ç›¡åˆ—è¡¨ï¼‰ï¼š

- `sessionId`: ç›®å‰é€å­—ç¨¿ IDï¼ˆé™¤éè¨­å®šäº† `sessionFile`ï¼Œå¦å‰‡æª”åç”±æ­¤è¡ç”Ÿï¼‰
- `updatedAt`: æœ€å¾Œæ´»å‹•æ™‚é–“æˆ³è¨˜
- `sessionFile`: é¸ç”¨çš„æ˜ç¢ºé€å­—ç¨¿è·¯å¾‘è¦†è“‹
- `chatType`: `direct | group | room`ï¼ˆå”åŠ© UI å’Œå‚³é€ç­–ç•¥ï¼‰
- `provider`, `subject`, `room`, `space`, `displayName`: ç”¨æ–¼ç¾¤çµ„/é »é“æ¨™ç±¤çš„å…ƒæ•¸æ“š
- åˆ‡æ›é–‹é—œï¼š
  - `thinkingLevel`, `verboseLevel`, `reasoningLevel`, `elevatedLevel`
  - `sendPolicy`ï¼ˆå€‹åˆ¥å·¥ä½œéšæ®µè¦†è“‹ï¼‰
- æ¨¡å‹é¸æ“‡ï¼š
  - `providerOverride`, `modelOverride`, `authProfileOverride`
- Token è¨ˆæ•¸å™¨ï¼ˆç›¡åŠ›è€Œç‚º / å–æ±ºæ–¼ä¾›æ‡‰å•†ï¼‰ï¼š
  - `inputTokens`, `outputTokens`, `totalTokens`, `contextTokens`
- `compactionCount`: æ­¤å·¥ä½œéšæ®µé‡‘é‘°å®Œæˆè‡ªå‹•å£“ç¸®çš„æ¬¡æ•¸
- `memoryFlushAt`: ä¸Šæ¬¡å£“ç¸®å‰è¨˜æ†¶é«”æ¸…é™¤çš„æ™‚é–“æˆ³è¨˜
- `memoryFlushCompactionCount`: ä¸Šæ¬¡æ¸…é™¤åŸ·è¡Œæ™‚çš„å£“ç¸®è¨ˆæ•¸

å¯ä»¥å®‰å…¨åœ°ç·¨è¼¯æ­¤å„²å­˜å€ï¼Œä½†ä»¥ Gateway ç‚ºæº–ï¼šå®ƒå¯èƒ½æœƒåœ¨å·¥ä½œéšæ®µåŸ·è¡Œæ™‚é‡å¯«æˆ–é‡æ–°å¡«å…¥æ¢ç›®ã€‚

---

## é€å­—ç¨¿çµæ§‹ (`*.jsonl`)

é€å­—ç¨¿ç”± `@mariozechner/pi-coding-agent` çš„ `SessionManager` ç®¡ç†ã€‚

æª”æ¡ˆæ ¼å¼ç‚º JSONLï¼š

- ç¬¬ä¸€è¡Œï¼šå·¥ä½œéšæ®µæ¨™é ­ï¼ˆ`type: "session"`ï¼ŒåŒ…å« `id`, `cwd`, `timestamp` åŠé¸ç”¨çš„ `parentSession`ï¼‰
- éš¨å¾Œï¼šå…·æœ‰ `id` + `parentId` çš„å·¥ä½œéšæ®µæ¢ç›®ï¼ˆæ¨¹ç‹€ï¼‰

é¡¯è‘—çš„æ¢ç›®é¡å‹ï¼š

- `message`: ä½¿ç”¨è€…/åŠ©ç†/å·¥å…·çµæœè¨Šæ¯
- `custom_message`: æ“´å……åŠŸèƒ½æ³¨å…¥çš„è¨Šæ¯ï¼Œ*æœƒ* é€²å…¥æ¨¡å‹ä¸Šä¸‹æ–‡ï¼ˆå¯å° UI éš±è—ï¼‰
- `custom`: æ“´å……åŠŸèƒ½ç‹€æ…‹ï¼Œ*ä¸æœƒ* é€²å…¥æ¨¡å‹ä¸Šä¸‹æ–‡
- `compaction`: æŒä¹…åŒ–çš„å£“ç¸®æ‘˜è¦ï¼ŒåŒ…å« `firstKeptEntryId` å’Œ `tokensBefore`
- `branch_summary`: å°è¦½æ¨¹ç‹€åˆ†æ”¯æ™‚æŒä¹…åŒ–çš„æ‘˜è¦

OpenClaw æ•…æ„ **ä¸**ã€Œä¿®æ­£ã€é€å­—ç¨¿ï¼›Gateway ä½¿ç”¨ `SessionManager` ä¾†è®€å–/å¯«å…¥å®ƒå€‘ã€‚

---

## ä¸Šä¸‹æ–‡è¦–çª— vs å·²è¿½è¹¤ Token

æ¶‰åŠå…©å€‹ä¸åŒçš„æ¦‚å¿µï¼š

1. **æ¨¡å‹ä¸Šä¸‹æ–‡è¦–çª—**ï¼šæ¯å€‹æ¨¡å‹çš„ç¡¬æ€§é™åˆ¶ï¼ˆæ¨¡å‹å¯è¦‹çš„ Tokenï¼‰
2. **å·¥ä½œéšæ®µå„²å­˜è¨ˆæ•¸å™¨**ï¼šå¯«å…¥ `sessions.json` çš„æ²å‹•çµ±è¨ˆæ•¸æ“šï¼ˆç”¨æ–¼ `/status` å’Œå„€è¡¨æ¿ï¼‰

å¦‚æœä½ æ­£åœ¨èª¿æ•´é™åˆ¶ï¼š

- ä¸Šä¸‹æ–‡è¦–çª—ä¾†è‡ªæ¨¡å‹ç›®éŒ„ï¼ˆå¯é€éè¨­å®šè¦†è“‹ï¼‰ã€‚
- å„²å­˜å€ä¸­çš„ `contextTokens` æ˜¯åŸ·è¡Œæ™‚çš„é ä¼°/å ±å‘Šå€¼ï¼›è«‹å‹¿å°‡å…¶è¦–ç‚ºåš´æ ¼çš„ä¿è­‰ã€‚

æ›´å¤šè³‡è¨Šè«‹åƒé–± [/reference/token-use](/reference/token-use)ã€‚

---

## å£“ç¸®ï¼šå®ƒæ˜¯ä»€éº¼

å£“ç¸®å°‡è¼ƒèˆŠçš„å°è©±ç¸½çµç‚ºé€å­—ç¨¿ä¸­æŒä¹…åŒ–çš„ `compaction` æ¢ç›®ï¼Œä¸¦ä¿æŒæœ€è¿‘çš„è¨Šæ¯å®Œæ•´ã€‚

å£“ç¸®å¾Œï¼Œæœªä¾†çš„è¼ªæ¬¡å°‡çœ‹åˆ°ï¼š

- å£“ç¸®æ‘˜è¦
- `firstKeptEntryId` ä¹‹å¾Œçš„è¨Šæ¯

å£“ç¸®æ˜¯ **æŒä¹…æ€§** çš„ï¼ˆä¸åŒæ–¼å·¥ä½œéšæ®µç²¾ç°¡ï¼‰ã€‚åƒè¦‹ [/concepts/session-pruning](/concepts/session-pruning)ã€‚

---

## ä½•æ™‚è§¸ç™¼è‡ªå‹•å£“ç¸® (Pi åŸ·è¡Œéšæ®µ)

åœ¨åµŒå…¥å¼ Pi æ™ºæ…§ä»£ç†ä¸­ï¼Œè‡ªå‹•å£“ç¸®æœƒåœ¨å…©ç¨®æƒ…æ³ä¸‹è§¸ç™¼ï¼š

1. **æº¢ä½å¾©åŸ**ï¼šæ¨¡å‹å‚³å›ä¸Šä¸‹æ–‡æº¢ä½éŒ¯èª¤ â†’ å£“ç¸® â†’ é‡è©¦ã€‚
2. **é–€æª»ç¶­è­·**ï¼šåœ¨æˆåŠŸçš„è¼ªæ¬¡å¾Œï¼Œç•¶ï¼š

`contextTokens > contextWindow - reserveTokens`

å…¶ä¸­ï¼š

- `contextWindow` æ˜¯æ¨¡å‹çš„ä¸Šä¸‹æ–‡è¦–çª—
- `reserveTokens` æ˜¯é ç•™çµ¦æç¤ºè© + ä¸‹ä¸€å€‹æ¨¡å‹è¼¸å‡ºçš„ç·©è¡ç©ºé–“

é€™äº›æ˜¯ Pi åŸ·è¡Œéšæ®µèªç¾©ï¼ˆOpenClaw æ¥æ”¶äº‹ä»¶ï¼Œä½†ç”± Pi æ±ºå®šä½•æ™‚å£“ç¸®ï¼‰ã€‚

---

## å£“ç¸®è¨­å®š (`reserveTokens`, `keepRecentTokens`)

Pi çš„å£“ç¸®è¨­å®šä½æ–¼ Pi è¨­å®šä¸­ï¼š

```json5
{
  compaction: {
    enabled: true,
    reserveTokens: 16384,
    keepRecentTokens: 20000,
  },
}
```

OpenClaw ä¹Ÿç‚ºåµŒå…¥å¼åŸ·è¡Œå¼·åˆ¶åŸ·è¡Œå®‰å…¨åº•é™ï¼š

- å¦‚æœ `compaction.reserveTokens < reserveTokensFloor`ï¼ŒOpenClaw æœƒå°‡å…¶èª¿å‡ã€‚
- é è¨­åº•é™ç‚º `20000` Tokenã€‚
- è¨­å®š `agents.defaults.compaction.reserveTokensFloor: 0` å¯åœç”¨æ­¤åº•é™ã€‚
- å¦‚æœè¨­å®šå·²ç¶“è¼ƒé«˜ï¼ŒOpenClaw å‰‡ä¸æœƒæ›´å‹•ã€‚

åŸå› ï¼šåœ¨å£“ç¸®è®Šå¾—ä¸å¯é¿å…ä¹‹å‰ï¼Œç‚ºå¤šè¼ªã€Œç¶­è­·ã€ï¼ˆå¦‚è¨˜æ†¶é«”å¯«å…¥ï¼‰ç•™å‡ºè¶³å¤ çš„ç·©è¡ç©ºé–“ã€‚

å¯¦ä½œï¼š`src/agents/pi-settings.ts` ä¸­çš„ `ensurePiCompactionReserveTokens()`
ï¼ˆå¾ `src/agents/pi-embedded-runner.ts` å‘¼å«ï¼‰ã€‚

---

## ä½¿ç”¨è€…å¯è¦‹ä»‹é¢

ä½ å¯ä»¥é€éä»¥ä¸‹æ–¹å¼è§€å¯Ÿå£“ç¸®å’Œå·¥ä½œéšæ®µç‹€æ…‹ï¼š

- `/status`ï¼ˆåœ¨ä»»ä½•èŠå¤©å·¥ä½œéšæ®µä¸­ï¼‰
- `openclaw status` (CLI)
- `openclaw sessions` / `sessions --json`
- è©³ç´°æ¨¡å¼ï¼š`ğŸ§¹ Auto-compaction complete` + å£“ç¸®è¨ˆæ•¸

---

## éœé»˜ç¶­è­· (`NO_REPLY`)

OpenClaw æ”¯æ´ç”¨æ–¼èƒŒæ™¯ä»»å‹™çš„ã€Œéœé»˜ã€è¼ªæ¬¡ï¼Œä½¿ç”¨è€…ä¸æ‡‰çœ‹åˆ°ä¸­é–“è¼¸å‡ºã€‚

æ…£ä¾‹ï¼š

- åŠ©ç†åœ¨è¼¸å‡ºé–‹é ­ä½¿ç”¨ `NO_REPLY` ä¾†æŒ‡ç¤ºã€Œä¸è¦å‘ä½¿ç”¨è€…å‚³é€å›è¦†ã€ã€‚
- OpenClaw æœƒåœ¨å‚³é€å±¤å‰é›¢/æŠ‘åˆ¶æ­¤å…§å®¹ã€‚

è‡ª `2026.1.10` èµ·ï¼Œç•¶éƒ¨åˆ†å€å¡Šä»¥ `NO_REPLY` é–‹é ­æ™‚ï¼ŒOpenClaw ä¹ŸæœƒæŠ‘åˆ¶ **è‰ç¨¿/è¼¸å…¥ä¸­ä¸²æµ**ï¼Œå› æ­¤éœé»˜æ“ä½œä¸æœƒåœ¨è¼ªæ¬¡ä¸­é€”æ´©æ¼éƒ¨åˆ†è¼¸å‡ºã€‚

---

## å£“ç¸®å‰ã€Œè¨˜æ†¶é«”æ¸…é™¤ã€ï¼ˆå·²å¯¦ä½œï¼‰

ç›®æ¨™ï¼šåœ¨è‡ªå‹•å£“ç¸®ç™¼ç”Ÿä¹‹å‰ï¼ŒåŸ·è¡Œä¸€å€‹éœé»˜çš„æ™ºæ…§ä»£ç†è¼ªæ¬¡ï¼Œå°‡æŒä¹…ç‹€æ…‹å¯«å…¥ç£ç¢Ÿï¼ˆä¾‹å¦‚æ™ºæ…§ä»£ç†å·¥ä½œå€ä¸­çš„ `memory/YYYY-MM-DD.md`ï¼‰ï¼Œä½¿å£“ç¸®ä¸æœƒæŠ¹é™¤é—œéµä¸Šä¸‹æ–‡ã€‚

OpenClaw ä½¿ç”¨ **é è¨­é–€æª»æ¸…é™¤** æ–¹æ³•ï¼š

1. ç›£æ§å·¥ä½œéšæ®µä¸Šä¸‹æ–‡ä½¿ç”¨æƒ…æ³ã€‚
2. ç•¶å®ƒè·¨è¶Šã€Œè»Ÿé–€æª»ã€ï¼ˆä½æ–¼ Pi çš„å£“ç¸®é–€æª»ï¼‰æ™‚ï¼Œå‘æ™ºæ…§ä»£ç†åŸ·è¡Œéœé»˜çš„ã€Œç«‹å³å¯«å…¥è¨˜æ†¶é«”ã€æŒ‡ä»¤ã€‚
3. ä½¿ç”¨ `NO_REPLY` è®“ä½¿ç”¨è€…çœ‹ä¸åˆ°ä»»ä½•å…§å®¹ã€‚

è¨­å®š (`agents.defaults.compaction.memoryFlush`):

- `enabled`ï¼ˆé è¨­ï¼š`true`ï¼‰
- `softThresholdTokens`ï¼ˆé è¨­ï¼š`4000`ï¼‰
- `prompt`ï¼ˆç”¨æ–¼æ¸…é™¤è¼ªæ¬¡çš„ä½¿ç”¨è€…è¨Šæ¯ï¼‰
- `systemPrompt`ï¼ˆé™„åŠ åœ¨æ¸…é™¤è¼ªæ¬¡çš„é¡å¤–ç³»çµ±æç¤ºè©ï¼‰

æ³¨æ„ï¼š

- é è¨­æç¤ºè©/ç³»çµ±æç¤ºè©åŒ…å« `NO_REPLY` æç¤ºä»¥æŠ‘åˆ¶å‚³é€ã€‚
- æ¯å€‹å£“ç¸®é€±æœŸåŸ·è¡Œä¸€æ¬¡æ¸…é™¤ï¼ˆåœ¨ `sessions.json` ä¸­è¿½è¹¤ï¼‰ã€‚
- æ¸…é™¤åƒ…é‡å°åµŒå…¥å¼ Pi å·¥ä½œéšæ®µåŸ·è¡Œï¼ˆCLI å¾Œç«¯æœƒè·³éï¼‰ã€‚
- ç•¶å·¥ä½œéšæ®µå·¥ä½œå€ç‚ºå”¯è®€æ™‚ï¼ˆ`workspaceAccess: "ro"` æˆ– `"none"`ï¼‰ï¼Œæœƒè·³éæ¸…é™¤ã€‚
- æœ‰é—œå·¥ä½œå€æª”æ¡ˆä½ˆå±€å’Œå¯«å…¥æ¨¡å¼ï¼Œè«‹åƒè¦‹ [è¨˜æ†¶é«”](/concepts/memory)ã€‚

Pi ä¹Ÿåœ¨æ“´å……åŠŸèƒ½ API ä¸­å…¬é–‹äº† `session_before_compact` æ›é‰¤ï¼Œä½† OpenClaw çš„æ¸…é™¤é‚è¼¯ç›®å‰ä½æ–¼ Gateway ç«¯ã€‚

---

## ç–‘é›£æ’è§£æª¢æŸ¥æ¸…å–®

- å·¥ä½œéšæ®µé‡‘é‘°éŒ¯èª¤ï¼Ÿå¾ [/concepts/session](/concepts/session) é–‹å§‹ï¼Œä¸¦åœ¨ `/status` ä¸­ç¢ºèª `sessionKey`ã€‚
- å„²å­˜å€èˆ‡é€å­—ç¨¿ä¸ç¬¦ï¼Ÿå¾ `openclaw status` ç¢ºèª Gateway ä¸»æ©Ÿå’Œå„²å­˜è·¯å¾‘ã€‚
- å£“ç¸®éæ–¼é »ç¹ï¼Ÿæª¢æŸ¥ï¼š
  - æ¨¡å‹ä¸Šä¸‹æ–‡è¦–çª—ï¼ˆå¤ªå°ï¼‰
  - å£“ç¸®è¨­å®šï¼ˆå°æ¨¡å‹è¦–çª—è€Œè¨€ `reserveTokens` å¤ªé«˜ï¼Œå¯èƒ½å°è‡´ææ—©å£“ç¸®ï¼‰
  - å·¥å…·çµæœè†¨è„¹ï¼šå•Ÿç”¨/èª¿æ•´å·¥ä½œéšæ®µç²¾ç°¡
- éœé»˜è¼ªæ¬¡æ´©æ¼ï¼Ÿç¢ºèªå›è¦†ä»¥ `NO_REPLY`ï¼ˆç²¾ç¢º Tokenï¼‰é–‹é ­ï¼Œä¸”ä½ ä½¿ç”¨çš„ç‰ˆæœ¬åŒ…å«ä¸²æµæŠ‘åˆ¶ä¿®å¾©ã€‚
