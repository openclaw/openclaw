```
---
summary: "æ·±åº¦æ¢è¨ï¼šå·¥ä½œéšæ®µå„²å­˜ + å°è©±ç´€éŒ„ã€ç”Ÿå‘½é€±æœŸä»¥åŠ (è‡ªå‹•)å£“ç¸®å…§éƒ¨æ©Ÿåˆ¶"
read_when:
  - æ‚¨éœ€è¦åµéŒ¯å·¥ä½œéšæ®µ IDã€å°è©±ç´€éŒ„ JSONL æˆ– sessions.json æ¬„ä½æ™‚
  - æ‚¨æ­£åœ¨è®Šæ›´è‡ªå‹•å£“ç¸®è¡Œç‚ºæˆ–æ–°å¢ã€Œé å£“ç¸®ã€å…§éƒ¨ç®¡ç†å·¥ä½œæ™‚
  - æ‚¨æƒ³å¯¦ä½œè¨˜æ†¶é«”æ¸…é™¤æˆ–ç„¡è²ç³»çµ±å›åˆæ™‚
title: "å·¥ä½œéšæ®µç®¡ç†æ·±åº¦æ¢è¨"
---

# å·¥ä½œéšæ®µç®¡ç†èˆ‡å£“ç¸® (æ·±åº¦æ¢è¨)

æœ¬æ–‡ä»¶èªªæ˜ OpenClaw å¦‚ä½•ç«¯åˆ°ç«¯åœ°ç®¡ç†å·¥ä½œéšæ®µï¼š

- **å·¥ä½œéšæ®µè·¯ç”±** (å‚³å…¥è¨Šæ¯å¦‚ä½•å°æ‡‰åˆ° `sessionKey`)
- **å·¥ä½œéšæ®µå„²å­˜** (`sessions.json`) åŠå…¶è¿½è¹¤å…§å®¹
- **å°è©±ç´€éŒ„æŒä¹…åŒ–** (`*.jsonl`) åŠå…¶çµæ§‹
- **å°è©±ç´€éŒ„æ¸…ç†** (åŸ·è¡Œå‰ä¾›æ‡‰å•†ç‰¹å®šçš„ä¿®æ­£)
- **ä¸Šä¸‹æ–‡é™åˆ¶** (ä¸Šä¸‹æ–‡è¦–çª—èˆ‡è¿½è¹¤çš„æ¬Šæ–)
- **å£“ç¸®** (æ‰‹å‹• + è‡ªå‹•å£“ç¸®) ä»¥åŠé å£“ç¸®å·¥ä½œçš„æ›é‰¤é»
- **ç„¡è²å…§éƒ¨ç®¡ç†** (ä¾‹å¦‚ä¸æ‡‰ç”¢ç”Ÿä½¿ç”¨è€…å¯è¦‹è¼¸å‡ºçš„è¨˜æ†¶é«”å¯«å…¥)

å¦‚æœæ‚¨æƒ³å…ˆäº†è§£é«˜å±¤ç´šçš„æ¦‚è§€ï¼Œè«‹å¾ä»¥ä¸‹å…§å®¹é–‹å§‹ï¼š

- [/concepts/session](/concepts/session)
- [/concepts/compaction](/concepts/compaction)
- [/concepts/session-pruning](/concepts/session-pruning)
- [/reference/transcript-hygiene](/reference/transcript-hygiene)

---

## çœŸå¯¦ä¾†æºï¼šGateway

OpenClaw åœç¹è‘—å–®ä¸€çš„ **Gateway ç¨‹å¼** è¨­è¨ˆï¼Œè©²ç¨‹å¼æ“æœ‰å·¥ä½œéšæ®µç‹€æ…‹ã€‚

- UI (macOS æ‡‰ç”¨ç¨‹å¼ã€web Control UIã€TUI) æ‡‰å‘ Gateway æŸ¥è©¢å·¥ä½œéšæ®µåˆ—è¡¨å’Œæ¬Šæ–è¨ˆæ•¸ã€‚
- åœ¨é ç«¯æ¨¡å¼ä¸‹ï¼Œå·¥ä½œéšæ®µæª”æ¡ˆä½æ–¼é ç«¯ä¸»æ©Ÿä¸Šï¼›ã€Œæª¢æŸ¥æ‚¨çš„æœ¬æ©Ÿ Mac æª”æ¡ˆã€å°‡ç„¡æ³•åæ˜  Gateway æ­£åœ¨ä½¿ç”¨çš„å…§å®¹ã€‚

---

## å…©å€‹æŒä¹…å±¤

OpenClaw å°‡å·¥ä½œéšæ®µæŒä¹…åŒ–åœ¨å…©å€‹å±¤æ¬¡ï¼š

1. **å·¥ä½œéšæ®µå„²å­˜ (`sessions.json`)**
   - éµ/å€¼æ˜ å°„ï¼š`sessionKey -> SessionEntry`
   - å°å‹ã€å¯è®Šå‹•ã€å¯å®‰å…¨ç·¨è¼¯ (æˆ–åˆªé™¤æ¢ç›®)
   - è¿½è¹¤å·¥ä½œéšæ®µä¸­ç¹¼è³‡æ–™ (ç•¶å‰å·¥ä½œéšæ®µ IDã€ä¸Šæ¬¡æ´»å‹•ã€é–‹é—œã€æ¬Šæ–è¨ˆæ•¸å™¨ç­‰)

2. **å°è©±ç´€éŒ„ (`<sessionId>.jsonl`)**
   - åƒ…é™„åŠ çš„å°è©±ç´€éŒ„ï¼Œå…·æœ‰æ¨¹ç‹€çµæ§‹ (æ¢ç›®å…·æœ‰ `id` + `parentId`)
   - å„²å­˜å¯¦éš›å°è©± + å·¥å…·å‘¼å« + å£“ç¸®æ‘˜è¦
   - ç”¨æ–¼ç‚ºæœªä¾†å›åˆé‡å»ºæ¨¡å‹ä¸Šä¸‹æ–‡

---

## ç£ç¢Ÿä¸Šçš„ä½ç½®

æ¯å€‹æ™ºæ…§ä»£ç†åœ¨ Gateway ä¸»æ©Ÿä¸Šï¼š

- å„²å­˜ï¼š`~/.openclaw/agents/<agentId>/sessions/sessions.json`
- å°è©±ç´€éŒ„ï¼š`~/.openclaw/agents/<agentId>/sessions/<sessionId>.jsonl`
  - Telegram ä¸»é¡Œå·¥ä½œéšæ®µï¼š`.../<sessionId>-topic-<threadId>.jsonl`

OpenClaw é€é `src/config/sessions.ts` è§£æé€™äº›å…§å®¹ã€‚

---

## å·¥ä½œéšæ®µéµ (`sessionKey`)

`sessionKey` è­˜åˆ¥æ‚¨æ‰€åœ¨çš„ _å°è©±æ¡¶_ (è·¯ç”± + éš”é›¢)ã€‚

å¸¸è¦‹æ¨¡å¼ï¼š

- ä¸»è¦/ç›´æ¥èŠå¤© (æ¯å€‹æ™ºæ…§ä»£ç†)ï¼š`agent:<agentId>:<mainKey>` (é è¨­ `main`)
- ç¾¤çµ„ï¼š`agent:<agentId>:<channel>:group:<id>`
- æˆ¿é–“/é »é“ (Discord/Slack)ï¼š`agent:<agentId>:<channel>:channel:<id>` æˆ– `...:room:<id>`
- Cronï¼š`cron:<job.id>`
- Webhookï¼š`hook:<uuid>` (é™¤éè¢«è¦†å¯«)

è¦ç¯„è¦å‰‡è¨˜éŒ„åœ¨ [/concepts/session](/concepts/session)ã€‚

---

## å·¥ä½œéšæ®µ ID (`sessionId`)

æ¯å€‹ `sessionKey` éƒ½æŒ‡å‘ä¸€å€‹ç•¶å‰çš„ `sessionId` (ç¹¼çºŒå°è©±çš„å°è©±ç´€éŒ„æª”æ¡ˆ)ã€‚

ç¶“é©—æ³•å‰‡ï¼š

- **é‡è¨­** (`/new`ã€`/reset`) ç‚ºè©² `sessionKey` å»ºç«‹ä¸€å€‹æ–°çš„ `sessionId`ã€‚
- **æ¯æ—¥é‡è¨­** (Gateway ä¸»æ©Ÿä¸Šæœ¬æ©Ÿæ™‚é–“ä¸Šåˆ 4:00 é è¨­) åœ¨é‡è¨­é‚Šç•Œä¹‹å¾Œçš„ä¸‹ä¸€æ¢è¨Šæ¯ä¸Šå»ºç«‹ä¸€å€‹æ–°çš„ `sessionId`ã€‚
- **é–’ç½®éæœŸ** (`session.reset.idleMinutes` æˆ–èˆŠç‰ˆ `session.idleMinutes`) ç•¶è¨Šæ¯åœ¨é–’ç½®è¦–çª—ä¹‹å¾Œåˆ°é”æ™‚å»ºç«‹ä¸€å€‹æ–°çš„ `sessionId`ã€‚ç•¶æ¯æ—¥ + é–’ç½®éƒ½è¨­å®šæ™‚ï¼Œå“ªå€‹å…ˆéæœŸå°±ä»¥å“ªå€‹ç‚ºæº–ã€‚

å¯¦ä½œç´°ç¯€ï¼šè©²æ±ºå®šç™¼ç”Ÿåœ¨ `src/auto-reply/reply/session.ts` ä¸­çš„ `initSessionState()`ã€‚

---

## å·¥ä½œéšæ®µå„²å­˜æ¨¡å¼ (`sessions.json`)

å„²å­˜çš„å€¼é¡å‹æ˜¯ `src/config/sessions.ts` ä¸­çš„ `SessionEntry`ã€‚

é—œéµæ¬„ä½ (ä¸è©³ç›¡)ï¼š

- `sessionId`ï¼šç•¶å‰å°è©±ç´€éŒ„ ID (æª”åç”±æ­¤æ´¾ç”Ÿï¼Œé™¤éè¨­å®šäº† `sessionFile`)
- `updatedAt`ï¼šä¸Šæ¬¡æ´»å‹•æ™‚é–“æˆ³è¨˜
- `sessionFile`ï¼šå¯é¸çš„æ˜ç¢ºå°è©±ç´€éŒ„è·¯å¾‘è¦†å¯«
- `chatType`ï¼š`direct | group | room` (æœ‰åŠ©æ–¼ UI å’Œå‚³é€ç­–ç•¥)
- `provider`ã€`subject`ã€`room`ã€`space`ã€`displayName`ï¼šç¾¤çµ„/é »é“æ¨™ç±¤çš„ä¸­ç¹¼è³‡æ–™
- é–‹é—œï¼š
  - `thinkingLevel`ã€`verboseLevel`ã€`reasoningLevel`ã€`elevatedLevel`
  - `sendPolicy` (æ¯å€‹å·¥ä½œéšæ®µè¦†å¯«)
- æ¨¡å‹é¸æ“‡ï¼š
  - `providerOverride`ã€`modelOverride`ã€`authProfileOverride`
- æ¬Šæ–è¨ˆæ•¸å™¨ (ç›¡åŠ›è€Œç‚º/ä¾›æ‡‰å•†ç›¸é—œ)ï¼š
  - `inputTokens`ã€`outputTokens`ã€`totalTokens`ã€`contextTokens`
- `compactionCount`ï¼šæ­¤å·¥ä½œéšæ®µéµçš„è‡ªå‹•å£“ç¸®å®Œæˆæ¬¡æ•¸
- `memoryFlushAt`ï¼šä¸Šæ¬¡é å£“ç¸®è¨˜æ†¶é«”æ¸…é™¤çš„æ™‚é–“æˆ³è¨˜
- `memoryFlushCompactionCount`ï¼šä¸Šæ¬¡æ¸…é™¤åŸ·è¡Œæ™‚çš„å£“ç¸®è¨ˆæ•¸

å„²å­˜æ˜¯å®‰å…¨çš„ç·¨è¼¯ï¼Œä½† Gateway æ˜¯æ¬Šå¨ï¼šå®ƒå¯èƒ½æœƒåœ¨å·¥ä½œéšæ®µé‹è¡Œæ™‚é‡å¯«æˆ–é‡æ–°æ°´åŒ–æ¢ç›®ã€‚

---

## å°è©±ç´€éŒ„çµæ§‹ (`*.jsonl`)

å°è©±ç´€éŒ„ç”± `@mariozechner/pi-coding-agent` çš„ `SessionManager` ç®¡ç†ã€‚

æª”æ¡ˆæ˜¯ JSONLï¼š

- ç¬¬ä¸€è¡Œï¼šå·¥ä½œéšæ®µæ¨™é ­ (`type: "session"`, åŒ…å« `id`ã€`cwd`ã€`timestamp`ã€å¯é¸çš„ `parentSession`)
- ç„¶å¾Œï¼šå…·æœ‰ `id` + `parentId` (æ¨¹ç‹€) çš„å·¥ä½œéšæ®µæ¢ç›®

å€¼å¾—æ³¨æ„çš„æ¢ç›®é¡å‹ï¼š

- `message`ï¼šä½¿ç”¨è€…/åŠ©æ‰‹/å·¥å…·çµæœè¨Šæ¯
- `custom_message`ï¼šæ“´å……åŠŸèƒ½æ³¨å…¥çš„è¨Šæ¯ï¼Œ_ç¢ºå¯¦_ é€²å…¥æ¨¡å‹ä¸Šä¸‹æ–‡ (å¯å¾ UI éš±è—)
- `custom`ï¼šä¸é€²å…¥æ¨¡å‹ä¸Šä¸‹æ–‡çš„æ“´å……åŠŸèƒ½ç‹€æ…‹
- `compaction`ï¼šå¸¶æœ‰ `firstKeptEntryId` å’Œ `tokensBefore` çš„æŒä¹…åŒ–å£“ç¸®æ‘˜è¦
- `branch_summary`ï¼šå°è¦½æ¨¹ç‹€åˆ†æ”¯æ™‚çš„æŒä¹…åŒ–æ‘˜è¦

OpenClaw æ•…æ„ä¸ã€Œä¿®æ­£ã€å°è©±ç´€éŒ„ï¼›Gateway ä½¿ç”¨ `SessionManager` è®€å¯«å®ƒå€‘ã€‚

---

## ä¸Šä¸‹æ–‡è¦–çª—èˆ‡è¿½è¹¤æ¬Šæ–

å…©å€‹ä¸åŒçš„æ¦‚å¿µå¾ˆé‡è¦ï¼š

1. **æ¨¡å‹ä¸Šä¸‹æ–‡è¦–çª—**ï¼šæ¯å€‹æ¨¡å‹ç¡¬æ€§ä¸Šé™ (æ¨¡å‹å¯è¦‹çš„æ¬Šæ–)
2. **å·¥ä½œéšæ®µå„²å­˜è¨ˆæ•¸å™¨**ï¼šæ»¾å‹•çµ±è¨ˆè³‡è¨Šå¯«å…¥ `sessions.json` (ç”¨æ–¼ `/status` å’Œå„€è¡¨æ¿)

å¦‚æœæ‚¨æ­£åœ¨èª¿æ•´é™åˆ¶ï¼š

- ä¸Šä¸‹æ–‡è¦–çª—ä¾†è‡ªæ¨¡å‹ç›®éŒ„ (å¯é€éè¨­å®šè¦†å¯«)ã€‚
- å„²å­˜ä¸­çš„ `contextTokens` æ˜¯ä¸€å€‹åŸ·è¡Œæ™‚ä¼°è¨ˆ/å ±å‘Šå€¼ï¼›è«‹å‹¿å°‡å…¶è¦–ç‚ºåš´æ ¼ä¿è­‰ã€‚

æ›´å¤šè³‡è¨Šï¼Œè«‹åƒé–± [/token-use](/reference/token-use)ã€‚

---

## å£“ç¸®ï¼šæ˜¯ä»€éº¼

å£“ç¸®å°‡è¼ƒèˆŠçš„å°è©±æ‘˜è¦ç‚ºå°è©±ç´€éŒ„ä¸­æŒä¹…åŒ–çš„ `compaction` æ¢ç›®ï¼Œä¸¦ä¿æŒæœ€è¿‘çš„è¨Šæ¯å®Œæ•´ã€‚

å£“ç¸®ä¹‹å¾Œï¼Œæœªä¾†å›åˆå°‡çœ‹åˆ°ï¼š

- å£“ç¸®æ‘˜è¦
- `firstKeptEntryId` ä¹‹å¾Œçš„è¨Šæ¯

å£“ç¸®æ˜¯**æŒä¹…çš„** (èˆ‡å·¥ä½œéšæ®µä¿®å‰ªä¸åŒ)ã€‚è«‹åƒé–± [/concepts/session-pruning](/concepts/session-pruning)ã€‚

---

## è‡ªå‹•å£“ç¸®ä½•æ™‚ç™¼ç”Ÿ (Pi é‹è¡Œæ™‚)

åœ¨åµŒå…¥å¼ Pi æ™ºæ…§ä»£ç†ä¸­ï¼Œè‡ªå‹•å£“ç¸®åœ¨å…©ç¨®æƒ…æ³ä¸‹è§¸ç™¼ï¼š

1. **æº¢ä½æ¢å¾©**ï¼šæ¨¡å‹è¿”å›ä¸Šä¸‹æ–‡æº¢ä½éŒ¯èª¤ â†’ å£“ç¸® â†’ é‡è©¦ã€‚
2. **é–¾å€¼ç¶­è­·**ï¼šæˆåŠŸå›åˆå¾Œï¼Œç•¶ï¼š

`contextTokens > contextWindow - reserveTokens`

å…¶ä¸­ï¼š

- `contextWindow` æ˜¯æ¨¡å‹çš„ä¸Šä¸‹æ–‡è¦–çª—
- `reserveTokens` æ˜¯ç‚ºæç¤º + ä¸‹ä¸€å€‹æ¨¡å‹è¼¸å‡ºä¿ç•™çš„é¤˜è£•ç©ºé–“

é€™äº›æ˜¯ Pi é‹è¡Œæ™‚çš„èªç¾© (OpenClaw æ¶ˆè€—äº‹ä»¶ï¼Œä½† Pi æ±ºå®šä½•æ™‚å£“ç¸®)ã€‚

---

## å£“ç¸®è¨­å®š (`reserveTokens`ã€`keepRecentTokens`)

Pi çš„å£“ç¸®è¨­å®šä½æ–¼ Pi è¨­å®šä¸­ï¼š

```json5
{
  compaction: {
    enabled: true,
    reserveTokens: 16384,
    keepRecentTokens: 20000,
  },
}
```

OpenClaw é‚„ç‚ºåµŒå…¥å¼åŸ·è¡Œå¼·åˆ¶åŸ·è¡Œå®‰å…¨ä¸‹é™ï¼š

- å¦‚æœ `compaction.reserveTokens < reserveTokensFloor`ï¼ŒOpenClaw æœƒå°‡å…¶æé«˜ã€‚
- é è¨­ä¸‹é™ç‚º `20000` æ¬Šæ–ã€‚
- è¨­å®š `agents.defaults.compaction.reserveTokensFloor: 0` ä»¥åœç”¨ä¸‹é™ã€‚
- å¦‚æœå·²ç¶“æ›´é«˜ï¼ŒOpenClaw ä¸æœƒå‹•å®ƒã€‚

åŸå› ï¼šç‚ºå¤šå›åˆã€Œå…§éƒ¨ç®¡ç†ã€ (ä¾‹å¦‚è¨˜æ†¶é«”å¯«å…¥) ç•™ä¸‹è¶³å¤ çš„é¤˜è£•ç©ºé–“ï¼Œç›´åˆ°å£“ç¸®è®Šå¾—ä¸å¯é¿å…ã€‚

å¯¦ä½œï¼š`src/agents/pi-settings.ts` ä¸­çš„ `ensurePiCompactionReserveTokens()`
(å¾ `src/agents/pi-embedded-runner.ts` å‘¼å«)ã€‚

---

## ä½¿ç”¨è€…å¯è¦‹ä»‹é¢

æ‚¨å¯ä»¥é€éä»¥ä¸‹æ–¹å¼è§€å¯Ÿå£“ç¸®å’Œå·¥ä½œéšæ®µç‹€æ…‹ï¼š

- `/status` (åœ¨ä»»ä½•èŠå¤©å·¥ä½œéšæ®µä¸­)
- `openclaw status` (CLI)
- `openclaw sessions` / `sessions --json`
- è©³ç´°æ¨¡å¼ï¼š`ğŸ§¹ Auto-compaction complete` + å£“ç¸®è¨ˆæ•¸

---

## ç„¡è²å…§éƒ¨ç®¡ç† (`NO_REPLY`)

OpenClaw æ”¯æ´ã€Œç„¡è²ã€å›åˆï¼Œç”¨æ–¼ä½¿ç”¨è€…ä¸æ‡‰çœ‹åˆ°ä¸­é–“è¼¸å‡ºçš„èƒŒæ™¯ä»»å‹™ã€‚

æ…£ä¾‹ï¼š

- åŠ©æ‰‹è¼¸å‡ºä»¥ `NO_REPLY` é–‹é ­ï¼Œè¡¨ç¤ºã€Œä¸å‘ä½¿ç”¨è€…å‚³éå›è¦†ã€ã€‚
- OpenClaw åœ¨å‚³éå±¤ä¸­å‰é›¢/æŠ‘åˆ¶æ­¤å…§å®¹ã€‚

æˆªè‡³ `2026.1.10`ï¼Œç•¶éƒ¨åˆ†å€å¡Šä»¥ `NO_REPLY` é–‹é ­æ™‚ï¼ŒOpenClaw é‚„æœƒæŠ‘åˆ¶**è‰ç¨¿/è¼¸å…¥ä¸²æµå‚³è¼¸**ï¼Œå› æ­¤ç„¡è²æ“ä½œä¸æœƒåœ¨å›åˆä¸­é€”æ´©æ¼éƒ¨åˆ†è¼¸å‡ºã€‚

---

## é å£“ç¸®ã€Œè¨˜æ†¶é«”æ¸…é™¤ã€ (å·²å¯¦ä½œ)

ç›®æ¨™ï¼šåœ¨è‡ªå‹•å£“ç¸®ç™¼ç”Ÿä¹‹å‰ï¼Œé‹è¡Œä¸€å€‹ç„¡è²çš„æ™ºæ…§ä»£ç†å›åˆï¼Œå°‡æŒä¹…ç‹€æ…‹å¯«å…¥ç£ç¢Ÿ (ä¾‹å¦‚æ™ºæ…§ä»£ç†å·¥ä½œå€ä¸­çš„ `memory/YYYY-MM-DD.md`)ï¼Œä»¥ä¾¿å£“ç¸®ç„¡æ³•æ¸…é™¤é—œéµä¸Šä¸‹æ–‡ã€‚

OpenClaw ä½¿ç”¨**é é–¾å€¼æ¸…é™¤**æ–¹æ³•ï¼š

1. ç›£æ§å·¥ä½œéšæ®µä¸Šä¸‹æ–‡ä½¿ç”¨æƒ…æ³ã€‚
2. ç•¶å®ƒè·¨è¶Šã€Œè»Ÿé–¾å€¼ã€ (ä½æ–¼ Pi çš„å£“ç¸®é–¾å€¼) æ™‚ï¼Œå‘æ™ºæ…§ä»£ç†é‹è¡Œä¸€å€‹ç„¡è²çš„ã€Œç«‹å³å¯«å…¥è¨˜æ†¶é«”ã€æŒ‡ä»¤ã€‚
3. ä½¿ç”¨ `NO_REPLY`ï¼Œä»¥ä¾¿ä½¿ç”¨è€…ä»€éº¼ä¹Ÿçœ‹ä¸åˆ°ã€‚

è¨­å®š (`agents.defaults.compaction.memoryFlush`)ï¼š

- `enabled` (é è¨­ï¼š`true`)
- `softThresholdTokens` (é è¨­ï¼š`4000`)
- `prompt` (æ¸…é™¤å›åˆçš„ä½¿ç”¨è€…è¨Šæ¯)
- `systemPrompt` (æ¸…é™¤å›åˆé™„åŠ çš„é¡å¤–ç³»çµ±æç¤º)

æ³¨æ„äº‹é …ï¼š

- é è¨­çš„æç¤º/ç³»çµ±æç¤ºåŒ…å«ä¸€å€‹ `NO_REPLY` æç¤ºï¼Œç”¨æ–¼æŠ‘åˆ¶å‚³éã€‚
- æ¸…é™¤æ¯å€‹å£“ç¸®é€±æœŸé‹è¡Œä¸€æ¬¡ (åœ¨ `sessions.json` ä¸­è¿½è¹¤)ã€‚
- æ¸…é™¤åƒ…é©ç”¨æ–¼åµŒå…¥å¼ Pi å·¥ä½œéšæ®µ (CLI å¾Œç«¯è·³éå®ƒ)ã€‚
- ç•¶å·¥ä½œéšæ®µå·¥ä½œå€ç‚ºå”¯è®€æ™‚ (``workspaceAccess: "ro"`` æˆ– ``"none"``)ï¼Œæ¸…é™¤æœƒè¢«è·³éã€‚
- è«‹åƒé–± [è¨˜æ†¶é«”](/concepts/memory) ä»¥äº†è§£å·¥ä½œå€æª”æ¡ˆä½ˆå±€å’Œå¯«å…¥æ¨¡å¼ã€‚

Pi é‚„åœ¨æ“´å……åŠŸèƒ½ API ä¸­å…¬é–‹äº†ä¸€å€‹ `session_before_compact` æ›é‰¤ï¼Œä½† OpenClaw çš„æ¸…é™¤é‚è¼¯ç›®å‰ä½æ–¼ Gateway ç«¯ã€‚

---

## ç–‘é›£æ’è§£æª¢æŸ¥è¡¨

- å·¥ä½œéšæ®µéµéŒ¯èª¤ï¼Ÿè«‹å¾ [/concepts/session](/concepts/session) é–‹å§‹ï¼Œä¸¦ç¢ºèª `/status` ä¸­çš„ `sessionKey`ã€‚
- å„²å­˜èˆ‡å°è©±ç´€éŒ„ä¸åŒ¹é…ï¼Ÿç¢ºèª Gateway ä¸»æ©Ÿå’Œ `openclaw status` ä¸­çš„å„²å­˜è·¯å¾‘ã€‚
- å£“ç¸®åƒåœ¾è¨Šæ¯ï¼Ÿæª¢æŸ¥ï¼š
  - æ¨¡å‹ä¸Šä¸‹æ–‡è¦–çª— (å¤ªå°)
  - å£“ç¸®è¨­å®š (å°æ–¼æ¨¡å‹è¦–çª—ä¾†èªª `reserveTokens` å¤ªé«˜å¯èƒ½æœƒå°è‡´æ›´æ—©å£“ç¸®)
  - å·¥å…·çµæœè†¨è„¹ï¼šå•Ÿç”¨/èª¿æ•´å·¥ä½œéšæ®µä¿®å‰ª
- ç„¡è²å›åˆæ´©æ¼ï¼Ÿç¢ºèªå›è¦†ä»¥ `NO_REPLY` é–‹é ­ (ç¢ºåˆ‡çš„æ¬Šæ–)ï¼Œä¸¦ä¸”æ‚¨æ­£åœ¨ä½¿ç”¨åŒ…å«ä¸²æµå‚³è¼¸æŠ‘åˆ¶ä¿®æ­£çš„å»ºæ§‹ç‰ˆæœ¬ã€‚
```
