# OpenClaw 威脅模型 v1.0

## MITRE ATLAS 框架

**版本：** 1.0-草案
**最後更新：** 2026-02-04
**方法論：** MITRE ATLAS + 資料流圖 (Data Flow Diagrams)
**框架：** [MITRE ATLAS](https://atlas.mitre.org/) (AI 系統對抗性威脅矩陣)

### 框架引用

本威脅模型基於 [MITRE ATLAS](https://atlas.mitre.org/) 構建，這是記錄 AI/ML 系統對抗性威脅的業界標準框架。ATLAS 由 [MITRE](https://www.mitre.org/) 與 AI 安全社群共同維護。

**關鍵 ATLAS 資源：**

- [ATLAS 技術 (Techniques)](https://atlas.mitre.org/techniques/)
- [ATLAS 策略 (Tactics)](https://atlas.mitre.org/tactics/)
- [ATLAS 案例研究](https://atlas.mitre.org/studies/)
- [ATLAS GitHub](https://github.com/mitre-atlas/atlas-data)
- [參與 ATLAS 貢獻](https://atlas.mitre.org/resources/contribute)

### 參與本威脅模型貢獻

這是一份由 OpenClaw 社群維護的動態檔案。請參閱 [CONTRIBUTING-THREAT-MODEL.md](./CONTRIBUTING-THREAT-MODEL.md) 以瞭解貢獻指南：

- 回報新威脅
- 更新現有威脅
- 提出攻擊鏈
- 建議緩解措施

---

## 1. 簡介

### 1.1 目的

本威脅模型使用專為 AI/ML 系統設計的 MITRE ATLAS 框架，記錄了 OpenClaw AI 智慧代理平台和 ClawHub Skills 市集的對抗性威脅。

### 1.2 範圍

| 元件 | 包含 | 備註 |
| --- | --- | --- |
| OpenClaw 智慧代理執行階段 | 是 | 核心智慧代理執行、工具呼叫、工作階段 |
| Gateway | 是 | 身分驗證、路由、頻道整合 |
| 頻道整合 | 是 | WhatsApp, Telegram, Discord, Signal, Slack 等 |
| ClawHub 市集 | 是 | Skills 發佈、審核、分發 |
| MCP 伺服器 | 是 | 外部工具供應商 |
| 使用者裝置 | 部分 | 行動應用程式、桌面用戶端 |

### 1.3 不在範圍內

本威脅模型沒有明確排除任何內容。

---

## 2. 系統架構

### 2.1 信任邊界

```
┌─────────────────────────────────────────────────────────────────┐
│                          非信任區域                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  WhatsApp   │  │  Telegram   │  │   Discord   │  ...         │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │
│         │                │                │                      │
└─────────┼────────────────┼────────────────┼──────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 信任邊界 1: 頻道存取                             │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      GATEWAY                              │   │
│  │  • 裝置配對 (30 秒寬限期)                                  │   │
│  │  • AllowFrom / AllowList 驗證                             │   │
│  │  • 權杖/密碼/Tailscale 驗證                                │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 信任邊界 2: 工作階段隔離                         │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   智慧代理工作階段                        │   │
│  │  • 工作階段金鑰 = agent:channel:peer                     │   │
│  │  • 每個智慧代理的工具策略                                 │   │
│  │  • 對話紀錄記錄                                          │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 信任邊界 3: 工具執行                             │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                        執行沙箱                           │   │
│  │  • Docker 沙箱或主機 (exec-approvals)                    │   │
│  │  • Node 遠端執行                                          │   │
│  │  • SSRF 防護 (DNS 固定 + IP 封鎖)                         │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 信任邊界 4: 外部內容                             │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              獲取的 URL / 電子郵件 / Webhooks             │   │
│  │  • 外部內容封裝 (XML 標籤)                                │   │
│  │  • 插入安全性通知                                         │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 信任邊界 5: 供應鏈                               │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      CLAWHUB                              │   │
│  │  • Skills 發佈 (語義化版本, 必須包含 SKILL.md)             │   │
│  │  • 基於模式的審核標記                                     │   │
│  │  • VirusTotal 掃描 (即將推出)                              │   │
│  │  • GitHub 帳號註冊時長驗證                                 │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 資料流

| 編號 | 來源 | 目的地 | 資料 | 保護措施 |
| --- | --- | --- | --- | --- |
| F1 | 頻道 | Gateway | 使用者訊息 | TLS, AllowFrom |
| F2 | Gateway | 智慧代理 | 路由訊息 | 工作階段隔離 |
| F3 | 智慧代理 | 工具 | 工具呼叫 | 策略強制執行 |
| F4 | 智慧代理 | 外部 | web_fetch 請求 | SSRF 封鎖 |
| F5 | ClawHub | 智慧代理 | Skills 程式碼 | 審核、掃描 |
| F6 | 智慧代理 | 頻道 | 回應 | 輸出過濾 |

---

## 3. 按 ATLAS 策略進行的威脅分析

### 3.1 偵察 (AML.TA0002)

#### T-RECON-001: 智慧代理端點探索

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0006 - 主動掃描 |
| **描述** | 攻擊者掃描暴露在外的 OpenClaw Gateway 端點 |
| **攻擊向量** | 網路掃描、Shodan 查詢、DNS 列舉 |
| **受影響元件** | Gateway、公開的 API 端點 |
| **現有緩解措施** | Tailscale 驗證選項、預設綁定至 local loopback |
| **殘餘風險** | 中 - 公開的 Gateway 可能被發現 |
| **建議** | 撰寫安全部署文件、在探索端點增加速率限制 |

#### T-RECON-002: 頻道整合探測

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0006 - 主動掃描 |
| **描述** | 攻擊者探測通訊頻道以識別由 AI 管理的帳號 |
| **攻擊向量** | 發送測試訊息、觀察回應模式 |
| **受影響元件** | 所有頻道整合 |
| **現有緩解措施** | 無特定措施 |
| **殘餘風險** | 低 - 僅靠探索獲得的價值有限 |
| **建議** | 考慮隨機化回應時間 |

---

### 3.2 初始存取 (AML.TA0004)

#### T-ACCESS-001: 配對碼攔截

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0040 - AI 模型推論 API 存取 |
| **描述** | 攻擊者在 30 秒寬限期內攔截配對碼 |
| **攻擊向量** | 肩後窺視、網路嗅探、社交工程 |
| **受影響元件** | 裝置配對系統 |
| **現有緩解措施** | 30 秒過期、透過現有頻道發送代碼 |
| **殘餘風險** | 中 - 寬限期可能被利用 |
| **建議** | 縮短寬限期、增加確認步驟 |

#### T-ACCESS-002: AllowFrom 偽造

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0040 - AI 模型推論 API 存取 |
| **描述** | 攻擊者在頻道中偽造被允許的傳送者身分 |
| **攻擊向量** | 取決於頻道 - 電話號碼偽造、使用者名稱冒充 |
| **受影響元件** | 每個頻道的 AllowFrom 驗證 |
| **現有緩解措施** | 頻道特定的身分驗證 |
| **殘餘風險** | 中 - 部分頻道容易受到偽造攻擊 |
| **建議** | 記錄特定頻道的風險、盡可能增加加密驗證 |

#### T-ACCESS-003: 權杖竊取

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0040 - AI 模型推論 API 存取 |
| **描述** | 攻擊者從設定檔中竊取身分驗證權杖 |
| **攻擊向量** | 惡意軟體、未經授權的裝置存取、設定備份暴露 |
| **受影響元件** | ~/.openclaw/credentials/、設定儲存 |
| **現有緩解措施** | 檔案權限 |
| **殘餘風險** | 高 - 權杖以純文字儲存 |
| **建議** | 實施靜態權杖加密、增加權杖輪替 |

---

### 3.3 執行 (AML.TA0005)

#### T-EXEC-001: 直接提示詞注入

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0051.000 - LLM 提示詞注入：直接 |
| **描述** | 攻擊者發送精心設計的提示詞以操縱智慧代理行為 |
| **攻擊向量** | 包含對抗性指令的頻道訊息 |
| **受影響元件** | 智慧代理 LLM、所有輸入表面 |
| **現有緩解措施** | 模式偵測、外部內容封裝 |
| **殘餘風險** | 嚴重 - 僅有偵測而無封鎖；複雜攻擊可繞過 |
| **建議** | 實施多層防禦、輸出驗證、針對敏感操作增加使用者確認 |

#### T-EXEC-002: 間接提示詞注入

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0051.001 - LLM 提示詞注入：間接 |
| **描述** | 攻擊者在獲取的內容中嵌入惡意指令 |
| **攻擊向量** | 惡意 URL、受污染的電子郵件、遭入侵的 Webhooks |
| **受影響元件** | web_fetch、電子郵件攝取、外部資料來源 |
| **現有緩解措施** | 使用 XML 標籤和安全性通知進行內容封裝 |
| **殘餘風險** | 高 - LLM 可能忽略封裝指令 |
| **建議** | 實施內容淨化 (Sanitization)、隔離執行上下文 |

#### T-EXEC-003: 工具參數注入

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0051.000 - LLM 提示詞注入：直接 |
| **描述** | 攻擊者透過提示詞注入操縱工具參數 |
| **攻擊向量** | 影響工具參數值的精心設計提示詞 |
| **受影響元件** | 所有工具呼叫 |
| **現有緩解措施** | 針對危險指令的執行審核 (exec-approvals) |
| **殘餘風險** | 高 - 依賴使用者判斷 |
| **建議** | 實施參數驗證、參數化工具呼叫 |

#### T-EXEC-004: 執行審核繞過

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0043 - 建立對抗性資料 |
| **描述** | 攻擊者建立指令以繞過審核白名單 |
| **攻擊向量** | 指令混淆、利用別名 (alias)、路徑操縱 |
| **受影響元件** | exec-approvals.ts、指令白名單 |
| **現有緩解措施** | 白名單 + 詢問模式 |
| **殘餘風險** | 高 - 缺乏指令淨化 |
| **建議** | 實施指令規範化、擴大黑名單 |

---

### 3.4 持續性 (AML.TA0006)

#### T-PERSIST-001: 惡意 Skills 安裝

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0010.001 - 供應鏈入侵：AI 軟體 |
| **描述** | 攻擊者向 ClawHub 發佈惡意 Skills |
| **攻擊向量** | 建立帳號、發佈帶有隱藏惡意程式碼的 Skills |
| **受影響元件** | ClawHub、Skills 載入、智慧代理執行 |
| **現有緩解措施** | GitHub 帳號註冊時長驗證、基於模式的審核標記 |
| **殘餘風險** | 嚴重 - 缺乏沙箱隔離、審查有限 |
| **建議** | 整合 VirusTotal (進行中)、Skills 沙箱隔離、社群審查 |

#### T-PERSIST-002: Skills 更新污染

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0010.001 - 供應鏈入侵：AI 軟體 |
| **描述** | 攻擊者入侵熱門 Skills 並推送惡意更新 |
| **攻擊向量** | 帳號入侵、對 Skills 所有者進行社交工程 |
| **受影響元件** | ClawHub 版本控制、自動更新流程 |
| **現有緩解措施** | 版本指紋識別 |
| **殘餘風險** | 高 - 自動更新可能抓取惡意版本 |
| **建議** | 實施更新簽署、回退功能、版本固定 |

#### T-PERSIST-003: 智慧代理設定篡改

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0010.002 - 供應鏈入侵：資料 |
| **描述** | 攻擊者修改智慧代理設定以維持存取權限 |
| **攻擊向量** | 設定檔案修改、設定注入 |
| **受影響元件** | 智慧代理設定、工具策略 |
| **現有緩解措施** | 檔案權限 |
| **殘餘風險** | 中 - 需要本地存取權限 |
| **建議** | 設定完整性驗證、設定變更的稽核紀錄 |

---

### 3.5 防禦規避 (AML.TA0007)

#### T-EVADE-001: 審核模式繞過

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0043 - 建立對抗性資料 |
| **描述** | 攻擊者設計 Skills 內容以規避審核模式 |
| **攻擊向量** | Unicode 同形字、編碼技巧、動態載入 |
| **受影響元件** | ClawHub moderation.ts |
| **現有緩解措施** | 基於模式的 FLAG_RULES |
| **殘餘風險** | 高 - 簡單的正規表達式易被繞過 |
| **建議** | 增加行為分析 (VirusTotal Code Insight)、基於 AST 的偵測 |

#### T-EVADE-002: 內容封裝逃逸

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0043 - 建立對抗性資料 |
| **描述** | 攻擊者建立可逃逸 XML 封裝上下文的內容 |
| **攻擊向量** | 標籤操縱、上下文混淆、指令覆寫 |
| **受影響元件** | 外部內容封裝 |
| **現有緩解措施** | XML 標籤 + 安全性通知 |
| **殘餘風險** | 中 - 經常發現新的逃逸方法 |
| **建議** | 多層封裝、輸出端驗證 |

---

### 3.6 探索 (AML.TA0008)

#### T-DISC-001: 工具列舉

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0040 - AI 模型推論 API 存取 |
| **描述** | 攻擊者透過提示詞列舉可用工具 |
| **攻擊向量** | 「你有什麼工具？」之類的查詢 |
| **受影響元件** | 智慧代理工具註冊表 |
| **現有緩解措施** | 無特定措施 |
| **殘餘風險** | 低 - 工具通常已有文件記錄 |
| **建議** | 考慮工具可見性控制 |

#### T-DISC-002: 工作階段資料擷取

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0040 - AI 模型推論 API 存取 |
| **描述** | 攻擊者從工作階段上下文中擷取敏感資料 |
| **攻擊向量** | 「我們討論了什麼？」查詢、上下文探測 |
| **受影響元件** | 工作階段紀錄、上下文視窗 |
| **現有緩解措施** | 每個傳送者的工作階段隔離 |
| **殘餘風險** | 中 - 工作階段內的資料可被存取 |
| **建議** | 在上下文中實施敏感資料屏蔽 (Redaction) |

---

### 3.7 收集與外傳 (AML.TA0009, AML.TA0010)

#### T-EXFIL-001: 透過 web_fetch 盜取資料

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0009 - 收集 |
| **描述** | 攻擊者指示智慧代理將資料發送至外部 URL |
| **攻擊向量** | 提示詞注入導致智慧代理將資料 POST 到攻擊者伺服器 |
| **受影響元件** | web_fetch 工具 |
| **現有緩解措施** | 針對內部網路的 SSRF 封鎖 |
| **殘餘風險** | 高 - 允許外部 URL |
| **建議** | 實施 URL 白名單、具備資料分類意識 |

#### T-EXFIL-002: 未經授權的訊息發送

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0009 - 收集 |
| **描述** | 攻擊者導致智慧代理發送包含敏感資料的訊息 |
| **攻擊向量** | 提示詞注入導致智慧代理向攻擊者發送訊息 |
| **受影響元件** | 訊息工具、頻道整合 |
| **現有緩解措施** | 外發訊息門控 (Gating) |
| **殘餘風險** | 中 - 門控可能被繞過 |
| **建議** | 針對新收件者要求明確確認 |

#### T-EXFIL-003: 憑證收割

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0009 - 收集 |
| **描述** | 惡意 Skills 從智慧代理上下文中收割憑證 |
| **攻擊向量** | Skills 程式碼讀取環境變數、設定檔案 |
| **受影響元件** | Skills 執行環境 |
| **現有緩解措施** | 無針對 Skills 的特定措施 |
| **殘餘風險** | 嚴重 - Skills 以智慧代理權限執行 |
| **建議** | Skills 沙箱隔離、憑證隔離 |

---

### 3.8 影響 (AML.TA0011)

#### T-IMPACT-001: 未經授權的指令執行

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0031 - 損害 AI 模型完整性 |
| **描述** | 攻擊者在使用者系統上執行任意指令 |
| **攻擊向量** | 提示詞注入結合執行審核繞過 |
| **受影響元件** | Bash 工具、指令執行 |
| **現有緩解措施** | 執行審核、Docker 沙箱選項 |
| **殘餘風險** | 嚴重 - 無沙箱的主機執行 |
| **建議** | 預設使用沙箱、改進審核使用者體驗 (UX) |

#### T-IMPACT-002: 資源耗盡 (DoS)

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0031 - 損害 AI 模型完整性 |
| **描述** | 攻擊者耗盡 API 額度或運算資源 |
| **攻擊向量** | 自動訊息洪水、昂貴的工具呼叫 |
| **受影響元件** | Gateway、智慧代理工作階段、API 供應商 |
| **現有緩解措施** | 無 |
| **殘餘風險** | 高 - 缺乏速率限制 |
| **建議** | 實施針對傳送者的速率限制、成本預算控制 |

#### T-IMPACT-003: 名譽損害

| 屬性 | 數值 |
| --- | --- |
| **ATLAS ID** | AML.T0031 - 損害 AI 模型完整性 |
| **描述** | 攻擊者導致智慧代理發送有害/冒犯性內容 |
| **攻擊向量** | 提示詞注入導致不當回應 |
| **受影響元件** | 輸出生成、頻道通訊 |
| **現有緩解措施** | LLM 供應商的內容策略 |
| **殘餘風險** | 中 - 供應商過濾並不完美 |
| **建議** | 輸出過濾層、使用者控制項 |

---

## 4. ClawHub 供應鏈分析

### 4.1 現有安全性控制

| 控制措施 | 實施方式 | 有效性 |
| --- | --- | --- |
| GitHub 帳號時長 | `requireGitHubAccountAge()` | 中 - 提高新攻擊者的門檻 |
| 路徑規範化 | `sanitizePath()` | 高 - 防止路徑遍歷 |
| 檔案類型驗證 | `isTextFile()` | 中 - 僅限文字檔，但仍可能包含惡意內容 |
| 大小限制 | 總計 50MB 封裝 | 高 - 防止資源耗盡 |
| 必須包含 SKILL.md | 強制性 Readme | 安全價值低 - 僅供參考 |
| 模式審核 | moderation.ts 中的 FLAG_RULES | 低 - 容易被繞過 |
| 審核狀態 | `moderationStatus` 欄位 | 中 - 可進行人工審查 |

### 4.2 審核標記模式

`moderation.ts` 中的現有模式：

```javascript
// 已知的惡意識別碼
/(keepcold131\/ClawdAuthenticatorTool|ClawdAuthenticatorTool)/i

// 可疑關鍵字
/(malware|stealer|phish|phishing|keylogger)/i
/(api[-_ ]?key|token|password|private key|secret)/i
/(wallet|seed phrase|mnemonic|crypto)/i
/(discord\.gg|webhook|hooks\.slack)/i
/(curl[^\n]+\|\s*(sh|bash))/i
/(bit\.ly|tinyurl\.com|t\.co|goo\.gl|is\.gd)/i
```

**局限性：**

- 僅檢查代稱 (slug)、顯示名稱、摘要、frontmatter、元數據、檔案路徑
- 不分析實際的 Skills 程式碼內容
- 簡單的正規表達式容易透過混淆繞過
- 缺乏行為分析

### 4.3 計劃中的改進

| 改進項目 | 狀態 | 影響 |
| --- | --- | --- |
| VirusTotal 整合 | 進行中 | 高 - Code Insight 行為分析 |
| 社群檢舉 | 部分 (已存在 `skillReports` 資料表) | 中 |
| 稽核紀錄 | 部分 (已存在 `auditLogs` 資料表) | 中 |
| 徽章系統 | 已實施 | 中 - `highlighted`, `official`, `deprecated`, `redactionApproved` |

---

## 5. 風險矩陣

### 5.1 可能性 vs 影響

| 威脅 ID | 可能性 | 影響 | 風險等級 | 優先級 |
| --- | --- | --- | --- | --- |
| T-EXEC-001 | 高 | 嚴重 | **嚴重** | P0 |
| T-PERSIST-001 | 高 | 嚴重 | **嚴重** | P0 |
| T-EXFIL-003 | 中 | 嚴重 | **嚴重** | P0 |
| T-IMPACT-001 | 中 | 嚴重 | **高** | P1 |
| T-EXEC-002 | 高 | 高 | **高** | P1 |
| T-EXEC-004 | 中 | 高 | **高** | P1 |
| T-ACCESS-003 | 中 | 高 | **高** | P1 |
| T-EXFIL-001 | 中 | 高 | **高** | P1 |
| T-IMPACT-002 | 高 | 中 | **高** | P1 |
| T-EVADE-001 | 高 | 中 | **中** | P2 |
| T-ACCESS-001 | 低 | 高 | **中** | P2 |
| T-ACCESS-002 | 低 | 高 | **中** | P2 |
| T-PERSIST-002 | 低 | 高 | **中** | P2 |

### 5.2 關鍵路徑攻擊鏈

**攻擊鏈 1：基於 Skills 的資料盜取**

```
T-PERSIST-001 → T-EVADE-001 → T-EXFIL-003
(發佈惡意 Skills) → (規避審核) → (收割憑證)
```

**攻擊鏈 2：提示詞注入導致遠端程式碼執行 (RCE)**

```
T-EXEC-001 → T-EXEC-004 → T-IMPACT-001
(注入提示詞) → (繞過執行審核) → (執行指令)
```

**攻擊鏈 3：透過獲取內容進行間接注入**

```
T-EXEC-002 → T-EXFIL-001 → 外部外傳
(污染 URL 內容) → (智慧代理獲取並執行指令) → (資料發送至攻擊者)
```

---

## 6. 建議摘要

### 6.1 立即執行 (P0)

| 編號 | 建議 | 解決威脅 |
| --- | --- | --- |
| R-001 | 完成 VirusTotal 整合 | T-PERSIST-001, T-EVADE-001 |
| R-002 | 實施 Skills 沙箱隔離 | T-PERSIST-001, T-EXFIL-003 |
| R-003 | 為敏感操作增加輸出驗證 | T-EXEC-001, T-EXEC-002 |

### 6.2 短期執行 (P1)

| 編號 | 建議 | 解決威脅 |
| --- | --- | --- |
| R-004 | 實施速率限制 | T-IMPACT-002 |
| R-005 | 增加靜態權杖加密 | T-ACCESS-003 |
| R-006 | 改進執行審核使用者體驗與驗證 | T-EXEC-004 |
| R-007 | 為 web_fetch 實施 URL 白名單 | T-EXFIL-001 |

### 6.3 中期執行 (P2)

| 編號 | 建議 | 解決威脅 |
| --- | --- | --- |
| R-008 | 盡可能增加加密頻道驗證 | T-ACCESS-002 |
| R-009 | 實施設定完整性驗證 | T-PERSIST-003 |
| R-010 | 增加更新簽署和版本固定 | T-PERSIST-002 |

---

## 7. 附錄

### 7.1 ATLAS 技術映射

| ATLAS ID | 技術名稱 | OpenClaw 威脅 |
| --- | --- | --- |
| AML.T0006 | 主動掃描 | T-RECON-001, T-RECON-002 |
| AML.T0009 | 收集 | T-EXFIL-001, T-EXFIL-002, T-EXFIL-003 |
| AML.T0010.001 | 供應鏈：AI 軟體 | T-PERSIST-001, T-PERSIST-002 |
| AML.T0010.002 | 供應鏈：資料 | T-PERSIST-003 |
| AML.T0031 | 損害 AI 模型完整性 | T-IMPACT-001, T-IMPACT-002, T-IMPACT-003 |
| AML.T0040 | AI 模型推論 API 存取 | T-ACCESS-001, T-ACCESS-002, T-ACCESS-003, T-DISC-001, T-DISC-002 |
| AML.T0043 | 建立對抗性資料 | T-EXEC-004, T-EVADE-001, T-EVADE-002 |
| AML.T0051.000 | LLM 提示詞注入：直接 | T-EXEC-001, T-EXEC-003 |
| AML.T0051.001 | LLM 提示詞注入：間接 | T-EXEC-002 |

### 7.2 關鍵安全性檔案

| 路徑 | 用途 | 風險等級 |
| --- | --- | --- |
| `src/infra/exec-approvals.ts` | 指令審核邏輯 | **嚴重** |
| `src/gateway/auth.ts` | Gateway 身分驗證 | **嚴重** |
| `src/web/inbound/access-control.ts` | 頻道存取控制 | **嚴重** |
| `src/infra/net/ssrf.ts` | SSRF 防護 | **嚴重** |
| `src/security/external-content.ts` | 提示詞注入緩解 | **嚴重** |
| `src/agents/sandbox/tool-policy.ts` | 工具策略強制執行 | **嚴重** |
| `convex/lib/moderation.ts` | ClawHub 審核 | **高** |
| `convex/lib/skillPublish.ts` | Skills 發佈流程 | **高** |
| `src/routing/resolve-route.ts` | 工作階段隔離 | **中** |

### 7.3 術語表

| 術語 | 定義 |
| --- | --- |
| **ATLAS** | MITRE 的 AI 系統對抗性威脅矩陣 |
| **ClawHub** | OpenClaw 的 Skills 市集 |
| **Gateway** | OpenClaw 的訊息路由與身分驗證層 |
| **MCP** | 模型上下文協定 (Model Context Protocol) - 工具供應商介面 |
| **提示詞注入** | 在輸入中嵌入惡意指令的攻擊方式 |
| **Skills** | 可供 OpenClaw 智慧代理下載的擴充功能 |
| **SSRF** | 伺服器端請求偽造 (Server-Side Request Forgery) |

---

_本威脅模型是一份動態檔案。請向 security @openclaw.ai 回報安全性問題。_
