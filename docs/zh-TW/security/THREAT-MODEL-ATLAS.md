# OpenClaw 威脅模型 v1.0

## MITRE ATLAS 框架

**版本：** 1.0-draft
**最後更新：** 2026-02-04
**方法論：** MITRE ATLAS + 資料流圖
**框架：** [MITRE ATLAS](https://atlas.mitre.org/) (AI 系統對抗性威脅情勢)

### 框架歸屬

此威脅模型建立於 [MITRE ATLAS](https://atlas.mitre.org/) 之上，這是用於記錄 AI/ML 系統對抗性威脅的行業標準框架。ATLAS 由 [MITRE](https://www.mitre.org/) 與 AI 安全社群合作維護。

**主要 ATLAS 資源：**

- [ATLAS 技術](https://atlas.mitre.org/techniques/)
- [ATLAS 策略](https://atlas.mitre.org/tactics/)
- [ATLAS 案例研究](https://atlas.mitre.org/studies/)
- [ATLAS GitHub](https://github.com/mitre-atlas/atlas-data)
- [貢獻 ATLAS](https://atlas.mitre.org/resources/contribute)

### 貢獻此威脅模型

這是一份由 OpenClaw 社群維護的活文件。有關貢獻的準則，請參閱 [CONTRIBUTING-THREAT-MODEL.md](./CONTRIBUTING-THREAT-MODEL.md)：

- 回報新的威脅
- 更新現有威脅
- 提出攻擊鏈
- 建議緩解措施

---

## 1. 簡介

### 1.1 目的

此威脅模型使用專為 AI/ML 系統設計的 MITRE ATLAS 框架，記錄了針對 OpenClaw AI 智慧代理平台和 ClawHub 技能市集的對抗性威脅。

### 1.2 範圍

| 元件              | 包含 | 備註                                            |
| ---------------- | ---- | --------------------------------------------- |
| OpenClaw Agent Runtime | Yes  | 核心智慧代理執行、工具呼叫、工作階段          |
| Gateway          | Yes  | 憑證、路由、頻道整合                          |
| Channel Integrations | Yes  | WhatsApp, Telegram, Discord, Signal, Slack, etc. |
| ClawHub Marketplace | Yes  | 技能發布、審核、分發                          |
| MCP Servers      | Yes  | 外部工具供應商                                |
| User Devices     | Partial | 行動應用程式、桌面用戶端                      |

### 1.3 範圍外

此威脅模型沒有任何明確超出範圍的項目。

---

## 2. 系統架構

### 2.1 信任邊界

```
┌─────────────────────────────────────────────────────────────────┐
│                    UNTRUSTED ZONE                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  WhatsApp   │  │  Telegram   │  │   Discord   │  ...         │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │
│         │                │                │                      │
└─────────┼────────────────┼────────────────┼──────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 1: Channel Access                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      GATEWAY                              │   │
│  │  • 裝置配對 (30 秒寬限期)                                   │   │
│  │  • AllowFrom / AllowList 驗證                               │   │
│  │  • Token/Password/Tailscale 憑證                            │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 2: Session Isolation              │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   AGENT SESSIONS                          │   │
│  │  • 工作階段金鑰 = agent:channel:peer                       │   │
│  │  • 每個智慧代理的工具策略                                    │   │
│  │  • 記錄日誌                                                 │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 3: Tool Execution                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                  EXECUTION SANDBOX                        │   │
│  │  • Docker 沙箱或主機 (執行批准)                               │   │
│  │  • 節點遠端執行                                              │   │
│  │  • SSRF 防護 (DNS 綁定 + IP 阻擋)                           │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 4: External Content               │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              FETCHED URLs / EMAILS / WEBHOOKS             │   │
│  │  • 外部內容包裝 (XML 標籤)                                   │   │
│  │  • 安全通知注入                                              │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 5: Supply Chain                   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      CLAWHUB                              │   │
│  │  • 技能發布 (semver, 需 SKILL.md)                            │   │
│  │  • 基於模式的審核標誌                                        │   │
│  │  • VirusTotal 掃描 (即將推出)                               │   │
│  │  • GitHub 帳號年齡驗證                                       │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 資料流

| 流 | 來源  | 目的地 | 資料               | 防護           |
| ---- | ------- | ----------- | ------------------ | -------------------- |
| F1   | Channel | Gateway     | 使用者訊息         | TLS, AllowFrom       |
| F2   | Gateway | Agent       | 路由訊息           | 工作階段隔離       |
| F3   | Agent   | Tools       | 工具調用           | 策略執行           |
| F4   | Agent   | External    | web_fetch 請求     | SSRF 阻擋          |
| F5   | ClawHub | Agent       | 技能程式碼         | 審核、掃描         |
| F6   | Agent   | Channel     | 回應               | 輸出過濾           |

---

## 3. 按 ATLAS 策略進行的威脅分析

### 3.1 偵察 (AML.TA0
