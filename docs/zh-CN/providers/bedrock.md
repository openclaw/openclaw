---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
read_when:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你想在 OpenClaw 中使用 Amazon Bedrock 模型（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你需要为模型调用配置 AWS 凭证/区域（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
summary: 在 OpenClaw 中使用 Amazon Bedrock（Converse API）模型（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: Amazon Bedrock（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-03T10:04:01Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: 318f1048451a1910b70522e2f7f9dfc87084de26d9e3938a29d372eed32244a8（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: providers/bedrock.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 15（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Amazon Bedrock（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
OpenClaw 可以通过 pi‑ai 的 **Bedrock Converse** 流式提供商使用 **Amazon Bedrock** 模型。Bedrock 认证使用 **AWS SDK 默认凭证链**，而非 API 密钥。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## pi‑ai 支持的功能（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 提供商：`amazon-bedrock`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- API：`bedrock-converse-stream`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 认证：AWS 凭证（环境变量、共享配置或实例角色）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 区域：`AWS_REGION` 或 `AWS_DEFAULT_REGION`（默认：`us-east-1`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 自动模型发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果检测到 AWS 凭证，OpenClaw 可以自动发现支持**流式传输**和**文本输出**的 Bedrock 模型。发现功能使用 `bedrock:ListFoundationModels`，并会被缓存（默认：1 小时）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
配置选项位于 `models.bedrockDiscovery` 下：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  models: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    bedrockDiscovery: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      enabled: true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      region: "us-east-1",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      providerFilter: ["anthropic", "amazon"],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      refreshInterval: 3600,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      defaultContextWindow: 32000,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      defaultMaxTokens: 4096,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
注意事项：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `enabled` 在存在 AWS 凭证时默认为 `true`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `region` 默认为 `AWS_REGION` 或 `AWS_DEFAULT_REGION`，然后是 `us-east-1`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `providerFilter` 匹配 Bedrock 提供商名称（例如 `anthropic`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `refreshInterval` 单位为秒；设置为 `0` 可禁用缓存。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `defaultContextWindow`（默认：`32000`）和 `defaultMaxTokens`（默认：`4096`）用于已发现的模型（如果你知道模型限制，可以覆盖这些值）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 设置（手动）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 确保 AWS 凭证在 **Gateway 网关主机**上可用：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_ACCESS_KEY_ID="AKIA..."（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_SECRET_ACCESS_KEY="..."（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_REGION="us-east-1"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 可选：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_SESSION_TOKEN="..."（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_PROFILE="your-profile"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 可选（Bedrock API 密钥/Bearer 令牌）：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_BEARER_TOKEN_BEDROCK="..."（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 在配置中添加 Bedrock 提供商和模型（无需 `apiKey`）：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  models: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    providers: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "amazon-bedrock": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        baseUrl: "https://bedrock-runtime.us-east-1.amazonaws.com",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        api: "bedrock-converse-stream",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        auth: "aws-sdk",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        models: [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            id: "anthropic.claude-opus-4-5-20251101-v1:0",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            name: "Claude Opus 4.5 (Bedrock)",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            reasoning: true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            input: ["text", "image"],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            contextWindow: 200000,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            maxTokens: 8192,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        ],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  agents: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    defaults: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      model: { primary: "amazon-bedrock/anthropic.claude-opus-4-5-20251101-v1:0" },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## EC2 实例角色（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
当在附加了 IAM 角色的 EC2 实例上运行 OpenClaw 时，AWS SDK 会自动使用实例元数据服务（IMDS）进行认证。但是，OpenClaw 的凭证检测目前只检查环境变量，不检查 IMDS 凭证。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**解决方法：** 设置 `AWS_PROFILE=default` 以表明 AWS 凭证可用。实际认证仍然通过 IMDS 使用实例角色。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 添加到 ~/.bashrc 或你的 shell 配置文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_PROFILE=default（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export AWS_REGION=us-east-1（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
EC2 实例角色**所需的 IAM 权限**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `bedrock:InvokeModel`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `bedrock:InvokeModelWithResponseStream`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `bedrock:ListFoundationModels`（用于自动发现）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
或者附加托管策略 `AmazonBedrockFullAccess`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**快速设置：**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 1. 创建 IAM 角色和实例配置文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
aws iam create-role --role-name EC2-Bedrock-Access \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --assume-role-policy-document '{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "Version": "2012-10-17",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "Statement": [{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "Effect": "Allow",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "Principal": {"Service": "ec2.amazonaws.com"},（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "Action": "sts:AssumeRole"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }'（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
aws iam attach-role-policy --role-name EC2-Bedrock-Access \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --policy-arn arn:aws:iam::aws:policy/AmazonBedrockFullAccess（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
aws iam create-instance-profile --instance-profile-name EC2-Bedrock-Access（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
aws iam add-role-to-instance-profile \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --instance-profile-name EC2-Bedrock-Access \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --role-name EC2-Bedrock-Access（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 2. 附加到你的 EC2 实例（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
aws ec2 associate-iam-instance-profile \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --instance-id i-xxxxx \（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  --iam-instance-profile Name=EC2-Bedrock-Access（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 3. 在 EC2 实例上启用发现功能（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw config set models.bedrockDiscovery.enabled true（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw config set models.bedrockDiscovery.region us-east-1（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 4. 设置解决方法所需的环境变量（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
echo 'export AWS_PROFILE=default' >> ~/.bashrc（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
echo 'export AWS_REGION=us-east-1' >> ~/.bashrc（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
source ~/.bashrc（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 5. 验证模型已被发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw models list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 注意事项（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Bedrock 需要在你的 AWS 账户/区域中启用**模型访问**。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 自动发现需要 `bedrock:ListFoundationModels` 权限。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 如果你使用配置文件，请在 Gateway 网关主机上设置 `AWS_PROFILE`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- OpenClaw 按以下顺序获取凭证来源：`AWS_BEARER_TOKEN_BEDROCK`，然后是 `AWS_ACCESS_KEY_ID` + `AWS_SECRET_ACCESS_KEY`，然后是 `AWS_PROFILE`，最后是默认的 AWS SDK 链。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 推理支持取决于模型；请查看 Bedrock 模型卡了解当前功能。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 如果你更喜欢托管密钥流程，也可以在 Bedrock 前面放置一个 OpenAI 兼容的代理，并将其配置为 OpenAI 提供商。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
