---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
description: Deploy OpenClaw on Fly.io（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: Fly.io（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-03T07:52:55Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: a00bae43e416112eb269126445c51492a30abe9e136d89e161fc4193314a876f（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: platforms/fly.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 15（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Fly.io 部署（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**目标：** OpenClaw Gateway 网关运行在 [Fly.io](https://fly.io) 机器上，具有持久存储、自动 HTTPS 和 Discord/渠道访问。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 你需要什么（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 已安装 [flyctl CLI](https://fly.io/docs/hands-on/install-flyctl/)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Fly.io 账户（免费套餐可用）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 模型认证：Anthropic API 密钥（或其他提供商密钥）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 渠道凭证：Discord bot token、Telegram token 等（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 初学者快速路径（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 克隆仓库 → 自定义 `fly.toml`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 创建应用 + 卷 → 设置密钥（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 使用 `fly deploy` 部署（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
4. SSH 进入创建配置或使用 Control UI（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 1）创建 Fly 应用（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Clone the repo（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
git clone https://github.com/openclaw/openclaw.git（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
cd openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Create a new Fly app (pick your own name)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly apps create my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Create a persistent volume (1GB is usually enough)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly volumes create openclaw_data --size 1 --region iad（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**提示：** 选择离你近的区域。常见选项：`lhr`（伦敦）、`iad`（弗吉尼亚）、`sjc`（圣何塞）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 2）配置 fly.toml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
编辑 `fly.toml` 以匹配你的应用名称和需求。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**安全注意事项：** 默认配置暴露公共 URL。对于没有公共 IP 的加固部署，参见[私有部署](#私有部署加固)或使用 `fly.private.toml`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```toml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
app = "my-openclaw"  # Your app name（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
primary_region = "iad"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[build]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  dockerfile = "Dockerfile"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[env]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  NODE_ENV = "production"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  OPENCLAW_PREFER_PNPM = "1"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  OPENCLAW_STATE_DIR = "/data"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  NODE_OPTIONS = "--max-old-space-size=1536"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[processes]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  app = "node dist/index.js gateway --allow-unconfigured --port 3000 --bind lan"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[http_service]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  internal_port = 3000（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  force_https = true（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  auto_stop_machines = false（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  auto_start_machines = true（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  min_machines_running = 1（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  processes = ["app"]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[[vm]]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  size = "shared-cpu-2x"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  memory = "2048mb"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[mounts]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source = "openclaw_data"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  destination = "/data"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**关键设置：**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| 设置                           | 原因                                                                      |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| ------------------------------ | ------------------------------------------------------------------------- |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| `--bind lan`                   | 绑定到 `0.0.0.0` 以便 Fly 的代理可以访问 Gateway 网关                     |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| `--allow-unconfigured`         | 无需配置文件启动（你稍后会创建一个）                                      |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| `internal_port = 3000`         | 必须与 `--port 3000`（或 `OPENCLAW_GATEWAY_PORT`）匹配以进行 Fly 健康检查 |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| `memory = "2048mb"`            | 512MB 太小；推荐 2GB                                                      |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| `OPENCLAW_STATE_DIR = "/data"` | 在卷上持久化状态                                                          |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 3）设置密钥（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Required: Gateway token (for non-loopback binding)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly secrets set OPENCLAW_GATEWAY_TOKEN=$(openssl rand -hex 32)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Model provider API keys（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly secrets set ANTHROPIC_API_KEY=sk-ant-...（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Optional: Other providers（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly secrets set OPENAI_API_KEY=sk-...（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly secrets set GOOGLE_API_KEY=...（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Channel tokens（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly secrets set DISCORD_BOT_TOKEN=MTQ...（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意事项：**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 非 loopback 绑定（`--bind lan`）出于安全需要 `OPENCLAW_GATEWAY_TOKEN`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 像对待密码一样对待这些 token。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **优先使用环境变量而不是配置文件**来存储所有 API 密钥和 token。这可以避免密钥出现在 `openclaw.json` 中，防止意外暴露或记录。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 4）部署（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly deploy（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
首次部署构建 Docker 镜像（约 2-3 分钟）。后续部署更快。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
部署后验证：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly status（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly logs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
你应该看到：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[gateway] listening on ws://0.0.0.0:3000 (PID xxx)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[discord] logged in to discord as xxx（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 5）创建配置文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
SSH 进入机器创建正确的配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
创建配置目录和文件：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
mkdir -p /data（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
cat > /data/openclaw.json << 'EOF'（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "agents": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "defaults": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "model": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "primary": "anthropic/claude-opus-4-5",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "fallbacks": ["anthropic/claude-sonnet-4-5", "openai/gpt-4o"]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "maxConcurrent": 4（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "list": [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "id": "main",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "default": true（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "auth": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "profiles": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "anthropic:default": { "mode": "token", "provider": "anthropic" },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "openai:default": { "mode": "token", "provider": "openai" }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "bindings": [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "agentId": "main",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "match": { "channel": "discord" }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  ],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "channels": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "discord": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "groupPolicy": "allowlist",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "guilds": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "YOUR_GUILD_ID": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "channels": { "general": { "allow": true } },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "requireMention": false（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "gateway": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "mode": "local",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "bind": "auto"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "meta": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "lastTouchedVersion": "2026.1.29"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
EOF（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意：** 使用 `OPENCLAW_STATE_DIR=/data` 时，配置路径是 `/data/openclaw.json`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意：** Discord token 可以来自：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 环境变量：`DISCORD_BOT_TOKEN`（推荐用于密钥）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 配置文件：`channels.discord.token`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果使用环境变量，无需将 token 添加到配置中。Gateway 网关会自动读取 `DISCORD_BOT_TOKEN`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
重启以应用：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
exit（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machine restart <machine-id>（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 6）访问 Gateway 网关（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Control UI（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在浏览器中打开：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly open（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
或访问 `https://my-openclaw.fly.dev/`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
粘贴你的 Gateway 网关 token（来自 `OPENCLAW_GATEWAY_TOKEN` 的那个）进行认证。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 日志（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly logs              # Live logs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly logs --no-tail    # Recent logs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### SSH 控制台（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 故障排除（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### "App is not listening on expected address"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Gateway 网关绑定到 `127.0.0.1` 而不是 `0.0.0.0`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**修复：** 在 `fly.toml` 中的进程命令添加 `--bind lan`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 健康检查失败 / 连接被拒绝（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Fly 无法在配置的端口上访问 Gateway 网关。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**修复：** 确保 `internal_port` 与 Gateway 网关端口匹配（设置 `--port 3000` 或 `OPENCLAW_GATEWAY_PORT=3000`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### OOM / 内存问题（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
容器持续重启或被终止。迹象：`SIGABRT`、`v8::internal::Runtime_AllocateInYoungGeneration` 或静默重启。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**修复：** 在 `fly.toml` 中增加内存：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```toml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
[[vm]]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  memory = "2048mb"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
或更新现有机器：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machine update <machine-id> --vm-memory 2048 -y（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意：** 512MB 太小。1GB 可能可以工作但在负载或详细日志记录下可能 OOM。**推荐 2GB。**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Gateway 网关锁问题（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Gateway 网关拒绝启动并显示"already running"错误。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
这发生在容器重启但 PID 锁文件在卷上持久存在时。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**修复：** 删除锁文件：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console --command "rm -f /data/gateway.*.lock"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machine restart <machine-id>（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
锁文件在 `/data/gateway.*.lock`（不在子目录中）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 配置未被读取（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果使用 `--allow-unconfigured`，Gateway 网关会创建最小配置。你在 `/data/openclaw.json` 的自定义配置应该在重启时被读取。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
验证配置是否存在：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console --command "cat /data/openclaw.json"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 通过 SSH 写入配置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
`fly ssh console -C` 命令不支持 shell 重定向。要写入配置文件：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Use echo + tee (pipe from local to remote)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
echo '{"your":"config"}' | fly ssh console -C "tee /data/openclaw.json"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Or use sftp（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly sftp shell（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
> put /local/path/config.json /data/openclaw.json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意：** 如果文件已存在，`fly sftp` 可能会失败。先删除：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console --command "rm /data/openclaw.json"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 状态未持久化（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果重启后丢失凭证或会话，状态目录正在写入容器文件系统。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**修复：** 确保 `fly.toml` 中设置了 `OPENCLAW_STATE_DIR=/data` 并重新部署。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 更新（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Pull latest changes（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
git pull（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Redeploy（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly deploy（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Check health（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly status（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly logs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 更新机器命令（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果你需要更改启动命令而无需完全重新部署：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Get machine ID（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machines list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Update command（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machine update <machine-id> --command "node dist/index.js gateway --port 3000 --bind lan" -y（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Or with memory increase（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly machine update <machine-id> --vm-memory 2048 --command "node dist/index.js gateway --port 3000 --bind lan" -y（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**注意：** `fly deploy` 后，机器命令可能会重置为 `fly.toml` 中的内容。如果你进行了手动更改，请在部署后重新应用它们。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 私有部署（加固）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
默认情况下，Fly 分配公共 IP，使你的 Gateway 网关可通过 `https://your-app.fly.dev` 访问。这很方便，但意味着你的部署可被互联网扫描器（Shodan、Censys 等）发现。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
对于**无公共暴露**的加固部署，使用私有模板。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 何时使用私有部署（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 你只进行**出站**调用/消息（无入站 webhooks）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 你使用 **ngrok 或 Tailscale** 隧道处理任何 webhook 回调（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 你通过 **SSH、代理或 WireGuard** 而不是浏览器访问 Gateway 网关（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 你希望部署**对互联网扫描器隐藏**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 设置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
使用 `fly.private.toml` 替代标准配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Deploy with private config（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly deploy -c fly.private.toml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
或转换现有部署：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# List current IPs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ips list -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Release public IPs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ips release <public-ipv4> -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ips release <public-ipv6> -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Switch to private config so future deploys don't re-allocate public IPs（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# (remove [http_service] or deploy with the private template)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly deploy -c fly.private.toml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Allocate private-only IPv6（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ips allocate-v6 --private -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
此后，`fly ips list` 应该只显示 `private` 类型的 IP：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
VERSION  IP                   TYPE             REGION（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
v6       fdaa:x:x:x:x::x      private          global（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 访问私有部署（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
由于没有公共 URL，使用以下方法之一：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**选项 1：本地代理（最简单）**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Forward local port 3000 to the app（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly proxy 3000:3000 -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Then open http://localhost:3000 in browser（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**选项 2：WireGuard VPN**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Create WireGuard config (one-time)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly wireguard create（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Import to WireGuard client, then access via internal IPv6（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Example: http://[fdaa:x:x:x:x::x]:3000（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**选项 3：仅 SSH**（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
fly ssh console -a my-openclaw（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 私有部署的 Webhooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果你需要 webhook 回调（Twilio、Telnyx 等）而不暴露公共：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. **ngrok 隧道** - 在容器内或作为 sidecar 运行 ngrok（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. **Tailscale Funnel** - 通过 Tailscale 暴露特定路径（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. **仅出站** - 某些提供商（Twilio）对于出站呼叫无需 webhooks 也能正常工作（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
使用 ngrok 的示例语音通话配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "plugins": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "entries": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "voice-call": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "config": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "provider": "twilio",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "tunnel": { "provider": "ngrok" }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
ngrok 隧道在容器内运行并提供公共 webhook URL，而不暴露 Fly 应用本身。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 安全优势（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| 方面            | 公共   | 私有     |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| --------------- | ------ | -------- |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| 互联网扫描器    | 可发现 | 隐藏     |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| 直接攻击        | 可能   | 被阻止   |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| Control UI 访问 | 浏览器 | 代理/VPN |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
| Webhook 投递    | 直接   | 通过隧道 |（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 注意事项（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Fly.io 使用 **x86 架构**（非 ARM）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Dockerfile 兼容两种架构（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 对于 WhatsApp/Telegram 新手引导，使用 `fly ssh console`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 持久数据位于 `/data` 卷上（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Signal 需要 Java + signal-cli；使用自定义镜像并保持内存在 2GB+。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 成本（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
使用推荐配置（`shared-cpu-2x`，2GB RAM）：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 根据使用情况约 $10-15/月（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 免费套餐包含一些配额（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
详情参见 [Fly.io 定价](https://fly.io/docs/about/pricing/)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
