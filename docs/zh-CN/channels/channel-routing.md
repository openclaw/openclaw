---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
read_when:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 更改渠道路由或收件箱行为（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
summary: 每个渠道（WhatsApp、Telegram、Discord、Slack）的路由规则及共享上下文（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: 渠道路由（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-01T20:22:21Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: 1a322b5187e32c82fc1e8aac02437e2eeb7ba84e7b3a1db89feeab1dcf7dbbab（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: channels/channel-routing.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 14（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 渠道与路由（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
OpenClaw 将回复**路由回消息来源的渠道**。模型不会选择渠道；路由是确定性的，由主机配置控制。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 关键术语（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **渠道**：`whatsapp`、`telegram`、`discord`、`slack`、`signal`、`imessage`、`webchat`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **AccountId**：每个渠道的账户实例（在支持的情况下）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **AgentId**：隔离的工作区 + 会话存储（"大脑"）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **SessionKey**：用于存储上下文和控制并发的桶键。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 会话键格式（示例）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
私信会折叠到智能体的**主**会话：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `agent:<agentId>:<mainKey>`（默认：`agent:main:main`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
群组和渠道按渠道隔离：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 群组：`agent:<agentId>:<channel>:group:<id>`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 渠道/房间：`agent:<agentId>:<channel>:channel:<id>`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
线程：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Slack/Discord 线程会在基础键后追加 `:thread:<threadId>`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Telegram 论坛主题在群组键中嵌入 `:topic:<topicId>`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
示例：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `agent:main:telegram:group:-1001234567890:topic:42`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `agent:main:discord:channel:123456:thread:987654`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 路由规则（如何选择智能体）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
路由为每条入站消息选择**一个智能体**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. **精确对端匹配**（`bindings` 中的 `peer.kind` + `peer.id`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. **Guild 匹配**（Discord）通过 `guildId`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. **Team 匹配**（Slack）通过 `teamId`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
4. **账户匹配**（渠道上的 `accountId`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
5. **渠道匹配**（该渠道上的任意账户）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
6. **默认智能体**（`agents.list[].default`，否则取列表第一项，兜底为 `main`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
匹配到的智能体决定使用哪个工作区和会话存储。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 广播组（运行多个智能体）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
广播组允许你为同一对端运行**多个智能体**，**在 OpenClaw 正常回复时**触发（例如：在 WhatsApp 群组中，经过提及/激活门控之后）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  broadcast: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    strategy: "parallel",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "120363403215116621@g.us": ["alfred", "baerbel"],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "+15555550123": ["support", "logger"],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
参见：[广播组](/channels/broadcast-groups)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 配置概览（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `agents.list`：命名的智能体定义（工作区、模型等）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `bindings`：将入站渠道/账户/对端映射到智能体。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
示例：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  agents: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    list: [{ id: "support", name: "Support", workspace: "~/.openclaw/workspace-support" }],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  bindings: [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    { match: { channel: "slack", teamId: "T123" }, agentId: "support" },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    { match: { channel: "telegram", peer: { kind: "group", id: "-100123" } }, agentId: "support" },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  ],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 会话存储（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
会话存储位于状态目录下（默认 `~/.openclaw`）：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `~/.openclaw/agents/<agentId>/sessions/sessions.json`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- JSONL 记录文件与存储位于同一目录（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
你可以通过 `session.store` 和 `{agentId}` 模板来覆盖存储路径。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## WebChat 行为（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
WebChat 连接到**所选智能体**，并默认使用该智能体的主会话。因此，WebChat 让你可以在一个地方查看该智能体的跨渠道上下文。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 回复上下文（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
入站回复包含：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `ReplyToId`、`ReplyToBody` 和 `ReplyToSender`（在可用时）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 引用的上下文会以 `[Replying to ...]` 块的形式追加到 `Body` 中。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
这在所有渠道中保持一致。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
