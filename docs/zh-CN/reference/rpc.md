---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
read_when:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 添加或更改外部 CLI 集成（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 调试 RPC 适配器（signal-cli、imsg）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
summary: 外部 CLI（signal-cli、imsg）的 RPC 适配器和 Gateway 网关模式（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: RPC 适配器（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-03T07:53:44Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: c04edc952390304a22a3a4763aca00a0311b38d390477ec0be5fe485ec257fa7（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: reference/rpc.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 15（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# RPC 适配器（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
OpenClaw 通过 JSON-RPC 集成外部 CLI。目前使用两种模式。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 模式 A：HTTP 守护进程（signal-cli）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `signal-cli` 作为守护进程运行，通过 HTTP 使用 JSON-RPC。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 事件流是 SSE（`/api/v1/events`）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 健康探测：`/api/v1/check`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 当 `channels.signal.autoStart=true` 时，OpenClaw 负责生命周期管理。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
设置和端点参见 [Signal](/channels/signal)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 模式 B：stdio 子进程（imsg）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- OpenClaw 将 `imsg rpc` 作为子进程生成。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- JSON-RPC 是通过 stdin/stdout 的行分隔格式（每行一个 JSON 对象）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 无需 TCP 端口，无需守护进程。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
使用的核心方法：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `watch.subscribe` → 通知（`method: "message"`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `watch.unsubscribe`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `send`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `chats.list`（探测/诊断）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
设置和寻址（首选 `chat_id`）参见 [iMessage](/channels/imessage)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 适配器指南（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Gateway 网关负责进程（启动/停止与提供商生命周期绑定）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 保持 RPC 客户端弹性：超时、退出时重启。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 优先使用稳定 ID（例如 `chat_id`）而非显示字符串。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
