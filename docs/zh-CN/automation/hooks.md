---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
read_when:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你想为 /new、/reset、/stop 和智能体生命周期事件实现事件驱动自动化（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你想构建、安装或调试 hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
summary: Hooks：用于命令和生命周期事件的事件驱动自动化（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-03T07:50:59Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: 853227a0f1abd20790b425fa64dda60efc6b5f93c1b13ecd2dcb788268f71d79（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: automation/hooks.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 15（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 提供了一个可扩展的事件驱动系统，用于响应智能体命令和事件自动执行操作。Hooks 从目录中自动发现，可以通过 CLI 命令管理，类似于 OpenClaw 中 Skills 的工作方式。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 入门指南（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 是在事件发生时运行的小脚本。有两种类型：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **Hooks**（本页）：当智能体事件触发时在 Gateway 网关内运行，如 `/new`、`/reset`、`/stop` 或生命周期事件。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **Webhooks**：外部 HTTP webhooks，让其他系统触发 OpenClaw 中的工作。参见 [Webhook Hooks](/automation/webhook) 或使用 `openclaw webhooks` 获取 Gmail 助手命令。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 也可以捆绑在插件中；参见 [插件](/tools/plugin#plugin-hooks)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
常见用途：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 重置会话时保存记忆快照（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 保留命令审计跟踪用于故障排除或合规（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 会话开始或结束时触发后续自动化（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 事件触发时向智能体工作区写入文件或调用外部 API（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果你能写一个小的 TypeScript 函数，你就能写一个 hook。Hooks 会自动发现，你可以通过 CLI 启用或禁用它们。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 概述（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
hooks 系统允许你：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 在发出 `/new` 时将会话上下文保存到记忆（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 记录所有命令以供审计（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 在智能体生命周期事件上触发自定义自动化（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 在不修改核心代码的情况下扩展 OpenClaw 的行为（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 入门（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 捆绑的 Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
OpenClaw 附带四个自动发现的捆绑 hooks：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **💾 session-memory**：当你发出 `/new` 时将会话上下文保存到智能体工作区（默认 `~/.openclaw/workspace/memory/`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **📝 command-logger**：将所有命令事件记录到 `~/.openclaw/logs/commands.log`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **🚀 boot-md**：当 Gateway 网关启动时运行 `BOOT.md`（需要启用内部 hooks）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **😈 soul-evil**：在清除窗口期间或随机机会下将注入的 `SOUL.md` 内容替换为 `SOUL_EVIL.md`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
列出可用的 hooks：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
启用一个 hook：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
检查 hook 状态：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks check（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
获取详细信息：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks info session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 新手引导（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在新手引导期间（`openclaw onboard`），你将被提示启用推荐的 hooks。向导会自动发现符合条件的 hooks 并呈现供选择。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## Hook 发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 从三个目录自动发现（按优先级顺序）：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. **工作区 hooks**：`<workspace>/hooks/`（每智能体，最高优先级）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. **托管 hooks**：`~/.openclaw/hooks/`（用户安装，跨工作区共享）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. **捆绑 hooks**：`<openclaw>/dist/hooks/bundled/`（随 OpenClaw 附带）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
托管 hook 目录可以是**单个 hook** 或 **hook 包**（包目录）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
每个 hook 是一个包含以下内容的目录：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
my-hook/（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
├── HOOK.md          # 元数据 + 文档（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
└── handler.ts       # 处理程序实现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## Hook 包（npm/archives）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hook 包是标准的 npm 包，通过 `package.json` 中的 `openclaw.hooks` 导出一个或多个 hooks。使用以下命令安装：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks install <path-or-spec>（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
示例 `package.json`：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "name": "@acme/my-hooks",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "version": "0.1.0",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "openclaw": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "hooks": ["./hooks/my-hook", "./hooks/other-hook"]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
每个条目指向包含 `HOOK.md` 和 `handler.ts`（或 `index.ts`）的 hook 目录。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hook 包可以附带依赖；它们将安装在 `~/.openclaw/hooks/<id>` 下。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## Hook 结构（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### HOOK.md 格式（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
`HOOK.md` 文件在 YAML frontmatter 中包含元数据，加上 Markdown 文档：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```markdown（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
name: my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
description: "Short description of what this hook does"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
homepage: https://docs.openclaw.ai/hooks#my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
metadata:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  { "openclaw": { "emoji": "🔗", "events": ["command:new"], "requires": { "bins": ["node"] } } }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# My Hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Detailed documentation goes here...（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## What It Does（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Listens for `/new` commands（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Performs some action（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Logs the result（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## Requirements（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- Node.js must be installed（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## Configuration（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
No configuration needed.（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 元数据字段（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
`metadata.openclaw` 对象支持：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`emoji`**：CLI 的显示表情符号（例如 `"💾"`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`events`**：要监听的事件数组（例如 `["command:new", "command:reset"]`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`export`**：要使用的命名导出（默认为 `"default"`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`homepage`**：文档 URL（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`requires`**：可选要求（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - **`bins`**：PATH 中需要的二进制文件（例如 `["git", "node"]`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - **`anyBins`**：这些二进制文件中至少有一个必须存在（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - **`env`**：需要的环境变量（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - **`config`**：需要的配置路径（例如 `["workspace.dir"]`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - **`os`**：需要的平台（例如 `["darwin", "linux"]`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`always`**：绕过资格检查（布尔值）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`install`**：安装方法（对于捆绑 hooks：`[{"id":"bundled","kind":"bundled"}]`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 处理程序实现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
`handler.ts` 文件导出一个 `HookHandler` 函数：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import type { HookHandler } from "../../src/hooks/hooks.js";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const myHandler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Only trigger on 'new' command（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  if (event.type !== "command" || event.action !== "new") {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    return;（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  console.log(`[my-hook] New command triggered`);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  console.log(`  Session: ${event.sessionKey}`);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  console.log(`  Timestamp: ${event.timestamp.toISOString()}`);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Your custom logic here（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Optionally send message to user（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  event.messages.push("✨ My hook executed!");（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export default myHandler;（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
#### 事件上下文（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
每个事件包含：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  type: 'command' | 'session' | 'agent' | 'gateway',（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  action: string,              // e.g., 'new', 'reset', 'stop'（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  sessionKey: string,          // Session identifier（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  timestamp: Date,             // When the event occurred（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  messages: string[],          // Push messages here to send to user（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  context: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    sessionEntry?: SessionEntry,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    sessionId?: string,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    sessionFile?: string,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    commandSource?: string,    // e.g., 'whatsapp', 'telegram'（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    senderId?: string,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    workspaceDir?: string,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    bootstrapFiles?: WorkspaceBootstrapFile[],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    cfg?: OpenClawConfig（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 事件类型（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 命令事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
当发出智能体命令时触发：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`command`**：所有命令事件（通用监听器）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`command:new`**：当发出 `/new` 命令时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`command:reset`**：当发出 `/reset` 命令时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`command:stop`**：当发出 `/stop` 命令时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 智能体事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`agent:bootstrap`**：在注入工作区引导文件之前（hooks 可以修改 `context.bootstrapFiles`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Gateway 网关事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
当 Gateway 网关启动时触发：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`gateway:startup`**：在渠道启动和 hooks 加载之后（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 工具结果 Hooks（插件 API）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
这些 hooks 不是事件流监听器；它们让插件在 OpenClaw 持久化工具结果之前同步调整它们。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`tool_result_persist`**：在工具结果写入会话记录之前转换它们。必须是同步的；返回更新后的工具结果负载或 `undefined` 保持原样。参见 [智能体循环](/concepts/agent-loop)。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 未来事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
计划中的事件类型：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`session:start`**：当新会话开始时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`session:end`**：当会话结束时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`agent:error`**：当智能体遇到错误时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`message:sent`**：当消息被发送时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`message:received`**：当消息被接收时（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 创建自定义 Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 1. 选择位置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **工作区 hooks**（`<workspace>/hooks/`）：每智能体，最高优先级（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **托管 hooks**（`~/.openclaw/hooks/`）：跨工作区共享（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 2. 创建目录结构（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
mkdir -p ~/.openclaw/hooks/my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
cd ~/.openclaw/hooks/my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 3. 创建 HOOK.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```markdown（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
name: my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
description: "Does something useful"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
metadata: { "openclaw": { "emoji": "🎯", "events": ["command:new"] } }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# My Custom Hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
This hook does something useful when you issue `/new`.（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 4. 创建 handler.ts（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import type { HookHandler } from "../../src/hooks/hooks.js";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  if (event.type !== "command" || event.action !== "new") {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    return;（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  console.log("[my-hook] Running!");（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Your logic here（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export default handler;（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 5. 启用并测试（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Verify hook is discovered（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Enable it（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Restart your gateway process (menu bar app restart on macOS, or restart your dev process)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Trigger the event（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Send /new via your messaging channel（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 配置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 新配置格式（推荐）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "entries": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "session-memory": { "enabled": true },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "command-logger": { "enabled": false }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 每 Hook 配置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 可以有自定义配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "entries": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "my-hook": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "env": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            "MY_CUSTOM_VAR": "value"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 额外目录（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
从额外目录加载 hooks：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "load": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "extraDirs": ["/path/to/more/hooks"]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 遗留配置格式（仍然支持）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
旧配置格式仍然有效以保持向后兼容：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "handlers": [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "event": "command:new",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "module": "./hooks/handlers/my-handler.ts",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "export": "default"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      ]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**迁移**：对新 hooks 使用基于发现的新系统。遗留处理程序在基于目录的 hooks 之后加载。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## CLI 命令（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 列出 Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# List all hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Show only eligible hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list --eligible（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Verbose output (show missing requirements)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list --verbose（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# JSON output（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list --json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Hook 信息（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Show detailed info about a hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks info session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# JSON output（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks info session-memory --json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 检查资格（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Show eligibility summary（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks check（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# JSON output（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks check --json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 启用/禁用（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Enable a hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Disable a hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks disable command-logger（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 捆绑的 Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
当你发出 `/new` 时将会话上下文保存到记忆。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**事件**：`command:new`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**要求**：必须配置 `workspace.dir`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**输出**：`<workspace>/memory/YYYY-MM-DD-slug.md`（默认为 `~/.openclaw/workspace`）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**功能**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 使用预重置会话条目定位正确的记录（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 提取最后 15 行对话（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 使用 LLM 生成描述性文件名 slug（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
4. 将会话元数据保存到带日期的记忆文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**示例输出**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```markdown（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Session: 2026-01-16 14:30:00 UTC（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **Session Key**: agent:main:main（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **Session ID**: abc123def456（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **Source**: telegram（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**文件名示例**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `2026-01-16-vendor-pitch.md`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `2026-01-16-api-design.md`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `2026-01-16-1430.md`（如果 slug 生成失败则回退到时间戳）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**启用**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable session-memory（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### command-logger（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
将所有命令事件记录到集中审计文件。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**事件**：`command`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**要求**：无（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**输出**：`~/.openclaw/logs/commands.log`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**功能**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 捕获事件详情（命令操作、时间戳、会话键、发送者 ID、来源）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 以 JSONL 格式追加到日志文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 在后台静默运行（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**示例日志条目**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```jsonl（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{"timestamp":"2026-01-16T14:30:00.000Z","action":"new","sessionKey":"agent:main:main","senderId":"+1234567890","source":"telegram"}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{"timestamp":"2026-01-16T15:45:22.000Z","action":"stop","sessionKey":"agent:main:main","senderId":"user@example.com","source":"whatsapp"}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**查看日志**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# View recent commands（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
tail -n 20 ~/.openclaw/logs/commands.log（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Pretty-print with jq（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
cat ~/.openclaw/logs/commands.log | jq .（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Filter by action（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
grep '"action":"new"' ~/.openclaw/logs/commands.log | jq .（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**启用**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable command-logger（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### soul-evil（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在清除窗口期间或随机机会下将注入的 `SOUL.md` 内容替换为 `SOUL_EVIL.md`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**事件**：`agent:bootstrap`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**文档**：[SOUL Evil Hook](/hooks/soul-evil)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**输出**：不写入文件；替换仅在内存中发生。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**启用**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable soul-evil（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**配置**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "entries": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        "soul-evil": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "file": "SOUL_EVIL.md",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "chance": 0.1,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "purge": { "at": "21:00", "duration": "15m" }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### boot-md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
当 Gateway 网关启动时运行 `BOOT.md`（在渠道启动之后）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
必须启用内部 hooks 才能运行。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**事件**：`gateway:startup`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**要求**：必须配置 `workspace.dir`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**功能**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 从你的工作区读取 `BOOT.md`（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 通过智能体运行器运行指令（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 通过 message 工具发送任何请求的出站消息（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**启用**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks enable boot-md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 最佳实践（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 保持处理程序快速（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Hooks 在命令处理期间运行。保持它们轻量：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
// ✓ Good - async work, returns immediately（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  void processInBackground(event); // Fire and forget（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
// ✗ Bad - blocks command processing（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  await slowDatabaseQuery(event);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  await evenSlowerAPICall(event);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 优雅处理错误（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
始终包装有风险的操作：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  try {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    await riskyOperation(event);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  } catch (err) {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    console.error("[my-handler] Failed:", err instanceof Error ? err.message : String(err));（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    // Don't throw - let other handlers run（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 尽早过滤事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
如果事件不相关则尽早返回：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Only handle 'new' commands（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  if (event.type !== "command" || event.action !== "new") {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    return;（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Your logic here（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 使用特定事件键（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
尽可能在元数据中指定确切事件：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```yaml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
metadata: { "openclaw": { "events": ["command:new"] } } # Specific（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
而不是：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```yaml（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
metadata: { "openclaw": { "events": ["command"] } } # General - more overhead（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 调试（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 启用 Hook 日志（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Gateway 网关在启动时记录 hook 加载：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Registered hook: session-memory -> command:new（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Registered hook: command-logger -> command（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Registered hook: boot-md -> gateway:startup（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 检查发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
列出所有发现的 hooks：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks list --verbose（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 检查注册（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在你的处理程序中，记录它被调用的时间：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
const handler: HookHandler = async (event) => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  console.log("[my-handler] Triggered:", event.type, event.action);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Your logic（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
};（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 验证资格（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
检查为什么 hook 不符合条件：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks info my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在输出中查找缺失的要求。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 测试（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Gateway 网关日志（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
监控 Gateway 网关日志以查看 hook 执行：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# macOS（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
./scripts/clawlog.sh -f（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Other platforms（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
tail -f ~/.openclaw/gateway.log（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 直接测试 Hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
隔离测试你的处理程序：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```typescript（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import { test } from "vitest";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import { createHookEvent } from "./src/hooks/hooks.js";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import myHandler from "./hooks/my-hook/handler.js";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
test("my handler works", async () => {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  const event = createHookEvent("command", "new", "test-session", {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    foo: "bar",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  });（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  await myHandler(event);（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  // Assert side effects（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
});（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 架构（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 核心组件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/types.ts`**：类型定义（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/workspace.ts`**：目录扫描和加载（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/frontmatter.ts`**：HOOK.md 元数据解析（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/config.ts`**：资格检查（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/hooks-status.ts`**：状态报告（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/hooks/loader.ts`**：动态模块加载器（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/cli/hooks-cli.ts`**：CLI 命令（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/gateway/server-startup.ts`**：在 Gateway 网关启动时加载 hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- **`src/auto-reply/reply/commands-core.ts`**：触发命令事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 发现流程（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
Gateway 网关启动（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
扫描目录（工作区 → 托管 → 捆绑）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
解析 HOOK.md 文件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
检查资格（bins、env、config、os）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
从符合条件的 hooks 加载处理程序（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
为事件注册处理程序（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 事件流程（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
用户发送 /new（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
命令验证（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
创建 hook 事件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
触发 hook（所有注册的处理程序）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
命令处理继续（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ↓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
会话重置（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 故障排除（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Hook 未被发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 检查目录结构：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ls -la ~/.openclaw/hooks/my-hook/（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   # Should show: HOOK.md, handler.ts（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 验证 HOOK.md 格式：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   cat ~/.openclaw/hooks/my-hook/HOOK.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   # Should have YAML frontmatter with name and metadata（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 列出所有发现的 hooks：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Hook 不符合条件（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
检查要求：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
openclaw hooks info my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
查找缺失的：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 二进制文件（检查 PATH）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 环境变量（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 配置值（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 操作系统兼容性（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### Hook 未执行（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 验证 hook 已启用：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   # Should show ✓ next to enabled hooks（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 重启你的 Gateway 网关进程以重新加载 hooks。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 检查 Gateway 网关日志中的错误：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ./scripts/clawlog.sh | grep hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 处理程序错误（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
检查 TypeScript/import 错误：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# Test import directly（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
node -e "import('./path/to/handler.ts').then(console.log)"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 迁移指南（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
### 从遗留配置到发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**之前**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      "handlers": [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "event": "command:new",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          "module": "./hooks/handlers/my-handler.ts"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      ]（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**之后**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
1. 创建 hook 目录：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   mkdir -p ~/.openclaw/hooks/my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   mv ./hooks/handlers/my-handler.ts ~/.openclaw/hooks/my-hook/handler.ts（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
2. 创建 HOOK.md：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```markdown（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   name: my-hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   description: "My custom hook"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   metadata: { "openclaw": { "emoji": "🎯", "events": ["command:new"] } }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   # My Hook（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   Does something useful.（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
3. 更新配置：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```json（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
     "hooks": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
       "internal": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
         "enabled": true,（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
         "entries": {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
           "my-hook": { "enabled": true }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
         }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
       }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
     }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   }（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
4. 验证并重启你的 Gateway 网关进程：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```bash（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   openclaw hooks list（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   # Should show: 🎯 my-hook ✓（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
   ```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
**迁移的好处**：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 自动发现（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- CLI 管理（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 资格检查（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 更好的文档（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 一致的结构（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 另请参阅（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- [CLI 参考：hooks](/cli/hooks)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- [捆绑 Hooks README](https://github.com/openclaw/openclaw/tree/main/src/hooks/bundled)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- [Webhook Hooks](/automation/webhook)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- [配置](/gateway/configuration#hooks)（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
