---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
read_when:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你想在插件中添加新的智能体工具（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  - 你需要通过允许列表使工具可选启用（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
summary: 在插件中编写智能体工具（模式、可选工具、允许列表）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
title: 插件智能体工具（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
x-i18n:（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  generated_at: "2026-02-03T07:53:22Z"（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  model: claude-opus-4-5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  provider: pi（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_hash: 4479462e9d8b17b664bf6b5f424f2efc8e7bedeaabfdb6a93126e051e635c659（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  source_path: plugins/agent-tools.md（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  workflow: 15（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
---（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
# 插件智能体工具（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
OpenClaw 插件可以注册**智能体工具**（JSON 模式函数），这些工具在智能体运行期间暴露给 LLM。工具可以是**必需的**（始终可用）或**可选的**（选择启用）。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
智能体工具在主配置的 `tools` 下配置，或在每个智能体的 `agents.list[].tools` 下配置。允许列表/拒绝列表策略控制智能体可以调用哪些工具。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 基本工具（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```ts（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
import { Type } from "@sinclair/typebox";（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export default function (api) {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  api.registerTool({（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    name: "my_tool",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    description: "Do a thing",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    parameters: Type.Object({（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      input: Type.String(),（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    }),（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    async execute(_id, params) {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      return { content: [{ type: "text", text: params.input }] };（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  });（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 可选工具（选择启用）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
可选工具**永远不会**自动启用。用户必须将它们添加到智能体允许列表中。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```ts（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
export default function (api) {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  api.registerTool(（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      name: "workflow_tool",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      description: "Run a local workflow",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      parameters: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        type: "object",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        properties: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          pipeline: { type: "string" },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        required: ["pipeline"],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      async execute(_id, params) {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        return { content: [{ type: "text", text: params.pipeline }] };（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    { optional: true },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  );（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
在 `agents.list[].tools.allow`（或全局 `tools.allow`）中启用可选工具：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```json5（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
{（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  agents: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    list: [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        id: "main",（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        tools: {（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          allow: [（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            "workflow_tool", // 特定工具名称（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            "workflow", // 插件 id（启用该插件的所有工具）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
            "group:plugins", // 所有插件工具（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
          ],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
        },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
      },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
    ],（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
  },（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
}（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
```（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
其他影响工具可用性的配置选项：（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 仅包含插件工具名称的允许列表被视为插件选择启用；核心工具保持启用，除非你在允许列表中也包含核心工具或组。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `tools.profile` / `agents.list[].tools.profile`（基础允许列表）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `tools.byProvider` / `agents.list[].tools.byProvider`（特定提供商的允许/拒绝）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- `tools.sandbox.tools.*`（沙箱隔离时的沙箱工具策略）（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
## 规则 + 提示（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 工具名称**不能**与核心工具名称冲突；冲突的工具会被跳过。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 允许列表中使用的插件 id 不能与核心工具名称冲突。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
- 对于触发副作用或需要额外二进制文件/凭证的工具，优先使用 `optional: true`。（轉為繁體中文）（轉為繁體中文）（轉為繁體中文）
