---
summary: "چیٹس کے لیے سیشن مینجمنٹ کے قواعد، کلیدیں، اور پائیداری"
read_when:
  - سیشن ہینڈلنگ یا اسٹوریج میں ترمیم کرتے وقت
title: "سیشن مینجمنٹ"
x-i18n:
  source_path: concepts/session.md
  source_hash: e2040cea1e0738a8
  provider: openai
  model: gpt-5.2-chat-latest
  workflow: v1
  generated_at: 2026-02-08T10:47:40Z
---

# سیشن مینجمنٹ

OpenClaw **ہر ایجنٹ کے لیے ایک براہِ راست چیٹ سیشن** کو بنیادی سمجھتا ہے۔ براہِ راست چیٹس `agent:<agentId>:<mainKey>` (بطورِ طے شدہ `main`) میں ضم ہو جاتی ہیں، جبکہ گروپ/چینل چیٹس کو اپنی الگ کلیدیں ملتی ہیں۔ `session.mainKey` کی تعمیل کی جاتی ہے۔

**براہِ راست پیغامات** کو کیسے گروپ کیا جائے، اس کو کنٹرول کرنے کے لیے `session.dmScope` استعمال کریں:

- `main` (بطورِ طے شدہ): تسلسل کے لیے تمام DMs مرکزی سیشن شیئر کرتے ہیں۔
- `per-peer`: چینلز کے پار بھیجنے والے کی شناخت کے مطابق علیحدگی۔
- `per-channel-peer`: چینل + بھیجنے والے کے مطابق علیحدگی (کثیر صارف اِن باکسز کے لیے سفارش کردہ)۔
- `per-account-channel-peer`: اکاؤنٹ + چینل + بھیجنے والے کے مطابق علیحدگی (کثیر اکاؤنٹ اِن باکسز کے لیے سفارش کردہ)۔
  `session.identityLinks` استعمال کریں تاکہ فراہم کنندہ سے پہلے لگے peer ids کو ایک معیاری شناخت سے میپ کیا جا سکے، تاکہ ایک ہی شخص مختلف چینلز پر `per-peer`، `per-channel-peer`، یا `per-account-channel-peer` استعمال کرتے ہوئے ایک ہی DM سیشن شیئر کرے۔

## محفوظ DM موڈ (کثیر صارف سیٹ اپس کے لیے سفارش کردہ)

> **سکیورٹی انتباہ:** اگر آپ کا ایجنٹ **متعدد افراد** سے DMs وصول کر سکتا ہے، تو آپ کو محفوظ DM موڈ فعال کرنے پر سنجیدگی سے غور کرنا چاہیے۔ اس کے بغیر، تمام صارفین ایک ہی گفتگو کا سیاق شیئر کرتے ہیں، جس سے صارفین کے درمیان نجی معلومات افشا ہو سکتی ہیں۔

**بطورِ طے شدہ سیٹنگز کے ساتھ مسئلے کی مثال:**

- ایلس (`<SENDER_A>`) آپ کے ایجنٹ کو کسی نجی موضوع پر پیغام بھیجتی ہے (مثلاً طبی ملاقات)
- باب (`<SENDER_B>`) آپ کے ایجنٹ کو پیغام بھیجتا ہے: "ہم کس بارے میں بات کر رہے تھے؟"
- چونکہ دونوں DMs ایک ہی سیشن شیئر کرتے ہیں، ماڈل باب کو ایلس کے سابقہ سیاق کے ساتھ جواب دے سکتا ہے۔

**حل:** سیشنز کو ہر صارف کے لیے علیحدہ کرنے کے لیے `dmScope` سیٹ کریں:

```json5
// ~/.openclaw/openclaw.json
{
  session: {
    // Secure DM mode: isolate DM context per channel + sender.
    dmScope: "per-channel-peer",
  },
}
```

**اسے کب فعال کریں:**

- آپ کے پاس ایک سے زیادہ بھیجنے والوں کے لیے pairing approvals ہوں
- آپ متعدد اندراجات کے ساتھ DM allowlist استعمال کرتے ہوں
- آپ `dmPolicy: "open"` سیٹ کرتے ہوں
- متعدد فون نمبرز یا اکاؤنٹس آپ کے ایجنٹ کو پیغام بھیج سکتے ہوں

نوٹس:

- بطورِ طے شدہ `dmScope: "main"` تسلسل کے لیے ہے (تمام DMs مرکزی سیشن شیئر کرتے ہیں)۔ یہ واحد صارف سیٹ اپس کے لیے موزوں ہے۔
- ایک ہی چینل پر کثیر اکاؤنٹ اِن باکسز کے لیے `per-account-channel-peer` کو ترجیح دیں۔
- اگر ایک ہی شخص متعدد چینلز پر آپ سے رابطہ کرتا ہے، تو `session.identityLinks` استعمال کریں تاکہ ان کے DM سیشنز ایک معیاری شناخت میں ضم ہو جائیں۔
- آپ اپنی DM سیٹنگز کی تصدیق `openclaw security audit` کے ساتھ کر سکتے ہیں (دیکھیں [security](/cli/security))۔

## Gateway ہی واحد مستند ذریعہ ہے

تمام سیشن اسٹیٹ **gateway کی ملکیت** ہے (”ماسٹر“ OpenClaw)۔ UI کلائنٹس (macOS ایپ، WebChat، وغیرہ) کو مقامی فائلیں پڑھنے کے بجائے سیشن فہرستوں اور ٹوکن کاؤنٹس کے لیے gateway سے استفسار کرنا چاہیے۔

- **ریموٹ موڈ** میں، جس سیشن اسٹور کی آپ کو پرواہ ہے وہ آپ کے Mac پر نہیں بلکہ ریموٹ گیٹ وے ہوسٹ پر موجود ہوتا ہے۔
- UIs میں دکھائے گئے ٹوکن کاؤنٹس gateway کے اسٹور فیلڈز (`inputTokens`، `outputTokens`، `totalTokens`، `contextTokens`) سے آتے ہیں۔ کلائنٹس مجموعات کو “درست” کرنے کے لیے JSONL ٹرانسکرپٹس پارس نہیں کرتے۔

## اسٹیٹ کہاں رہتی ہے

- **گیٹ وے ہوسٹ** پر:
  - اسٹور فائل: `~/.openclaw/agents/<agentId>/sessions/sessions.json` (ہر ایجنٹ کے لیے)۔
- ٹرانسکرپٹس: `~/.openclaw/agents/<agentId>/sessions/<SessionId>.jsonl` (Telegram ٹاپک سیشنز `.../<SessionId>-topic-<threadId>.jsonl` استعمال کرتے ہیں)۔
- اسٹور ایک میپ ہے `sessionKey -> { sessionId, updatedAt, ... }`۔ اندراجات حذف کرنا محفوظ ہے؛ ضرورت پڑنے پر وہ دوبارہ بن جاتے ہیں۔
- گروپ اندراجات میں UIs میں سیشنز کو لیبل کرنے کے لیے `displayName`، `channel`، `subject`، `room`، اور `space` شامل ہو سکتے ہیں۔
- سیشن اندراجات میں `origin` میٹاڈیٹا (لیبل + روٹنگ اشارے) شامل ہوتے ہیں تاکہ UIs وضاحت کر سکیں کہ سیشن کہاں سے آیا۔
- OpenClaw لیگیسی Pi/Tau سیشن فولڈرز نہیں پڑھتا۔

## سیشن کی کٹائی (Pruning)

OpenClaw بطورِ طے شدہ LLM کالز سے عین پہلے اِن-میموری سیاق سے **پرانے ٹول نتائج** تراش دیتا ہے۔
یہ JSONL ہسٹری کو دوبارہ نہیں لکھتا۔ دیکھیں [/concepts/session-pruning](/concepts/session-pruning)۔

## پری-کمپیکشن میموری فلش

جب کوئی سیشن خودکار کمپیکشن کے قریب ہوتا ہے، OpenClaw ایک **خاموش میموری فلش** ٹرن چلا سکتا ہے
جو ماڈل کو پائیدار نوٹس ڈسک پر لکھنے کی یاد دہانی کراتا ہے۔ یہ صرف اس وقت چلتا ہے جب
ورک اسپیس قابلِ تحریر ہو۔ دیکھیں [Memory](/concepts/memory) اور
[Compaction](/concepts/compaction)۔

## ٹرانسپورٹس → سیشن کلیدوں کی میپنگ

- براہِ راست چیٹس `session.dmScope` کی پیروی کرتی ہیں (بطورِ طے شدہ `main`)۔
  - `main`: `agent:<agentId>:<mainKey>` (آلات/چینلز کے پار تسلسل)۔
    - متعدد فون نمبرز اور چینلز ایک ہی ایجنٹ مین کلید سے میپ ہو سکتے ہیں؛ وہ ایک ہی گفتگو میں داخلے کے ٹرانسپورٹس کے طور پر کام کرتے ہیں۔
  - `per-peer`: `agent:<agentId>:dm:<peerId>`۔
  - `per-channel-peer`: `agent:<agentId>:<channel>:dm:<peerId>`۔
  - `per-account-channel-peer`: `agent:<agentId>:<channel>:<accountId>:dm:<peerId>` (accountId بطورِ طے شدہ `default` ہے)۔
  - اگر `session.identityLinks` کسی فراہم کنندہ سے پہلے لگے peer id (مثلاً `telegram:123`) سے میچ کرے، تو معیاری کلید `<peerId>` کی جگہ لے لیتی ہے تاکہ ایک ہی شخص مختلف چینلز پر ایک سیشن شیئر کرے۔
- گروپ چیٹس اسٹیٹ کو علیحدہ رکھتی ہیں: `agent:<agentId>:<channel>:group:<id>` (کمروں/چینلز کے لیے `agent:<agentId>:<channel>:channel:<id>` استعمال ہوتا ہے)۔
  - Telegram فورم ٹاپکس علیحدگی کے لیے گروپ id کے ساتھ `:topic:<threadId>` جوڑتے ہیں۔
  - لیگیسی `group:<id>` کلیدیں منتقلی (migration) کے لیے اب بھی تسلیم کی جاتی ہیں۔
- اِن باؤنڈ سیاق اب بھی `group:<id>` استعمال کر سکتے ہیں؛ چینل `Provider` سے مستنبط کیا جاتا ہے اور معیاری `agent:<agentId>:<channel>:group:<id>` فارم میں نارملائز کیا جاتا ہے۔
- دیگر ذرائع:
  - کرون جابز: `cron:<job.id>`
  - ویب ہکس: `hook:<uuid>` (جب تک ہک واضح طور پر سیٹ نہ کرے)
  - نوڈ رنز: `node-<nodeId>`

## لائف سائیکل

- ری سیٹ پالیسی: سیشنز ختم ہونے تک دوبارہ استعمال ہوتے ہیں، اور میعاد کا جائزہ اگلے اِن باؤنڈ پیغام پر لیا جاتا ہے۔
- یومیہ ری سیٹ: بطورِ طے شدہ **گیٹ وے ہوسٹ کے مقامی وقت کے مطابق صبح 4:00 بجے**۔ اگر آخری اپ ڈیٹ حالیہ یومیہ ری سیٹ وقت سے پہلے کی ہو تو سیشن باسی سمجھا جاتا ہے۔
- اِن ایکٹیو ری سیٹ (اختیاری): `idleMinutes` ایک سلائیڈنگ اِن ایکٹیو ونڈو شامل کرتا ہے۔ جب یومیہ اور اِن ایکٹیو دونوں ری سیٹس کنفیگر ہوں، تو **جو پہلے ختم ہو** وہ نیا سیشن مجبور کرتا ہے۔
- لیگیسی صرف اِن ایکٹیو: اگر آپ `session.idleMinutes` کو بغیر کسی `session.reset`/`resetByType` کنفیگ کے سیٹ کریں، تو بیک ورڈ کمپیٹیبلٹی کے لیے OpenClaw صرف اِن ایکٹیو موڈ میں رہتا ہے۔
- فی-ٹائپ اوور رائیڈز (اختیاری): `resetByType` آپ کو `dm`، `group`، اور `thread` سیشنز کے لیے پالیسی اوور رائیڈ کرنے دیتا ہے (thread = Slack/Discord تھریڈز، Telegram ٹاپکس، Matrix تھریڈز جب کنیکٹر فراہم کرے)۔
- فی-چینل اوور رائیڈز (اختیاری): `resetByChannel` کسی چینل کے لیے ری سیٹ پالیسی اوور رائیڈ کرتا ہے (اس چینل کے تمام سیشن اقسام پر لاگو ہوتا ہے اور `reset`/`resetByType` پر فوقیت رکھتا ہے)۔
- ری سیٹ ٹرگرز: عین `/new` یا `/reset` (اور `resetTriggers` میں کسی بھی اضافی کے ساتھ) نیا سیشن id شروع کرتے ہیں اور پیغام کے باقی حصے کو آگے بھیجتے ہیں۔ `/new <model>` ماڈل عرف، `provider/model`، یا فراہم کنندہ کا نام (فزی میچ) قبول کرتا ہے تاکہ نئے سیشن کا ماڈل سیٹ کیا جا سکے۔ اگر `/new` یا `/reset` اکیلا بھیجا جائے، تو OpenClaw ری سیٹ کی تصدیق کے لیے ایک مختصر “ہیلو” گریٹنگ ٹرن چلاتا ہے۔
- دستی ری سیٹ: اسٹور سے مخصوص کلیدیں حذف کریں یا JSONL ٹرانسکرپٹ ہٹا دیں؛ اگلا پیغام انہیں دوبارہ بنا دیتا ہے۔
- علیحدہ کرون جابز ہر رن پر ہمیشہ ایک نیا `sessionId` بناتی ہیں (کوئی اِن ایکٹیو ری یوز نہیں)۔

## بھیجنے کی پالیسی (اختیاری)

انفرادی ids کی فہرست دیے بغیر مخصوص سیشن اقسام کے لیے ترسیل بلاک کریں۔

```json5
{
  session: {
    sendPolicy: {
      rules: [
        { action: "deny", match: { channel: "discord", chatType: "group" } },
        { action: "deny", match: { keyPrefix: "cron:" } },
      ],
      default: "allow",
    },
  },
}
```

رن ٹائم اوور رائیڈ (صرف مالک):

- `/send on` → اس سیشن کے لیے اجازت دیں
- `/send off` → اس سیشن کے لیے انکار کریں
- `/send inherit` → اوور رائیڈ صاف کریں اور کنفیگ قواعد استعمال کریں
  انہیں اسٹینڈ الون پیغامات کے طور پر بھیجیں تاکہ وہ رجسٹر ہوں۔

## کنفیگریشن (اختیاری نام تبدیل کرنے کی مثال)

```json5
// ~/.openclaw/openclaw.json
{
  session: {
    scope: "per-sender", // keep group keys separate
    dmScope: "main", // DM continuity (set per-channel-peer/per-account-channel-peer for shared inboxes)
    identityLinks: {
      alice: ["telegram:123456789", "discord:987654321012345678"],
    },
    reset: {
      // Defaults: mode=daily, atHour=4 (gateway host local time).
      // If you also set idleMinutes, whichever expires first wins.
      mode: "daily",
      atHour: 4,
      idleMinutes: 120,
    },
    resetByType: {
      thread: { mode: "daily", atHour: 4 },
      dm: { mode: "idle", idleMinutes: 240 },
      group: { mode: "idle", idleMinutes: 120 },
    },
    resetByChannel: {
      discord: { mode: "idle", idleMinutes: 10080 },
    },
    resetTriggers: ["/new", "/reset"],
    store: "~/.openclaw/agents/{agentId}/sessions/sessions.json",
    mainKey: "main",
  },
}
```

## معائنہ

- `openclaw status` — اسٹور پاتھ اور حالیہ سیشنز دکھاتا ہے۔
- `openclaw sessions --json` — ہر اندراج ڈمپ کرتا ہے ( `--active <minutes>` سے فلٹر کریں)۔
- `openclaw gateway call sessions.list --params '{}'` — چلتے ہوئے gateway سے سیشنز حاصل کرتا ہے (ریموٹ گیٹ وے رسائی کے لیے `--url`/`--token` استعمال کریں)۔
- چیٹ میں `/status` کو بطورِ اسٹینڈ الون پیغام بھیجیں تاکہ معلوم ہو کہ ایجنٹ قابلِ رسائی ہے یا نہیں، سیشن سیاق کتنا استعمال ہوا ہے، موجودہ thinking/verbose ٹوگلز، اور آپ کے WhatsApp ویب کریڈز آخری بار کب ریفریش ہوئے (ری لنک کی ضرورت شناخت کرنے میں مدد دیتا ہے)۔
- `/context list` یا `/context detail` بھیجیں تاکہ سسٹم پرامپٹ اور انجیکٹڈ ورک اسپیس فائلز (اور سب سے بڑے سیاقی شراکت دار) دیکھ سکیں۔
- `/stop` کو بطورِ اسٹینڈ الون پیغام بھیجیں تاکہ موجودہ رن کو منسوخ کیا جا سکے، اس سیشن کے لیے قطار میں موجود فالو اپس صاف کیے جا سکیں، اور اس سے پیدا ہونے والی کسی بھی ذیلی ایجنٹ رنز کو روکا جا سکے (جواب میں رُکے ہوئے کاؤنٹ شامل ہوتا ہے)۔
- `/compact` (اختیاری ہدایات) کو بطورِ اسٹینڈ الون پیغام بھیجیں تاکہ پرانا سیاق خلاصہ ہو اور ونڈو اسپیس خالی ہو۔ دیکھیں [/concepts/compaction](/concepts/compaction)۔
- JSONL ٹرانسکرپٹس کو مکمل ٹرنز کے جائزے کے لیے براہِ راست کھولا جا سکتا ہے۔

## مشورے

- بنیادی کلید کو 1:1 ٹریفک کے لیے مخصوص رکھیں؛ گروپس کو اپنی الگ کلیدیں رکھنے دیں۔
- صفائی خودکار بناتے وقت، پورے اسٹور کے بجائے انفرادی کلیدیں حذف کریں تاکہ کہیں اور سیاق محفوظ رہے۔

## سیشن کی اصل کا میٹاڈیٹا

ہر سیشن اندراج بہترین کوشش کی بنیاد پر `origin` میں اس کی اصل ریکارڈ کرتا ہے:

- `label`: انسانی لیبل (گفتگو لیبل + گروپ سبجیکٹ/چینل سے حل شدہ)
- `provider`: نارملائزڈ چینل id (ایکسٹینشنز سمیت)
- `from`/`to`: اِن باؤنڈ لفافے سے خام روٹنگ ids
- `accountId`: فراہم کنندہ اکاؤنٹ id (جب کثیر اکاؤنٹ ہو)
- `threadId`: تھریڈ/ٹاپک id جب چینل اس کی حمایت کرتا ہو
  اصل فیلڈز براہِ راست پیغامات، چینلز، اور گروپس کے لیے پُر کی جاتی ہیں۔ اگر کوئی
  کنیکٹر صرف ترسیلی روٹنگ اپ ڈیٹ کرتا ہے (مثلاً DM مین سیشن کو تازہ رکھنے کے لیے)،
  تو اسے پھر بھی اِن باؤنڈ سیاق فراہم کرنا چاہیے تاکہ سیشن اپنی
  وضاحتی میٹاڈیٹا برقرار رکھے۔ ایکسٹینشنز یہ کام `ConversationLabel`،
  `GroupSubject`، `GroupChannel`، `GroupSpace`، اور `SenderName` اِن باؤنڈ
  سیاق میں بھیج کر اور `recordSessionMetaFromInbound` کال کر کے کر سکتی ہیں (یا وہی سیاق
  `updateLastRoute` کو پاس کر کے)۔
