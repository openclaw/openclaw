---
summary: "ایگزیک منظوریات، اجازت فہرستیں، اور sandbox سے باہر نکلنے کے پرامپٹس"
read_when:
  - ایگزیک منظوریات یا اجازت فہرستیں کنفیگر کرتے وقت
  - macOS ایپ میں ایگزیک منظوری UX نافذ کرتے وقت
  - sandbox سے باہر نکلنے کے پرامپٹس اور ان کے مضمرات کا جائزہ لیتے وقت
title: "ایگزیک منظوریات"
x-i18n:
  source_path: tools/exec-approvals.md
  source_hash: 66630b5d79671dd4
  provider: openai
  model: gpt-5.2-chat-latest
  workflow: v1
  generated_at: 2026-02-08T10:48:00Z
---

# ایگزیک منظوریات

ایگزیک منظوریات وہ **companion app / node host guardrail** ہیں جو sandbox میں موجود ایجنٹ کو
حقیقی ہوسٹ پر کمانڈز چلانے کی اجازت دینے کے لیے استعمال ہوتی ہیں
(`gateway` یا `node`)۔ اسے حفاظتی انٹرلاک سمجھیں:
کمانڈز تبھی اجازت پاتی ہیں جب پالیسی + اجازت فہرست + (اختیاری) صارف کی منظوری سب متفق ہوں۔
ایگزیک منظوریات، ٹول پالیسی اور elevated gating کے **اضافی** طور پر لاگو ہوتی ہیں
(جب تک elevated کو `full` پر سیٹ نہ کیا گیا ہو، جس میں منظوریات کو چھوڑ دیا جاتا ہے)۔
موثر پالیسی، `tools.exec.*` اور منظوریات کے ڈیفالٹس میں سے **زیادہ سخت** ہوتی ہے؛
اگر منظوریات کا کوئی فیلڈ شامل نہ ہو تو `tools.exec` کی قدر استعمال ہوتی ہے۔

اگر companion app کا UI **دستیاب نہ ہو** تو جس درخواست کو پرامپٹ درکار ہو،
وہ **ask fallback** کے ذریعے حل کی جاتی ہے (ڈیفالٹ: انکار)۔

## اطلاق کی جگہ

ایگزیک منظوریات، ایگزیکیوشن ہوسٹ پر مقامی طور پر نافذ ہوتی ہیں:

- **gateway host** → گیٹ وے مشین پر `openclaw` پروسیس
- **node host** → نوڈ رنر (macOS companion app یا ہیڈلیس نوڈ ہوسٹ)

macOS تقسیم:

- **node host service**، `system.run` کو لوکل IPC کے ذریعے **macOS ایپ** تک فارورڈ کرتی ہے۔
- **macOS ایپ** منظوریات نافذ کرتی ہے + UI سیاق میں کمانڈ اجرا کرتی ہے۔

## سیٹنگز اور اسٹوریج

منظوریات، ایگزیکیوشن ہوسٹ پر ایک مقامی JSON فائل میں محفوظ ہوتی ہیں:

`~/.openclaw/exec-approvals.json`

مثالی اسکیما:

```json
{
  "version": 1,
  "socket": {
    "path": "~/.openclaw/exec-approvals.sock",
    "token": "base64url-token"
  },
  "defaults": {
    "security": "deny",
    "ask": "on-miss",
    "askFallback": "deny",
    "autoAllowSkills": false
  },
  "agents": {
    "main": {
      "security": "allowlist",
      "ask": "on-miss",
      "askFallback": "deny",
      "autoAllowSkills": true,
      "allowlist": [
        {
          "id": "B0C8C0B3-2C2D-4F8A-9A3C-5A4B3C2D1E0F",
          "pattern": "~/Projects/**/bin/rg",
          "lastUsedAt": 1737150000000,
          "lastUsedCommand": "rg -n TODO",
          "lastResolvedPath": "/Users/user/Projects/.../bin/rg"
        }
      ]
    }
  }
}
```

## پالیسی کے کنٹرولز

### سکیورٹی (`exec.security`)

- **deny**: تمام ہوسٹ ایگزیک درخواستیں بلاک کریں۔
- **allowlist**: صرف اجازت فہرست میں موجود کمانڈز کی اجازت دیں۔
- **full**: ہر چیز کی اجازت دیں (elevated کے مساوی)۔

### Ask (`exec.ask`)

- **off**: کبھی پرامپٹ نہ کریں۔
- **on-miss**: صرف تب پرامپٹ کریں جب اجازت فہرست میچ نہ کرے۔
- **always**: ہر کمانڈ پر پرامپٹ کریں۔

### Ask fallback (`askFallback`)

اگر پرامپٹ درکار ہو مگر کوئی UI قابلِ رسائی نہ ہو تو fallback فیصلہ کرتا ہے:

- **deny**: بلاک کریں۔
- **allowlist**: صرف تب اجازت دیں جب اجازت فہرست میچ کرے۔
- **full**: اجازت دیں۔

## اجازت فہرست (ہر ایجنٹ کے لیے)

اجازت فہرستیں **ہر ایجنٹ کے لیے** ہوتی ہیں۔ اگر متعدد ایجنٹس موجود ہوں تو macOS ایپ میں
جس ایجنٹ میں ترمیم کرنی ہو اسے منتخب کریں۔ پیٹرنز **کیس اِن سینسِٹو گلوب میچز** ہوتے ہیں۔
پیٹرنز کو **بائنری راستوں** تک حل ہونا چاہیے (صرف basename والی اندراجات نظرانداز کی جاتی ہیں)۔
لیگیسی `agents.default` اندراجات، لوڈ کے وقت `agents.main` میں منتقل کر دی جاتی ہیں۔

مثالیں:

- `~/Projects/**/bin/peekaboo`
- `~/.local/bin/*`
- `/opt/homebrew/bin/rg`

ہر اجازت فہرست اندراج درج ذیل کو ٹریک کرتا ہے:

- **id** UI شناخت کے لیے مستحکم UUID (اختیاری)
- **last used** ٹائم اسٹیمپ
- **last used command**
- **last resolved path**

## Auto-allow skill CLIs

جب **Auto-allow skill CLIs** فعال ہو تو معروف Skills کے حوالے سے آنے والے ایگزیکیوٹیبلز
نوڈز پر اجازت فہرست میں شمار ہوتے ہیں (macOS نوڈ یا ہیڈلیس نوڈ ہوسٹ)۔
یہ Gateway RPC کے ذریعے اسکل بِن فہرست حاصل کرنے کے لیے `skills.bins` استعمال کرتا ہے۔
اگر آپ سخت دستی اجازت فہرستیں چاہتے ہیں تو اسے غیر فعال کریں۔

## Safe bins (stdin-only)

`tools.exec.safeBins` **stdin-only** بائنریز کی ایک چھوٹی فہرست متعین کرتا ہے
(مثلاً `jq`) جو اجازت فہرست موڈ میں **بغیر** واضح اجازت فہرست اندراجات کے چل سکتی ہیں۔
Safe bins پوزیشنل فائل آرگز اور راستہ نما ٹوکنز کو مسترد کرتے ہیں، اس لیے وہ صرف
آنے والی اسٹریم پر کام کر سکتے ہیں۔ اجازت فہرست موڈ میں شیل چیننگ اور ری ڈائریکشنز
خودکار طور پر اجازت یافتہ نہیں ہوتیں۔

شیل چیننگ (`&&`, `||`, `;`) تب اجازت یافتہ ہوتی ہے
جب ہر ٹاپ لیول سیگمنٹ اجازت فہرست پر پورا اترے
(بشمول safe bins یا اسکل آٹو-الاؤ)۔ ری ڈائریکشنز اجازت فہرست موڈ میں بدستور غیر معاون ہیں۔
کمانڈ سبسٹی ٹیوشن (`$()` / بیک ٹِکس) اجازت فہرست پارسنگ کے دوران مسترد کر دی جاتی ہے،
حتیٰ کہ ڈبل کوٹس کے اندر بھی؛ اگر آپ کو لفظی `$()` متن درکار ہو تو سنگل کوٹس استعمال کریں۔

ڈیفالٹ safe bins: `jq`, `grep`, `cut`, `sort`, `uniq`, `head`, `tail`, `tr`, `wc`۔

## کنٹرول UI میں ترمیم

ڈیفالٹس، ہر ایجنٹ اوور رائیڈز، اور اجازت فہرستیں ترمیم کرنے کے لیے
**Control UI → Nodes → Exec approvals** کارڈ استعمال کریں۔
ایک اسکوپ منتخب کریں (Defaults یا کوئی ایجنٹ)، پالیسی میں ترمیم کریں،
اجازت فہرست پیٹرنز شامل/ہٹائیں، پھر **Save** کریں۔
UI ہر پیٹرن کے لیے **last used** میٹاڈیٹا دکھاتا ہے تاکہ فہرست منظم رکھی جا سکے۔

ٹارگٹ سیلیکٹر **Gateway** (لوکل منظوریات) یا کسی **Node** کو منتخب کرتا ہے۔
نوڈز کو `system.execApprovals.get/set` ایڈورٹائز کرنا لازم ہے (macOS ایپ یا ہیڈلیس نوڈ ہوسٹ)۔
اگر کوئی نوڈ ابھی ایگزیک منظوریات ایڈورٹائز نہیں کرتا تو اس کی مقامی
`~/.openclaw/exec-approvals.json` فائل براہِ راست ترمیم کریں۔

CLI: `openclaw approvals` گیٹ وے یا نوڈ ایڈیٹنگ کو سپورٹ کرتا ہے
(دیکھیں [Approvals CLI](/cli/approvals))۔

## منظوری کا بہاؤ

جب پرامپٹ درکار ہو تو گیٹ وے آپریٹر کلائنٹس کو `exec.approval.requested` براڈکاسٹ کرتا ہے۔
Control UI اور macOS ایپ اسے `exec.approval.resolve` کے ذریعے حل کرتی ہیں، پھر گیٹ وے
منظور شدہ درخواست نوڈ ہوسٹ کو فارورڈ کرتا ہے۔

جب منظوریات درکار ہوں تو exec ٹول فوراً ایک approval id کے ساتھ واپس آتا ہے۔
بعد کے سسٹم ایونٹس (`Exec finished` / `Exec denied`) کے ساتھ ربط قائم کرنے کے لیے
اسی id کو استعمال کریں۔ اگر ٹائم آؤٹ سے پہلے کوئی فیصلہ نہ آئے تو
درخواست کو منظوری ٹائم آؤٹ سمجھا جاتا ہے اور انکار کی وجہ کے طور پر ظاہر کیا جاتا ہے۔

تصدیقی ڈائیلاگ میں شامل ہوتا ہے:

- کمانڈ + آرگز
- cwd
- ایجنٹ id
- حل شدہ ایگزیکیوٹیبل راستہ
- ہوسٹ + پالیسی میٹاڈیٹا

اعمال:

- **Allow once** → ابھی چلائیں
- **Always allow** → اجازت فہرست میں شامل کریں + چلائیں
- **Deny** → بلاک کریں

## چیٹ چینلز تک منظوری فارورڈ کرنا

آپ ایگزیک منظوری کے پرامپٹس کسی بھی چیٹ چینل (بشمول پلگ اِن چینلز) کو فارورڈ کر سکتے ہیں
اور انہیں `/approve` کے ساتھ منظور کر سکتے ہیں۔
یہ معمول کے آؤٹ باؤنڈ ڈیلیوری پائپ لائن کا استعمال کرتا ہے۔

کنفیگ:

```json5
{
  approvals: {
    exec: {
      enabled: true,
      mode: "session", // "session" | "targets" | "both"
      agentFilter: ["main"],
      sessionFilter: ["discord"], // substring or regex
      targets: [
        { channel: "slack", to: "U12345678" },
        { channel: "telegram", to: "123456789" },
      ],
    },
  },
}
```

چیٹ میں جواب:

```
/approve <id> allow-once
/approve <id> allow-always
/approve <id> deny
```

### macOS IPC بہاؤ

```
Gateway -> Node Service (WS)
                 |  IPC (UDS + token + HMAC + TTL)
                 v
             Mac App (UI + approvals + system.run)
```

سکیورٹی نوٹس:

- یونکس ساکٹ موڈ `0600`، ٹوکن `exec-approvals.json` میں محفوظ۔
- Same-UID پیئر چیک۔
- Challenge/response (nonce + HMAC ٹوکن + درخواست ہیش) + مختصر TTL۔

## سسٹم ایونٹس

ایگزیک لائف سائیکل کو سسٹم پیغامات کے طور پر ظاہر کیا جاتا ہے:

- `Exec running` (صرف تب جب کمانڈ رننگ نوٹس تھریش ہولڈ سے تجاوز کرے)
- `Exec finished`
- `Exec denied`

یہ نوڈ کی جانب سے ایونٹ رپورٹ ہونے کے بعد ایجنٹ کے سیشن میں پوسٹ کیے جاتے ہیں۔
Gateway-host ایگزیک منظوریات بھی کمانڈ کے ختم ہونے پر وہی لائف سائیکل ایونٹس خارج کرتی ہیں
(اور اختیاری طور پر جب کمانڈ تھریش ہولڈ سے زیادہ دیر تک چل رہی ہو)۔
منظوری-گیٹڈ ایگزیکس میں انہی پیغامات کے لیے منظوری id کو `runId` کے طور پر دوبارہ استعمال کیا جاتا ہے
تاکہ آسانی سے ربط قائم ہو سکے۔

## مضمرات

- **full** طاقتور ہے؛ جہاں ممکن ہو اجازت فہرستوں کو ترجیح دیں۔
- **ask** آپ کو باخبر رکھتا ہے اور تیز منظوریات کی اجازت دیتا ہے۔
- ہر ایجنٹ کی اجازت فہرستیں ایک ایجنٹ کی منظوریوں کو دوسرے میں لیک ہونے سے روکتی ہیں۔
- منظوریات صرف **authorized senders** کی جانب سے آنے والی ہوسٹ ایگزیک درخواستوں پر لاگو ہوتی ہیں۔
  غیر مجاز بھیجنے والے `/exec` جاری نہیں کر سکتے۔
- `/exec security=full` مجاز آپریٹرز کے لیے سیشن لیول سہولت ہے اور دانستہ طور پر منظوریات کو چھوڑ دیتا ہے۔
  ہوسٹ ایگزیک کو سختی سے بلاک کرنے کے لیے منظوریات سکیورٹی کو `deny` پر سیٹ کریں
  یا ٹول پالیسی کے ذریعے `exec` ٹول کو deny کریں۔

متعلقہ:

- [Exec tool](/tools/exec)
- [Elevated mode](/tools/elevated)
- [Skills](/tools/skills)
