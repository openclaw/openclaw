---
summary: "Telegram рдмреЙрдЯ рд╕рдорд░реНрдерди рдХреА рд╕реНрдерд┐рддрд┐, рдХреНрд╖рдорддрд╛рдПрдБ рдФрд░ рд╡рд┐рдиреНрдпрд╛рд╕"
read_when:
  - Telegram рдлреАрдЪрд░реНрд╕ рдпрд╛ рд╡реЗрдмрд╣реБрдХреНрд╕ рдкрд░ рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп
title: "Telegram"
x-i18n:
  source_path: channels/telegram.md
  source_hash: 604e2dc12d2b776d
  provider: openai
  model: gpt-5.2-chat-latest
  workflow: v1
  generated_at: 2026-02-08T10:50:20Z
---

# Telegram (Bot API)

рд╕реНрдерд┐рддрд┐: grammY рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмреЙрдЯ DMs + рд╕рдореВрд╣реЛрдВ рдХреЗ рд▓рд┐рдП production-readyред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ long-polling; webhook рд╡реИрдХрд▓реНрдкрд┐рдХред

## рддреНрд╡рд░рд┐рдд рд╕реЗрдЯрдЕрдк (рд╢реБрд░реБрдЖрддреА)

1. **@BotFather** рдХреЗ рд╕рд╛рде рдПрдХ рдмреЙрдЯ рдмрдирд╛рдПрдБ ([direct link](https://t.me/BotFather))ред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╣реИрдВрдбрд▓ рдмрд┐рд▓реНрдХреБрд▓ `@BotFather` рд╣реИ, рдлрд┐рд░ рдЯреЛрдХрди рдХреЙрдкреА рдХрд░реЗрдВред
2. рдЯреЛрдХрди рд╕реЗрдЯ рдХрд░реЗрдВ:
   - Env: `TELEGRAM_BOT_TOKEN=...`
   - рдпрд╛ config: `channels.telegram.botToken: "..."`ред
   - рдпрджрд┐ рджреЛрдиреЛрдВ рд╕реЗрдЯ рд╣реИрдВ, рддреЛ config рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд┐рд▓реЗрдЧреА (env fallback рдХреЗрд╡рд▓ default-account рдХреЗ рд▓рд┐рдП рд╣реИ)ред
3. Gateway рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред
4. DM рдПрдХреНрд╕реЗрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ pairing рд╣реИ; рдкрд╣рд▓реА рдмрд╛рд░ рд╕рдВрдкрд░реНрдХ рдкрд░ pairing рдХреЛрдб рдХреЛ рдЕрдиреБрдореЛрджрд┐рдд рдХрд░реЗрдВред

рдиреНрдпреВрдирддрдо config:

```json5
{
  channels: {
    telegram: {
      enabled: true,
      botToken: "123:abc",
      dmPolicy: "pairing",
    },
  },
}
```

## рдпрд╣ рдХреНрдпрд╛ рд╣реИ

- Gateway рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓рд╛ Telegram Bot API рдЪреИрдирд▓ред
- Deterministic routing: рдЙрддреНрддрд░ рд╡рд╛рдкрд╕ Telegram рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ; рдореЙрдбрд▓ рдХрднреА рдЪреИрдирд▓ рдирд╣реАрдВ рдЪреБрдирддрд╛ред
- DMs рдПрдЬреЗрдВрдЯ рдХреЗ рдореБрдЦреНрдп рд╕рддреНрд░ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ; рд╕рдореВрд╣ рдЕрд▓рдЧ-рдерд▓рдЧ рд░рд╣рддреЗ рд╣реИрдВ (`agent:<agentId>:telegram:group:<chatId>`)ред

## рд╕реЗрдЯрдЕрдк (рддреНрд╡рд░рд┐рдд рдорд╛рд░реНрдЧ)

### 1) рдмреЙрдЯ рдЯреЛрдХрди рдмрдирд╛рдПрдБ (BotFather)

1. Telegram рдЦреЛрд▓реЗрдВ рдФрд░ **@BotFather** рд╕реЗ рдЪреИрдЯ рдХрд░реЗрдВ ([direct link](https://t.me/BotFather))ред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╣реИрдВрдбрд▓ рдмрд┐рд▓реНрдХреБрд▓ `@BotFather` рд╣реИред
2. `/newbot` рдЪрд▓рд╛рдПрдБ, рдлрд┐рд░ рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ (рдирд╛рдо + рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдЬреЛ `bot` рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реЛ)ред
3. рдЯреЛрдХрди рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВред

рд╡реИрдХрд▓реНрдкрд┐рдХ BotFather рд╕реЗрдЯрд┐рдВрдЧреНрд╕:

- `/setjoingroups` тАФ рдмреЙрдЯ рдХреЛ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐/рдЕрд╕реНрд╡реАрдХреГрддрд┐ред
- `/setprivacy` тАФ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдмреЙрдЯ рд╕рднреА рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рджреЗрдЦреЗ рдпрд╛ рдирд╣реАрдВред

### 2) рдЯреЛрдХрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ (env рдпрд╛ config)

рдЙрджрд╛рд╣рд░рдг:

```json5
{
  channels: {
    telegram: {
      enabled: true,
      botToken: "123:abc",
      dmPolicy: "pairing",
      groups: { "*": { requireMention: true } },
    },
  },
}
```

Env рд╡рд┐рдХрд▓реНрдк: `TELEGRAM_BOT_TOKEN=...` (default account рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред
рдпрджрд┐ env рдФрд░ config рджреЛрдиреЛрдВ рд╕реЗрдЯ рд╣реИрдВ, рддреЛ config рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд┐рд▓рддреА рд╣реИред

Multi-account рд╕рдорд░реНрдерди: рдкреНрд░рддрд┐-рдЦрд╛рддрд╛ рдЯреЛрдХрди рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ `name` рдХреЗ рд╕рд╛рде `channels.telegram.accounts` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рд╕рд╛рдЭрд╛ рдкреИрдЯрд░реНрди рдХреЗ рд▓рд┐рдП [`gateway/configuration`](/gateway/configuration#telegramaccounts--discordaccounts--slackaccounts--signalaccounts--imessageaccounts) рджреЗрдЦреЗрдВред

3. Gateway рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред рдЯреЛрдХрди рдХреЗ resolve рд╣реЛрддреЗ рд╣реА Telegram рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ (рдкрд╣рд▓реЗ config, рдлрд┐рд░ env fallback)ред
4. DM рдПрдХреНрд╕реЗрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ pairing рд╣реИред рдкрд╣рд▓реА рдмрд╛рд░ рдмреЙрдЯ рд╕реЗ рд╕рдВрдкрд░реНрдХ рд╣реЛрдиреЗ рдкрд░ рдХреЛрдб рдЕрдиреБрдореЛрджрд┐рдд рдХрд░реЗрдВред
5. рд╕рдореВрд╣реЛрдВ рдХреЗ рд▓рд┐рдП: рдмреЙрдЯ рдЬреЛрдбрд╝реЗрдВ, privacy/admin рд╡реНрдпрд╡рд╣рд╛рд░ рддрдп рдХрд░реЗрдВ (рдиреАрдЪреЗ), рдлрд┐рд░ mention gating + allowlists рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `channels.telegram.groups` рд╕реЗрдЯ рдХрд░реЗрдВред

## Token + privacy + permissions (Telegram рдкрдХреНрд╖)

### рдЯреЛрдХрди рдирд┐рд░реНрдорд╛рдг (BotFather)

- `/newbot` рдмреЙрдЯ рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдЯреЛрдХрди рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рдЗрд╕реЗ рдЧреЛрдкрдиреАрдп рд░рдЦреЗрдВ)ред
- рдпрджрд┐ рдЯреЛрдХрди рд▓реАрдХ рд╣реЛ рдЬрд╛рдП, рддреЛ @BotFather рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕реЗ revoke/regenerate рдХрд░реЗрдВ рдФрд░ рдЕрдкрдирд╛ config рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред

### рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рджреГрд╢реНрдпрддрд╛ (Privacy Mode)

Telegram рдмреЙрдЯ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **Privacy Mode** рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рдпрд╣ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдХреМрди-рд╕реЗ рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
рдпрджрд┐ рдЖрдкрдХреЗ рдмреЙрдЯ рдХреЛ _рд╕рднреА_ рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рджреЗрдЦрдиреЗ рд╣реЛрдВ, рддреЛ рджреЛ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

- `/setprivacy` рд╕реЗ privacy mode рдЕрдХреНрд╖рдо рдХрд░реЗрдВ **рдпрд╛**
- рдмреЙрдЯ рдХреЛ рд╕рдореВрд╣ **admin** рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ (admin рдмреЙрдЯ рд╕рднреА рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ)ред

**Note:** privacy mode рдмрджрд▓рдиреЗ рдкрд░, Telegram рдкрд░рд┐рд╡рд░реНрддрди рдкреНрд░рднрд╛рд╡реА рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рд╕рдореВрд╣ рд╕реЗ рдмреЙрдЯ рд╣рдЯрд╛рдХрд░ рдкреБрдирдГ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд░рддрд╛ рд╣реИред

### рд╕рдореВрд╣ рдЕрдиреБрдорддрд┐рдпрд╛рдБ (admin рдЕрдзрд┐рдХрд╛рд░)

Admin рд╕реНрдерд┐рддрд┐ рд╕рдореВрд╣ рдХреЗ рднреАрддрд░ (Telegram UI) рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИред Admin рдмреЙрдЯ рд╣рдореЗрд╢рд╛ рд╕рднреА рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкреВрд░реНрдг рджреГрд╢реНрдпрддрд╛ рдХреЗ рд▓рд┐рдП admin рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

## рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ (рд╡реНрдпрд╡рд╣рд╛рд░)

- рдЗрдирдмрд╛рдЙрдВрдб рд╕рдВрджреЗрд╢ reply context рдФрд░ media placeholders рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдЪреИрдирд▓ envelope рдореЗрдВ normalize рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- рд╕рдореВрд╣ рдЙрддреНрддрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ mention рдЖрд╡рд╢реНрдпрдХ рд╣реИ (native @mention рдпрд╛ `agents.list[].groupChat.mentionPatterns` / `messages.groupChat.mentionPatterns`)ред
- Multi-agent override: `agents.list[].groupChat.mentionPatterns` рдкрд░ рдкреНрд░рддрд┐-рдПрдЬреЗрдВрдЯ рдкреИрдЯрд░реНрди рд╕реЗрдЯ рдХрд░реЗрдВред
- рдЙрддреНрддрд░ рд╣рдореЗрд╢рд╛ рдЙрд╕реА Telegram рдЪреИрдЯ рдкрд░ рд╡рд╛рдкрд╕ рд░реВрдЯ рд╣реЛрддреЗ рд╣реИрдВред
- Long-polling grammY runner рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рддрд┐-рдЪреИрдЯ sequencing рдХреЗ рд╕рд╛рде рдХрд░рддрд╛ рд╣реИ; рд╕рдордЧреНрд░ concurrency `agents.defaults.maxConcurrent` рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реИред
- Telegram Bot API read receipts рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛; рдХреЛрдИ `sendReadReceipts` рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред

## Draft streaming

OpenClaw `sendMessageDraft` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Telegram DMs рдореЗрдВ рдЖрдВрд╢рд┐рдХ рдЙрддреНрддрд░ рд╕реНрдЯреНрд░реАрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ:

- @BotFather рдореЗрдВ рдмреЙрдЯ рдХреЗ рд▓рд┐рдП Threaded Mode рд╕рдХреНрд╖рдо (forum topic mode)ред
- рдХреЗрд╡рд▓ private chat threads (Telegram рдЗрдирдмрд╛рдЙрдВрдб рд╕рдВрджреЗрд╢реЛрдВ рдкрд░ `message_thread_id` рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ)ред
- `channels.telegram.streamMode` рдХреЛ `"off"` рдкрд░ рд╕реЗрдЯ рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: `"partial"`, `"block"` chunked draft updates рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИ)ред

Draft streaming рдХреЗрд╡рд▓ DMs рдХреЗ рд▓рд┐рдП рд╣реИ; Telegram рдЗрд╕реЗ рд╕рдореВрд╣реЛрдВ рдпрд╛ рдЪреИрдирд▓реЛрдВ рдореЗрдВ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ред

## Formatting (Telegram HTML)

- рдЖрдЙрдЯрдмрд╛рдЙрдВрдб Telegram рдЯреЗрдХреНрд╕реНрдЯ `parse_mode: "HTML"` (Telegram рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдЯреИрдЧ рдЙрдкрд╕рдореБрдЪреНрдЪрдп) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
- Markdown-рдЬреИрд╕рд╛ рдЗрдирдкреБрдЯ **Telegram-safe HTML** (bold/italic/strike/code/links) рдореЗрдВ рд░реЗрдВрдбрд░ рд╣реЛрддрд╛ рд╣реИ; block elements рдХреЛ newlines/bullets рдХреЗ рд╕рд╛рде рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ flatten рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдореЙрдбрд▓реЛрдВ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓рд╛ raw HTML Telegram parse рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП escaped рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдпрджрд┐ Telegram HTML payload рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ OpenClaw рд╡рд╣реА рд╕рдВрджреЗрд╢ plain text рдХреЗ рд░реВрдк рдореЗрдВ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред

## Commands (native + custom)

OpenClaw рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкрд░ Telegram рдХреЗ bot menu рдореЗрдВ native commands (рдЬреИрд╕реЗ `/status`, `/reset`, `/model`) рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИред
рдЖрдк config рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ menu рдореЗрдВ custom commands рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:

```json5
{
  channels: {
    telegram: {
      customCommands: [
        { command: "backup", description: "Git backup" },
        { command: "generate", description: "Create an image" },
      ],
    },
  },
}
```

## рд╕реЗрдЯрдЕрдк рд╕рдорд╕реНрдпрд╛-рдирд┐рд╡рд╛рд░рдг (commands)

- рд▓реЙрдЧреНрд╕ рдореЗрдВ `setMyCommands failed` рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ `api.telegram.org` рдХреЗ рд▓рд┐рдП outbound HTTPS/DNS рдЕрд╡рд░реБрджреНрдз рд╣реИред
- рдпрджрд┐ `sendMessage` рдпрд╛ `sendChatAction` рд╡рд┐рдлрд▓рддрд╛рдПрдБ рджрд┐рдЦреЗрдВ, рддреЛ IPv6 routing рдФрд░ DNS рдЬрд╛рдБрдЪреЗрдВред

рдЕрдзрд┐рдХ рд╕рд╣рд╛рдпрддрд╛: [Channel troubleshooting](/channels/troubleshooting).

Notes:

- Custom commands **рдХреЗрд╡рд▓ menu entries** рд╣реИрдВ; OpenClaw рдЙрдиреНрд╣реЗрдВ рддрдм рддрдХ рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд░рддрд╛ рдЬрдм рддрдХ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдХрд╣реАрдВ рдФрд░ рд╣реИрдВрдбрд▓ рди рдХрд░реЗрдВред
- Command рдирд╛рдо normalize рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (leading `/` рд╣рдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, lowercased) рдФрд░ `a-z`, `0-9`, `_` (1тАУ32 chars) рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдЪрд╛рд╣рд┐рдПред
- Custom commands **native commands рдХреЛ override рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**ред рдЯрдХрд░рд╛рд╡ рдЕрдирджреЗрдЦреЗ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рд▓реЙрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- рдпрджрд┐ `commands.native` рдЕрдХреНрд╖рдо рд╣реИ, рддреЛ рдХреЗрд╡рд▓ custom commands рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдпрд╛ рдпрджрд┐ рдХреЛрдИ рдирд╣реАрдВ, рддреЛ рд╕рд╛рдлрд╝ рдХрд░ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ)ред

## Limits

- рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЯреЗрдХреНрд╕реНрдЯ `channels.telegram.textChunkLimit` рддрдХ chunk рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ 4000)ред
- рд╡реИрдХрд▓реНрдкрд┐рдХ newline chunking: рд▓рдВрдмрд╛рдИ chunking рд╕реЗ рдкрд╣рд▓реЗ blank lines (paragraph boundaries) рдкрд░ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `channels.telegram.chunkMode="newline"` рд╕реЗрдЯ рдХрд░реЗрдВред
- Media downloads/uploads `channels.telegram.mediaMaxMb` рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реИрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ 5)ред
- Telegram Bot API рдЕрдиреБрд░реЛрдз `channels.telegram.timeoutSeconds` рдХреЗ рдмрд╛рдж time out рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ (grammY рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ 500)ред рд▓рдВрдмреЗ hang рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗрдЯ рдХрд░реЗрдВред
- рд╕рдореВрд╣ рдЗрддрд┐рд╣рд╛рд╕ рд╕рдВрджрд░реНрдн `channels.telegram.historyLimit` (рдпрд╛ `channels.telegram.accounts.*.historyLimit`) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, fallback `messages.groupChat.historyLimit` рдкрд░ред рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `0` рд╕реЗрдЯ рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ 50)ред
- DM рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ `channels.telegram.dmHistoryLimit` (user turns) рд╕реЗ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкреНрд░рддрд┐-рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ overrides: `channels.telegram.dms["<user_id>"].historyLimit`ред

## Group activation modes

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдмреЙрдЯ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рдХреЗрд╡рд▓ mentions рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ (`@botname` рдпрд╛ `agents.list[].groupChat.mentionPatterns` рдореЗрдВ рдкреИрдЯрд░реНрди)ред рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП:

### Config рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдЕрдиреБрд╢рдВрд╕рд┐рдд)

```json5
{
  channels: {
    telegram: {
      groups: {
        "-1001234567890": { requireMention: false }, // always respond in this group
      },
    },
  },
}
```

**Important:** `channels.telegram.groups` рд╕реЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдПрдХ **allowlist** рдмрдирддреА рд╣реИ тАФ рдХреЗрд╡рд▓ рд╕реВрдЪреАрдмрджреНрдз рд╕рдореВрд╣ (рдпрд╛ `"*"`) рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЬрд╛рдПрдБрдЧреЗред
Forum topics рдЕрдкрдиреЗ parent group config (allowFrom, requireMention, skills, prompts) рдХреЛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рд▓реЗрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдЖрдк `channels.telegram.groups.<groupId>.topics.<topicId>` рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдкреНрд░рддрд┐-рдЯреЙрдкрд┐рдХ overrides рди рдЬреЛрдбрд╝реЗрдВред

рд╕рднреА рд╕рдореВрд╣реЛрдВ рдХреЛ always-respond рдХреЗ рд╕рд╛рде рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП:

```json5
{
  channels: {
    telegram: {
      groups: {
        "*": { requireMention: false }, // all groups, always respond
      },
    },
  },
}
```

рд╕рднреА рд╕рдореВрд╣реЛрдВ рдХреЗ рд▓рд┐рдП mention-only рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░):

```json5
{
  channels: {
    telegram: {
      groups: {
        "*": { requireMention: true }, // or omit groups entirely
      },
    },
  },
}
```

### Command рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (session-level)

рд╕рдореВрд╣ рдореЗрдВ рднреЗрдЬреЗрдВ:

- `/activation always` - рд╕рднреА рд╕рдВрджреЗрд╢реЛрдВ рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдВ
- `/activation mention` - mentions рдЖрд╡рд╢реНрдпрдХ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)

**Note:** Commands рдХреЗрд╡рд▓ session state рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВред restart рдХреЗ рдмрд╛рдж рд╕реНрдерд╛рдпреА рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд▓рд┐рдП config рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

### Group chat ID рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

рдХрд┐рд╕реА рднреА рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рдХреЛ `@userinfobot` рдпрд╛ `@getidsbot` рдкрд░ forward рдХрд░реЗрдВ рддрд╛рдХрд┐ chat ID (рдЬреИрд╕реЗ `-1001234567890` рдЬреИрд╕реА рдирдХрд╛рд░рд╛рддреНрдордХ рд╕рдВрдЦреНрдпрд╛) рджрд┐рдЦрд╛рдИ рджреЗред

**Tip:** рдЕрдкрдиреЗ user ID рдХреЗ рд▓рд┐рдП, рдмреЙрдЯ рдХреЛ DM рдХрд░реЗрдВ рдФрд░ рдпрд╣ рдЖрдкрдХреЗ user ID (pairing рд╕рдВрджреЗрд╢) рдХреЗ рд╕рд╛рде рдЙрддреНрддрд░ рджреЗрдЧрд╛, рдпрд╛ commands рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдкрд░ `/whoami` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

**Privacy note:** `@userinfobot` рдПрдХ third-party рдмреЙрдЯ рд╣реИред рдпрджрд┐ рдЖрдк рдЪрд╛рд╣реЗрдВ, рддреЛ рдмреЙрдЯ рдХреЛ рд╕рдореВрд╣ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВ, рдФрд░ `openclaw logs --follow` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `chat.id` рдкрдврд╝реЗрдВ, рдпрд╛ Bot API `getUpdates` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

## Config writes

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Telegram рдХреЛ рдЪреИрдирд▓ рдЗрд╡реЗрдВрдЯреНрд╕ рдпрд╛ `/config set|unset` рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЧрдП config рдЕрдкрдбреЗрдЯ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

рдпрд╣ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм:

- рдХрд┐рд╕реА рд╕рдореВрд╣ рдХреЛ supergroup рдореЗрдВ рдЕрдкрдЧреНрд░реЗрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ Telegram `migrate_to_chat_id` рдЙрддреНрд╕рд░реНрдЬрд┐рдд рдХрд░рддрд╛ рд╣реИ (chat ID рдмрджрд▓рддрд╛ рд╣реИ)ред OpenClaw `channels.telegram.groups` рдХреЛ рд╕реНрд╡рддрдГ migrate рдХрд░ рд╕рдХрддрд╛ рд╣реИред
- рдЖрдк Telegram рдЪреИрдЯ рдореЗрдВ `/config set` рдпрд╛ `/config unset` рдЪрд▓рд╛рддреЗ рд╣реИрдВ (рдЗрд╕рдХреЗ рд▓рд┐рдП `commands.config: true` рдЖрд╡рд╢реНрдпрдХ рд╣реИ)ред

рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

```json5
{
  channels: { telegram: { configWrites: false } },
}
```

## Topics (forum supergroups)

Telegram forum topics рдореЗрдВ рдкреНрд░рддрд┐ рд╕рдВрджреЗрд╢ `message_thread_id` рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред OpenClaw:

- рдкреНрд░рддреНрдпреЗрдХ рдЯреЙрдкрд┐рдХ рдХреЛ рдЕрд▓рдЧ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП Telegram group session key рдореЗрдВ `:topic:<threadId>` рдЬреЛрдбрд╝рддрд╛ рд╣реИред
- typing indicators рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ `message_thread_id` рдХреЗ рд╕рд╛рде рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдЙрд╕реА рдЯреЙрдкрд┐рдХ рдореЗрдВ рд░рд╣реЗрдВред
- General topic (thread id `1`) рд╡рд┐рд╢реЗрд╖ рд╣реИ: рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╕рдордп `message_thread_id` рдЫреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ (Telegram рдЗрд╕реЗ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди typing indicators рдореЗрдВ рдпрд╣ рд╢рд╛рдорд┐рд▓ рд░рд╣рддрд╛ рд╣реИред
- routing/templating рдХреЗ рд▓рд┐рдП template context рдореЗрдВ `MessageThreadId` + `IsForum` рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред
- рдЯреЙрдкрд┐рдХ-рд╡рд┐рд╢рд┐рд╖реНрдЯ configuration `channels.telegram.groups.<chatId>.topics.<threadId>` рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЙрдкрд▓рдмреНрдз рд╣реИ (skills, allowlists, auto-reply, system prompts, disable)ред
- рдЯреЙрдкрд┐рдХ configs рд╕рдореВрд╣ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ (requireMention, allowlists, skills, prompts, enabled) рдХреЛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рд▓реЗрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдкреНрд░рддрд┐-рдЯреЙрдкрд┐рдХ override рди рдХрд┐рдпрд╛ рдЬрд╛рдПред

Private chats рдХреБрдЫ edge cases рдореЗрдВ `message_thread_id` рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред OpenClaw DM session key рдХреЛ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрд╣рд╛рдБ рдореМрдЬреВрдж рд╣реЛ, replies/draft streaming рдХреЗ рд▓рд┐рдП thread id рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

## Inline Buttons

Telegram callback buttons рдХреЗ рд╕рд╛рде inline keyboards рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

```json5
{
  channels: {
    telegram: {
      capabilities: {
        inlineButtons: "allowlist",
      },
    },
  },
}
```

рдкреНрд░рддрд┐-рдЦрд╛рддрд╛ configuration рдХреЗ рд▓рд┐рдП:

```json5
{
  channels: {
    telegram: {
      accounts: {
        main: {
          capabilities: {
            inlineButtons: "allowlist",
          },
        },
      },
    },
  },
}
```

Scopes:

- `off` тАФ inline buttons рдЕрдХреНрд╖рдо
- `dm` тАФ рдХреЗрд╡рд▓ DMs (group targets рдЕрд╡рд░реБрджреНрдз)
- `group` тАФ рдХреЗрд╡рд▓ рд╕рдореВрд╣ (DM targets рдЕрд╡рд░реБрджреНрдз)
- `all` тАФ DMs + рд╕рдореВрд╣
- `allowlist` тАФ DMs + рд╕рдореВрд╣, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ `allowFrom`/`groupAllowFrom` рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдордд рдкреНрд░реЗрд╖рдХ (control commands рдЬреИрд╕реЗ рд╣реА рдирд┐рдпрдо)

рдбрд┐рдлрд╝реЙрд▓реНрдЯ: `allowlist`ред
Legacy: `capabilities: ["inlineButtons"]` = `inlineButtons: "all"`ред

### Buttons рднреЗрдЬрдирд╛

message tool рдХрд╛ рдЙрдкрдпреЛрдЧ `buttons` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдХрд░реЗрдВ:

```json5
{
  action: "send",
  channel: "telegram",
  to: "123456789",
  message: "Choose an option:",
  buttons: [
    [
      { text: "Yes", callback_data: "yes" },
      { text: "No", callback_data: "no" },
    ],
    [{ text: "Cancel", callback_data: "cancel" }],
  ],
}
```

рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдЯрди рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ, рддреЛ callback data рдПрдЬреЗрдВрдЯ рдХреЛ рдЗрд╕ рдлрд╝реЙрд░реНрдореИрдЯ рдореЗрдВ рд╕рдВрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ:
`callback_data: value`

### Configuration рд╡рд┐рдХрд▓реНрдк

Telegram рдХреНрд╖рдорддрд╛рдПрдБ рджреЛ рд╕реНрддрд░реЛрдВ рдкрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ (рдКрдкрд░ object form рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ; legacy string arrays рднреА рд╕рдорд░реНрдерд┐рдд рд╣реИрдВ):

- `channels.telegram.capabilities`: рд╕рднреА Telegram рдЦрд╛рддреЛрдВ рдкрд░ рд▓рд╛рдЧреВ global default capability config, рдЬрдм рддрдХ override рди рдХрд┐рдпрд╛ рдЬрд╛рдПред
- `channels.telegram.accounts.<account>.capabilities`: рдкреНрд░рддрд┐-рдЦрд╛рддрд╛ capabilities рдЬреЛ рдЙрд╕ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП global defaults рдХреЛ override рдХрд░рддреА рд╣реИрдВред

рдЬрдм рд╕рднреА Telegram bots/accounts рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рддрдм global setting рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЬрдм рдЕрд▓рдЧ-рдЕрд▓рдЧ bots рдХреЛ рдЕрд▓рдЧ рд╡реНрдпрд╡рд╣рд╛рд░ рдЪрд╛рд╣рд┐рдП (рдЙрджрд╛рд╣рд░рдг: рдПрдХ рдЦрд╛рддрд╛ рдХреЗрд╡рд▓ DMs рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ рдЬрдмрдХрд┐ рджреВрд╕рд░рд╛ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рдЕрдиреБрдордд рд╣реИ), рддрдм per-account configuration рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

## Access control (DMs + groups)

### DM access

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ: `channels.telegram.dmPolicy = "pairing"`ред рдЕрдЬреНрдЮрд╛рдд рдкреНрд░реЗрд╖рдХреЛрдВ рдХреЛ pairing code рдорд┐рд▓рддрд╛ рд╣реИ; рдЕрдиреБрдореЛрджрди рддрдХ рд╕рдВрджреЗрд╢ рдЕрдирджреЗрдЦреЗ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (codes 1 рдШрдВрдЯреЗ рдмрд╛рдж рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ)ред
- рдЕрдиреБрдореЛрджрди рдХрд░реЗрдВ:
  - `openclaw pairing list telegram`
  - `openclaw pairing approve telegram <CODE>`
- Pairing Telegram DMs рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ token exchange рд╣реИред рд╡рд┐рд╡рд░рдг: [Pairing](/channels/pairing)
- `channels.telegram.allowFrom` numeric user IDs (рдЕрдиреБрд╢рдВрд╕рд┐рдд) рдпрд╛ `@username` entries рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдмреЙрдЯ username рдирд╣реАрдВ рд╣реИ; рдорд╛рдирд╡ рдкреНрд░реЗрд╖рдХ рдХрд╛ ID рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред wizard `@username` рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рдВрднрд╡ рд╣реЛрдиреЗ рдкрд░ numeric ID рдореЗрдВ resolve рдХрд░рддрд╛ рд╣реИред

#### рдЕрдкрдирд╛ Telegram user ID рдвреВрдБрдврдирд╛

рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд (рдХреЛрдИ third-party рдмреЙрдЯ рдирд╣реАрдВ):

1. Gateway рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ рдФрд░ рдЕрдкрдиреЗ рдмреЙрдЯ рдХреЛ DM рдХрд░реЗрдВред
2. `openclaw logs --follow` рдЪрд▓рд╛рдПрдБ рдФрд░ `from.id` рджреЗрдЦреЗрдВред

рд╡реИрдХрд▓реНрдкрд┐рдХ (official Bot API):

1. рдЕрдкрдиреЗ рдмреЙрдЯ рдХреЛ DM рдХрд░реЗрдВред
2. рдЕрдкрдиреЗ рдмреЙрдЯ рдЯреЛрдХрди рдХреЗ рд╕рд╛рде updates рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ `message.from.id` рдкрдврд╝реЗрдВ:

   ```bash
   curl "https://api.telegram.org/bot<bot_token>/getUpdates"
   ```

Third-party (рдХрдо рдирд┐рдЬреА):

- `@userinfobot` рдпрд╛ `@getidsbot` рдХреЛ DM рдХрд░реЗрдВ рдФрд░ рд▓реМрдЯрд╛рдпрд╛ рдЧрдпрд╛ user id рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

### Group access

рджреЛ рд╕реНрд╡рддрдВрддреНрд░ рдирд┐рдпрдВрддреНрд░рдг:

**1. рдХреМрди-рд╕реЗ рд╕рдореВрд╣ рдЕрдиреБрдордд рд╣реИрдВ** (`channels.telegram.groups` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ group allowlist):

- рдХреЛрдИ `groups` config рдирд╣реАрдВ = рд╕рднреА рд╕рдореВрд╣ рдЕрдиреБрдордд
- `groups` config рдХреЗ рд╕рд╛рде = рдХреЗрд╡рд▓ рд╕реВрдЪреАрдмрджреНрдз рд╕рдореВрд╣ рдпрд╛ `"*"` рдЕрдиреБрдордд
- рдЙрджрд╛рд╣рд░рдг: `"groups": { "-1001234567890": {}, "*": {} }` рд╕рднреА рд╕рдореВрд╣реЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ

**2. рдХреМрди-рд╕реЗ рдкреНрд░реЗрд╖рдХ рдЕрдиреБрдордд рд╣реИрдВ** (`channels.telegram.groupPolicy` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ sender filtering):

- `"open"` = рдЕрдиреБрдордд рд╕рдореВрд╣реЛрдВ рдХреЗ рд╕рднреА рдкреНрд░реЗрд╖рдХ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ
- `"allowlist"` = рдХреЗрд╡рд▓ `channels.telegram.groupAllowFrom` рдореЗрдВ рдкреНрд░реЗрд╖рдХ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ
- `"disabled"` = рдХреЛрдИ рднреА рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ
  рдбрд┐рдлрд╝реЙрд▓реНрдЯ `groupPolicy: "allowlist"` рд╣реИ (рдЬрдм рддрдХ рдЖрдк `groupAllowFrom` рди рдЬреЛрдбрд╝реЗрдВ, рддрдм рддрдХ рдЕрд╡рд░реБрджреНрдз)ред

рдЕрдзрд┐рдХрд╛рдВрд╢ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ: `groupPolicy: "allowlist"` + `groupAllowFrom` + `channels.telegram.groups` рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдореВрд╣

рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдореВрд╣ рдореЗрдВ **рдХрд┐рд╕реА рднреА рд╕рджрд╕реНрдп** рдХреЛ рдмрд╛рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП (рдЬрдмрдХрд┐ control commands рдХреЗрд╡рд▓ authorized senders рддрдХ рд╕реАрдорд┐рдд рд░рд╣реЗрдВ), рдкреНрд░рддрд┐-рд╕рдореВрд╣ override рд╕реЗрдЯ рдХрд░реЗрдВ:

```json5
{
  channels: {
    telegram: {
      groups: {
        "-1001234567890": {
          groupPolicy: "open",
          requireMention: false,
        },
      },
    },
  },
}
```

## Long-polling рдмрдирд╛рдо webhook

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ: long-polling (рдХреЛрдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ URL рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ)ред
- Webhook рдореЛрдб: `channels.telegram.webhookUrl` рдФрд░ `channels.telegram.webhookSecret` рд╕реЗрдЯ рдХрд░реЗрдВ (рд╡реИрдХрд▓реНрдкрд┐рдХ `channels.telegram.webhookPath`)ред
  - local listener `0.0.0.0:8787` рдкрд░ bind рдХрд░рддрд╛ рд╣реИ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `POST /telegram-webhook` рд╕рд░реНрд╡ рдХрд░рддрд╛ рд╣реИред
  - рдпрджрд┐ рдЖрдкрдХрд╛ public URL рдЕрд▓рдЧ рд╣реИ, рддреЛ reverse proxy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ `channels.telegram.webhookUrl` рдХреЛ public endpoint рдкрд░ point рдХрд░реЗрдВред

## Reply threading

Telegram рдЯреИрдЧреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реИрдХрд▓реНрдкрд┐рдХ threaded replies рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

- `[[reply_to_current]]` -- triggering рд╕рдВрджреЗрд╢ рдХреЛ replyред
- `[[reply_to:<id>]]` -- рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ message id рдХреЛ replyред

`channels.telegram.replyToMode` рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд:

- `first` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ), `all`, `off`ред

## Audio messages (voice рдмрдирд╛рдо file)

Telegram **voice notes** (рдЧреЛрд▓ bubble) рдФрд░ **audio files** (metadata card) рдореЗрдВ рдЕрдВрддрд░ рдХрд░рддрд╛ рд╣реИред
OpenClaw backward compatibility рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ audio files рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдПрдЬреЗрдВрдЯ рдЙрддреНрддрд░реЛрдВ рдореЗрдВ voice note bubble рдХреЛ рдордЬрдмреВрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрддреНрддрд░ рдореЗрдВ рдХрд╣реАрдВ рднреА рдпрд╣ рдЯреИрдЧ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ:

- `[[audio_as_voice]]` тАФ audio рдХреЛ file рдХреЗ рдмрдЬрд╛рдп voice note рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬреЗрдВред

рдпрд╣ рдЯреИрдЧ рд╡рд┐рддрд░рд┐рдд рдЯреЗрдХреНрд╕реНрдЯ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдиреНрдп рдЪреИрдирд▓ рдЗрд╕ рдЯреИрдЧ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддреЗ рд╣реИрдВред

message tool рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, voice-compatible audio `media` URL рдХреЗ рд╕рд╛рде `asVoice: true` рд╕реЗрдЯ рдХрд░реЗрдВ
(рдЬрдм media рдореМрдЬреВрдж рд╣реЛ, рддреЛ `message` рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИ):

```json5
{
  action: "send",
  channel: "telegram",
  to: "123456789",
  media: "https://example.com/voice.ogg",
  asVoice: true,
}
```

## Stickers

OpenClaw рдмреБрджреНрдзрд┐рдорд╛рди caching рдХреЗ рд╕рд╛рде Telegram stickers рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рднреЗрдЬрдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

### Stickers рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ sticker рднреЗрдЬрддрд╛ рд╣реИ, рддреЛ OpenClaw sticker рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрд╕реЗ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ:

- **Static stickers (WEBP):** рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ vision рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рд╣реЛрддреЗ рд╣реИрдВред sticker рд╕рдВрджреЗрд╢ рд╕рд╛рдордЧреНрд░реА рдореЗрдВ `<media:sticker>` placeholder рдХреЗ рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред
- **Animated stickers (TGS):** рдЫреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ (Lottie рдлрд╝реЙрд░реНрдореИрдЯ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ)ред
- **Video stickers (WEBM):** рдЫреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ (video рдлрд╝реЙрд░реНрдореИрдЯ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ)ред

Stickers рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрд▓рдмреНрдз template context field:

- `Sticker` тАФ object рдЬрд┐рд╕рдореЗрдВ:
  - `emoji` тАФ sticker рд╕реЗ рдЬреБрдбрд╝рд╛ emoji
  - `setName` тАФ sticker set рдХрд╛ рдирд╛рдо
  - `fileId` тАФ Telegram file ID (рд╡рд╣реА sticker рд╡рд╛рдкрд╕ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП)
  - `fileUniqueId` тАФ cache lookup рдХреЗ рд▓рд┐рдП stable ID
  - `cachedDescription` тАФ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдкрд░ cached vision description

### Sticker cache

Stickers рдХреЛ рд╡рд┐рд╡рд░рдг рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП AI рдХреА vision рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЪреВрдБрдХрд┐ рд╡рд╣реА stickers рдЕрдХреНрд╕рд░ рдмрд╛рд░-рдмрд╛рд░ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, OpenClaw рджреЛрд╣рд░рд╛рдП рдЧрдП API calls рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрди рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ cache рдХрд░рддрд╛ рд╣реИред

**рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:**

1. **рдкрд╣рд▓реА рдмрд╛рд░:** sticker image рдХреЛ vision analysis рдХреЗ рд▓рд┐рдП AI рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред AI рд╡рд┐рд╡рд░рдг рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг: "A cartoon cat waving enthusiastically")ред
2. **Cache storage:** рд╡рд┐рд╡рд░рдг sticker рдХреЗ file ID, emoji рдФрд░ set name рдХреЗ рд╕рд╛рде рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред
3. **рдмрд╛рдж рдХреА рдмрд╛рд░реЗрдВ:** рд╡рд╣реА sticker рдлрд┐рд░ рджрд┐рдЦрдиреЗ рдкрд░ cached рд╡рд┐рд╡рд░рдг рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред image AI рдХреЛ рдирд╣реАрдВ рднреЗрдЬреА рдЬрд╛рддреАред

**Cache location:** `~/.openclaw/telegram/sticker-cache.json`

**Cache entry format:**

```json
{
  "fileId": "CAACAgIAAxkBAAI...",
  "fileUniqueId": "AgADBAADb6cxG2Y",
  "emoji": "ЁЯСЛ",
  "setName": "CoolCats",
  "description": "A cartoon cat waving enthusiastically",
  "cachedAt": "2026-01-15T10:30:00.000Z"
}
```

**рд▓рд╛рдн:**

- рд╕рдорд╛рди sticker рдХреЗ рд▓рд┐рдП рджреЛрд╣рд░рд╛рдП рдЧрдП vision calls рд╕реЗ рдмрдЪрдХрд░ API рд▓рд╛рдЧрдд рдХрдо рд╣реЛрддреА рд╣реИ
- cached stickers рдХреЗ рд▓рд┐рдП рддреЗрдЬрд╝ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп (рдХреЛрдИ vision рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рджреЗрд░реА рдирд╣реАрдВ)
- cached рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ sticker search рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕рдХреНрд╖рдо рд╣реЛрддреА рд╣реИ

Cache stickers рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реА рд╕реНрд╡рддрдГ рднрд░ рдЬрд╛рддрд╛ рд╣реИред рдХрд┐рд╕реА рдореИрдиреНрдпреБрдЕрд▓ cache рдкреНрд░рдмрдВрдзрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

### Stickers рднреЗрдЬрдирд╛

рдПрдЬреЗрдВрдЯ `sticker` рдФрд░ `sticker-search` actions рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ stickers рднреЗрдЬ рдФрд░ рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИред рдпреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИрдВ рдФрд░ config рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗ:

```json5
{
  channels: {
    telegram: {
      actions: {
        sticker: true,
      },
    },
  },
}
```

**Sticker рднреЗрдЬреЗрдВ:**

```json5
{
  action: "sticker",
  channel: "telegram",
  to: "123456789",
  fileId: "CAACAgIAAxkBAAI...",
}
```

Parameters:

- `fileId` (required) тАФ sticker рдХрд╛ Telegram file IDред рдЗрд╕реЗ sticker рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп `Sticker.fileId` рд╕реЗ, рдпрд╛ `sticker-search` рдкрд░рд┐рдгрд╛рдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
- `replyTo` (optional) тАФ reply рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП message IDред
- `threadId` (optional) тАФ forum topics рдХреЗ рд▓рд┐рдП message thread IDред

**Stickers рдЦреЛрдЬреЗрдВ:**

рдПрдЬреЗрдВрдЯ рд╡рд┐рд╡рд░рдг, emoji рдпрд╛ set name рдХреЗ рдЖрдзрд╛рд░ рдкрд░ cached stickers рдЦреЛрдЬ рд╕рдХрддрд╛ рд╣реИ:

```json5
{
  action: "sticker-search",
  channel: "telegram",
  query: "cat waving",
  limit: 5,
}
```

Cache рд╕реЗ рдорд┐рд▓рддреЗ-рдЬреБрд▓рддреЗ stickers рд▓реМрдЯрд╛рддрд╛ рд╣реИ:

```json5
{
  ok: true,
  count: 2,
  stickers: [
    {
      fileId: "CAACAgIAAxkBAAI...",
      emoji: "ЁЯСЛ",
      description: "A cartoon cat waving enthusiastically",
      setName: "CoolCats",
    },
  ],
}
```

рдЦреЛрдЬ рд╡рд┐рд╡рд░рдг рдЯреЗрдХреНрд╕реНрдЯ, emoji characters рдФрд░ set names рдореЗрдВ fuzzy matching рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред

**Threading рдХреЗ рд╕рд╛рде рдЙрджрд╛рд╣рд░рдг:**

```json5
{
  action: "sticker",
  channel: "telegram",
  to: "-1001234567890",
  fileId: "CAACAgIAAxkBAAI...",
  replyTo: 42,
  threadId: 123,
}
```

## Streaming (drafts)

Telegram рдЙрддреНрддрд░ рдЬрдирд░реЗрдЯ рдХрд░рддреЗ рд╕рдордп **draft bubbles** рд╕реНрдЯреНрд░реАрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред
OpenClaw Bot API `sendMessageDraft` (рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрджреЗрд╢ рдирд╣реАрдВ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░
рдЕрдВрддрд┐рдо рдЙрддреНрддрд░ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИред

рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ (Telegram Bot API 9.3+):

- **topics рд╕рдХреНрд╖рдо private chats** (рдмреЙрдЯ рдХреЗ рд▓рд┐рдП forum topic mode)ред
- рдЗрдирдХрдорд┐рдВрдЧ рд╕рдВрджреЗрд╢реЛрдВ рдореЗрдВ `message_thread_id` (private topic thread) рд╢рд╛рдорд┐рд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- рд╕рдореВрд╣/supergroups/channels рдХреЗ рд▓рд┐рдП streaming рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

Config:

- `channels.telegram.streamMode: "off" | "partial" | "block"` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: `partial`)
  - `partial`: рдирд╡реАрдирддрдо streaming рдЯреЗрдХреНрд╕реНрдЯ рдХреЗ рд╕рд╛рде draft bubble рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред
  - `block`: draft bubble рдХреЛ рдмрдбрд╝реЗ blocks (chunked) рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред
  - `off`: draft streaming рдЕрдХреНрд╖рдо рдХрд░реЗрдВред
- рд╡реИрдХрд▓реНрдкрд┐рдХ (рдХреЗрд╡рд▓ `streamMode: "block"` рдХреЗ рд▓рд┐рдП):
  - `channels.telegram.draftChunk: { minChars?, maxChars?, breakPreference? }`
    - defaults: `minChars: 200`, `maxChars: 800`, `breakPreference: "paragraph"` (`channels.telegram.textChunkLimit` рддрдХ clamp рдХрд┐рдпрд╛ рдЧрдпрд╛)ред

Note: draft streaming **block streaming** (channel messages) рд╕реЗ рдЕрд▓рдЧ рд╣реИред
Block streaming рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдмрдВрдж рд╣реИ рдФрд░ early Telegram messages рдХреЗ рд▓рд┐рдП `channels.telegram.blockStreaming: true` рдЖрд╡рд╢реНрдпрдХ рд╣реИ, draft updates рдХреЗ рдмрдЬрд╛рдпред

Reasoning stream (рдХреЗрд╡рд▓ Telegram):

- `/reasoning stream` рдЙрддреНрддрд░ рдЬрдирд░реЗрдЯ рд╣реЛрддреЗ рд╕рдордп reasoning рдХреЛ draft bubble рдореЗрдВ рд╕реНрдЯреНрд░реАрдо рдХрд░рддрд╛ рд╣реИ,
  рдлрд┐рд░ рдмрд┐рдирд╛ reasoning рдХреЗ рдЕрдВрддрд┐рдо рдЙрддреНрддрд░ рднреЗрдЬрддрд╛ рд╣реИред
- рдпрджрд┐ `channels.telegram.streamMode` `off` рд╣реИ, рддреЛ reasoning stream рдЕрдХреНрд╖рдо рд╣реИред
  рдЕрдзрд┐рдХ рд╕рдВрджрд░реНрдн: [Streaming + chunking](/concepts/streaming)ред

## Retry policy

Outbound Telegram API calls transient network/429 рддреНрд░реБрдЯрд┐рдпреЛрдВ рдкрд░ exponential backoff рдФрд░ jitter рдХреЗ рд╕рд╛рде retry рдХрд░рддреА рд╣реИрдВред `channels.telegram.retry` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред [Retry policy](/concepts/retry) рджреЗрдЦреЗрдВред

## Agent tool (messages + reactions)

- Tool: `telegram` with `sendMessage` action (`to`, `content`, optional `mediaUrl`, `replyToMessageId`, `messageThreadId`)ред
- Tool: `telegram` with `react` action (`chatId`, `messageId`, `emoji`)ред
- Tool: `telegram` with `deleteMessage` action (`chatId`, `messageId`)ред
- Reaction removal semantics: [/tools/reactions](/tools/reactions) рджреЗрдЦреЗрдВред
- Tool gating: `channels.telegram.actions.reactions`, `channels.telegram.actions.sendMessage`, `channels.telegram.actions.deleteMessage` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: рд╕рдХреНрд╖рдо), рдФрд░ `channels.telegram.actions.sticker` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: рдЕрдХреНрд╖рдо)ред

## Reaction notifications

**Reactions рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ:**
Telegram reactions **рдЕрд▓рдЧ `message_reaction` events** рдХреЗ рд░реВрдк рдореЗрдВ рдЖрддреА рд╣реИрдВ, рд╕рдВрджреЗрд╢ payloads рдХреА properties рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВред рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ reaction рдЬреЛрдбрд╝рддрд╛ рд╣реИ, OpenClaw:

1. Telegram API рд╕реЗ `message_reaction` update рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ
2. рдЗрд╕реЗ рдЗрд╕ рдлрд╝реЙрд░реНрдореИрдЯ рдХреЗ рд╕рд╛рде **system event** рдореЗрдВ рдмрджрд▓рддрд╛ рд╣реИ: `"Telegram reaction added: {emoji} by {user} on msg {id}"`
3. system event рдХреЛ рдирд┐рдпрдорд┐рдд рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд╕рдорд╛рди **session key** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ enqueue рдХрд░рддрд╛ рд╣реИ
4. рдЬрдм рдЙрд╕реА рдмрд╛рддрдЪреАрдд рдореЗрдВ рдЕрдЧрд▓рд╛ рд╕рдВрджреЗрд╢ рдЖрддрд╛ рд╣реИ, рддреЛ system events drain рд╣реЛрдХрд░ рдПрдЬреЗрдВрдЯ рдХреЗ context рдореЗрдВ prepend рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ

рдПрдЬреЗрдВрдЯ reactions рдХреЛ рдмрд╛рддрдЪреАрдд рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ **system notifications** рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрддрд╛ рд╣реИ, рди рдХрд┐ message metadata рдХреЗ рд░реВрдк рдореЗрдВред

**Configuration:**

- `channels.telegram.reactionNotifications`: рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди-рд╕реА reactions notifications рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ
  - `"off"` тАФ рд╕рднреА reactions рдЕрдирджреЗрдЦреА рдХрд░реЗрдВ
  - `"own"` тАФ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреЙрдЯ рд╕рдВрджреЗрд╢реЛрдВ рдкрд░ react рдХрд░реЗрдВ рддреЛ notify рдХрд░реЗрдВ (best-effort; in-memory) (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)
  - `"all"` тАФ рд╕рднреА reactions рдХреЗ рд▓рд┐рдП notify рдХрд░реЗрдВ

- `channels.telegram.reactionLevel`: рдПрдЬреЗрдВрдЯ рдХреА reaction рдХреНрд╖рдорддрд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ
  - `"off"` тАФ рдПрдЬреЗрдВрдЯ messages рдкрд░ react рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛
  - `"ack"` тАФ рдмреЙрдЯ acknowledgment reactions рднреЗрдЬрддрд╛ рд╣реИ (рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди ЁЯСА) (рдбрд┐рдлрд╝реЙрд▓реНрдЯ)
  - `"minimal"` тАФ рдПрдЬреЗрдВрдЯ рд╕реАрдорд┐рдд рд░реВрдк рд╕реЗ react рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдорд╛рд░реНрдЧрджрд░реНрд╢рди: рд╣рд░ 5тАУ10 exchanges рдореЗрдВ 1)
  - `"extensive"` тАФ рдЙрдкрдпреБрдХреНрдд рд╣реЛрдиреЗ рдкрд░ рдПрдЬреЗрдВрдЯ рдЙрджрд╛рд░рддрд╛ рд╕реЗ react рдХрд░ рд╕рдХрддрд╛ рд╣реИ

**Forum groups:** forum groups рдореЗрдВ reactions рдореЗрдВ `message_thread_id` рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ `agent:main:telegram:group:{chatId}:topic:{threadId}` рдЬреИрд╕реЗ session keys рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрд╕реА рдЯреЙрдкрд┐рдХ рдореЗрдВ reactions рдФрд░ рд╕рдВрджреЗрд╢ рд╕рд╛рде рд░рд╣реЗрдВред

**Example config:**

```json5
{
  channels: {
    telegram: {
      reactionNotifications: "all", // See all reactions
      reactionLevel: "minimal", // Agent can react sparingly
    },
  },
}
```

**Requirements:**

- Telegram bots рдХреЛ `allowed_updates` рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ `message_reaction` рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ (OpenClaw рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░)
- Webhook рдореЛрдб рдХреЗ рд▓рд┐рдП, reactions webhook `allowed_updates` рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИрдВ
- Polling рдореЛрдб рдХреЗ рд▓рд┐рдП, reactions `getUpdates` `allowed_updates` рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИрдВ

## Delivery targets (CLI/cron)

- рд▓рдХреНрд╖реНрдп рдХреЗ рд░реВрдк рдореЗрдВ chat id (`123456789`) рдпрд╛ username (`@name`) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
- рдЙрджрд╛рд╣рд░рдг: `openclaw message send --channel telegram --target 123456789 --message "hi"`ред

## Troubleshooting

**рд╕рдореВрд╣ рдореЗрдВ non-mention рд╕рдВрджреЗрд╢реЛрдВ рдкрд░ рдмреЙрдЯ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрддрд╛:**

- рдпрджрд┐ рдЖрдкрдиреЗ `channels.telegram.groups.*.requireMention=false` рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИ, рддреЛ Telegram Bot API **privacy mode** рдЕрдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
  - BotFather: `/setprivacy` тЖТ **Disable** (рдлрд┐рд░ рд╕рдореВрд╣ рд╕реЗ рдмреЙрдЯ рд╣рдЯрд╛рдХрд░ рдкреБрдирдГ рдЬреЛрдбрд╝реЗрдВ)
- `openclaw channels status` рдЪреЗрддрд╛рд╡рдиреА рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрдм config unmentioned group messages рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред
- `openclaw channels status --probe` рд╕реНрдкрд╖реНрдЯ numeric group IDs рдХреЗ рд▓рд┐рдП рд╕рджрд╕реНрдпрддрд╛ рдХреА рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдпрд╣ wildcard `"*"` рдирд┐рдпрдореЛрдВ рдХрд╛ audit рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛)ред
- Quick test: `/activation always` (рдХреЗрд╡рд▓ session; рд╕реНрдерд╛рдпрд┐рддреНрд╡ рдХреЗ рд▓рд┐рдП config рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)

**рдмреЙрдЯ рд╕рдореВрд╣ рд╕рдВрджреЗрд╢ рдмрд┐рд▓реНрдХреБрд▓ рдирд╣реАрдВ рджреЗрдЦ рдкрд╛ рд░рд╣рд╛:**

- рдпрджрд┐ `channels.telegram.groups` рд╕реЗрдЯ рд╣реИ, рддреЛ рд╕рдореВрд╣ рд╕реВрдЪреАрдмрджреНрдз рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ `"*"` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП
- @BotFather рдореЗрдВ Privacy Settings рдЬрд╛рдБрдЪреЗрдВ тЖТ "Group Privacy" **OFF** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП
- рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдмреЙрдЯ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рджрд╕реНрдп рд╣реИ (рд╕рд┐рд░реНрдл admin рдирд╣реАрдВ, рдмрд┐рдирд╛ read access)
- Gateway logs рдЬрд╛рдБрдЪреЗрдВ: `openclaw logs --follow` ("skipping group message" рджреЗрдЦреЗрдВ)

**рдмреЙрдЯ mentions рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди `/activation always` рдкрд░ рдирд╣реАрдВ:**

- `/activation` command session state рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди config рдореЗрдВ рд╕реНрдерд╛рдпреА рдирд╣реАрдВ рдХрд░рддрд╛
- рд╕реНрдерд╛рдпреА рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд▓рд┐рдП, рд╕рдореВрд╣ рдХреЛ `channels.telegram.groups` рдореЗрдВ `requireMention: false` рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝реЗрдВ

**`/status` рдЬреИрд╕реЗ commands рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗ:**

- рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХрд╛ Telegram user ID рдЕрдзрд┐рдХреГрдд рд╣реИ (pairing рдпрд╛ `channels.telegram.allowFrom` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)
- commands рдХреЛ authorization рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рднрд▓реЗ рд╣реА рд╕рдореВрд╣ рдореЗрдВ `groupPolicy: "open"` рд╣реЛ

**Node 22+ рдкрд░ long-polling рддреБрд░рдВрдд abort рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ (рдЕрдХреНрд╕рд░ proxies/custom fetch рдХреЗ рд╕рд╛рде):**

- Node 22+ `AbortSignal` instances рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдЦреНрдд рд╣реИ; foreign signals рддреБрд░рдВрдд `fetch` calls abort рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- abort signals рдХреЛ normalize рдХрд░рдиреЗ рд╡рд╛рд▓реЗ OpenClaw build рдореЗрдВ рдЕрдкрдЧреНрд░реЗрдб рдХрд░реЗрдВ, рдпрд╛ рдЕрдкрдЧреНрд░реЗрдб рддрдХ Gateway рдХреЛ Node 20 рдкрд░ рдЪрд▓рд╛рдПрдБред

**рдмреЙрдЯ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдлрд┐рд░ рдЪреБрдкрдЪрд╛рдк рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИ (рдпрд╛ `HttpError: Network request ... failed` рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИ):**

- рдХреБрдЫ hosts рдкрд╣рд▓реЗ `api.telegram.org` рдХреЛ IPv6 рдкрд░ resolve рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдореЗрдВ рдХрд╛рд░реНрдпрд╢реАрд▓ IPv6 egress рдирд╣реАрдВ рд╣реИ, рддреЛ grammY IPv6-only requests рдкрд░ рдЕрдЯрдХ рд╕рдХрддрд╛ рд╣реИред
- рд╕рдорд╛рдзрд╛рди: IPv6 egress рд╕рдХреНрд╖рдо рдХрд░реЗрдВ **рдпрд╛** `api.telegram.org` рдХреЗ рд▓рд┐рдП IPv4 resolution рдХреЛ рдордЬрдмреВрд░ рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг: IPv4 A record рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `/etc/hosts` entry рдЬреЛрдбрд╝реЗрдВ, рдпрд╛ рдЕрдкрдиреЗ OS DNS stack рдореЗрдВ IPv4 рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВ), рдлрд┐рд░ Gateway рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред
- Quick check: DNS рдХреНрдпрд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдпрд╣ рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `dig +short api.telegram.org A` рдФрд░ `dig +short api.telegram.org AAAA`ред

## Configuration reference (Telegram)

рдкреВрд░реНрдг configuration: [Configuration](/gateway/configuration)

Provider рд╡рд┐рдХрд▓реНрдк:

- `channels.telegram.enabled`: рдЪреИрдирд▓ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕рдХреНрд╖рдо/рдЕрдХреНрд╖рдо рдХрд░реЗрдВред
- `channels.telegram.botToken`: рдмреЙрдЯ рдЯреЛрдХрди (BotFather)ред
- `channels.telegram.tokenFile`: рдлрд╝рд╛рдЗрд▓ рдкрде рд╕реЗ рдЯреЛрдХрди рдкрдврд╝реЗрдВред
- `channels.telegram.dmPolicy`: `pairing | allowlist | open | disabled` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: pairing)ред
- `channels.telegram.allowFrom`: DM allowlist (ids/usernames)ред `open` рдХреЗ рд▓рд┐рдП `"*"` рдЖрд╡рд╢реНрдпрдХ рд╣реИред
- `channels.telegram.groupPolicy`: `open | allowlist | disabled` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: allowlist)ред
- `channels.telegram.groupAllowFrom`: group sender allowlist (ids/usernames)ред
- `channels.telegram.groups`: рдкреНрд░рддрд┐-рд╕рдореВрд╣ defaults + allowlist (global defaults рдХреЗ рд▓рд┐рдП `"*"` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред
  - `channels.telegram.groups.<id>.groupPolicy`: groupPolicy (`open | allowlist | disabled`) рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐-рд╕рдореВрд╣ overrideред
  - `channels.telegram.groups.<id>.requireMention`: mention gating defaultред
  - `channels.telegram.groups.<id>.skills`: skill filter (omit = рд╕рднреА skills, empty = рдХреЛрдИ рдирд╣реАрдВ)ред
  - `channels.telegram.groups.<id>.allowFrom`: рдкреНрд░рддрд┐-рд╕рдореВрд╣ sender allowlist overrideред
  - `channels.telegram.groups.<id>.systemPrompt`: рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд system promptред
  - `channels.telegram.groups.<id>.enabled`: `false` рд╣реЛрдиреЗ рдкрд░ рд╕рдореВрд╣ рдЕрдХреНрд╖рдо рдХрд░реЗрдВред
  - `channels.telegram.groups.<id>.topics.<threadId>.*`: рдкреНрд░рддрд┐-рдЯреЙрдкрд┐рдХ overrides (рд╕рдореВрд╣ рдЬреИрд╕реЗ рд╣реА рдлрд╝реАрд▓реНрдбреНрд╕)ред
  - `channels.telegram.groups.<id>.topics.<threadId>.groupPolicy`: groupPolicy (`open | allowlist | disabled`) рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐-рдЯреЙрдкрд┐рдХ overrideред
  - `channels.telegram.groups.<id>.topics.<threadId>.requireMention`: рдкреНрд░рддрд┐-рдЯреЙрдкрд┐рдХ mention gating overrideред
- `channels.telegram.capabilities.inlineButtons`: `off | dm | group | all | allowlist` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: allowlist)ред
- `channels.telegram.accounts.<account>.capabilities.inlineButtons`: рдкреНрд░рддрд┐-рдЦрд╛рддрд╛ overrideред
- `channels.telegram.replyToMode`: `off | first | all` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: `first`)ред
- `channels.telegram.textChunkLimit`: outbound chunk size (chars)ред
- `channels.telegram.chunkMode`: `length` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ) рдпрд╛ рд▓рдВрдмрд╛рдИ chunking рд╕реЗ рдкрд╣рд▓реЗ blank lines (paragraph boundaries) рдкрд░ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `newline`ред
- `channels.telegram.linkPreview`: outbound рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП link previews toggle рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: true)ред
- `channels.telegram.streamMode`: `off | partial | block` (draft streaming)ред
- `channels.telegram.mediaMaxMb`: inbound/outbound media cap (MB)ред
- `channels.telegram.retry`: outbound Telegram API calls рдХреЗ рд▓рд┐рдП retry policy (attempts, minDelayMs, maxDelayMs, jitter)ред
- `channels.telegram.network.autoSelectFamily`: Node autoSelectFamily override (true=enable, false=disable)ред Happy Eyeballs timeouts рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП Node 22 рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдоред
- `channels.telegram.proxy`: Bot API calls рдХреЗ рд▓рд┐рдП proxy URL (SOCKS/HTTP)ред
- `channels.telegram.webhookUrl`: webhook рдореЛрдб рд╕рдХреНрд╖рдо рдХрд░реЗрдВ (рдЗрд╕рдХреЗ рд▓рд┐рдП `channels.telegram.webhookSecret` рдЖрд╡рд╢реНрдпрдХ)ред
- `channels.telegram.webhookSecret`: webhook secret (рдЬрдм webhookUrl рд╕реЗрдЯ рд╣реЛ рддреЛ рдЖрд╡рд╢реНрдпрдХ)ред
- `channels.telegram.webhookPath`: local webhook path (рдбрд┐рдлрд╝реЙрд▓реНрдЯ `/telegram-webhook`)ред
- `channels.telegram.actions.reactions`: Telegram tool reactions gate рдХрд░реЗрдВред
- `channels.telegram.actions.sendMessage`: Telegram tool message sends gate рдХрд░реЗрдВред
- `channels.telegram.actions.deleteMessage`: Telegram tool message deletes gate рдХрд░реЗрдВред
- `channels.telegram.actions.sticker`: Telegram sticker actions тАФ send рдФрд░ search gate рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: false)ред
- `channels.telegram.reactionNotifications`: `off | own | all` тАФ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреМрди-рд╕реА reactions system events рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: рд╕реЗрдЯ рди рд╣реЛрдиреЗ рдкрд░ `own`)ред
- `channels.telegram.reactionLevel`: `off | ack | minimal | extensive` тАФ рдПрдЬреЗрдВрдЯ рдХреА reaction рдХреНрд╖рдорддрд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ: рд╕реЗрдЯ рди рд╣реЛрдиреЗ рдкрд░ `minimal`)ред

Related global рд╡рд┐рдХрд▓реНрдк:

- `agents.list[].groupChat.mentionPatterns` (mention gating patterns)ред
- `messages.groupChat.mentionPatterns` (global fallback)ред
- `commands.native` (рдбрд┐рдлрд╝реЙрд▓реНрдЯ `"auto"` тЖТ Telegram/Discord рдХреЗ рд▓рд┐рдП on, Slack рдХреЗ рд▓рд┐рдП off), `commands.text`, `commands.useAccessGroups` (command рд╡реНрдпрд╡рд╣рд╛рд░)ред `channels.telegram.commands.native` рдХреЗ рд╕рд╛рде override рдХрд░реЗрдВред
- `messages.responsePrefix`, `messages.ackReaction`, `messages.ackReactionScope`, `messages.removeAckAfterReply`ред
