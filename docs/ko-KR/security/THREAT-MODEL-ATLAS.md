# OpenClaw 위협 모델 v1.0

## MITRE ATLAS 프레임워크

**버전:** 1.0-draft
**마지막 업데이트:** 2026-02-04
**메서돌로지:** MITRE ATLAS + 데이터 흐름 다이어그램
**프레임워크:** [MITRE ATLAS](https://atlas.mitre.org/) (AI 시스템의 적대적 위협 환경)

### 프레임워크 명시

이 위협 모델은 AI/ML 시스템에 대한 적대적 위협을 문서화하기 위한 산업 표준 프레임워크인 [MITRE ATLAS](https://atlas.mitre.org/)를 기반으로 구축되었습니다. ATLAS는 [MITRE](https://www.mitre.org/)와 AI 보안 커뮤니티의 협력에 의해 유지됩니다.

**주요 ATLAS 리소스:**

- [ATLAS Techniques](https://atlas.mitre.org/techniques/)
- [ATLAS Tactics](https://atlas.mitre.org/tactics/)
- [ATLAS Case Studies](https://atlas.mitre.org/studies/)
- [ATLAS GitHub](https://github.com/mitre-atlas/atlas-data)
- [Contributing to ATLAS](https://atlas.mitre.org/resources/contribute)

### 이 위협 모델에 기여하기

이 문서는 OpenClaw 커뮤니티에 의해 유지되는 생활 문서입니다. 기여 가이드라인은 [CONTRIBUTING-THREAT-MODEL.md](./CONTRIBUTING-THREAT-MODEL.md)에서 확인할 수 있습니다:

- 새로운 위협 보고
- 기존 위협 업데이트
- 공격 체인 제안
- 완화 제안

---

## 1. 소개

### 1.1 목적

이 위협 모델은 OpenClaw AI 에이전트 플랫폼 및 ClawHub 스킬 마켓플레이스에 대한 적대적 위협을 문서화하며, AI/ML 시스템을 위해 설계된 MITRE ATLAS 프레임워크를 사용합니다.

### 1.2 범위

| 구성 요소              | 포함 여부 | 비고                                             |
| ---------------------- | --------- | ------------------------------------------------ |
| OpenClaw 에이전트 런타임 | 예        | 핵심 에이전트 실행, 도구 호출, 세션               |
| 게이트웨이             | 예        | 인증, 라우팅, 채널 통합                           |
| 채널 통합              | 예        | WhatsApp, Telegram, Discord, Signal, Slack 등    |
| ClawHub 마켓플레이스   | 예        | 스킬 게시, 관리감독, 배포                         |
| MCP 서버              | 예        | 외부 도구 프로바이더                             |
| 사용자 장치           | 부분적    | 모바일 앱, 데스크톱 클라이언트                     |

### 1.3 제외 범위

이 위협 모델에는 명시적으로 제외된 항목이 없습니다.

---

## 2. 시스템 아키텍처

### 2.1 신뢰 경계

```
┌─────────────────────────────────────────────────────────────────┐
│                    UNTRUSTED ZONE                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  WhatsApp   │  │  Telegram   │  │   Discord   │  ...         │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │
│         │                │                │                      │
└─────────┼────────────────┼────────────────┼──────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 1: 채널 접근                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      게이트웨이                           │   │
│  │  • 장치 페어링 (30초 유예 기간)                           │   │
│  │  • AllowFrom / AllowList 검증                             │   │
│  │  • 토큰/비밀번호/Tailscale 인증                           │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 2: 세션 격리                       │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   에이전트 세션                           │   │
│  │  • 세션 키 = 에이전트:채널:동료                          │   │
│  │  • 에이전트 별 도구 정책                                │   │
│  │  • 대화 기록 로깅                                       │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 3: 도구 실행                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                  실행 샌드박스                            │   │
│  │  • Docker 샌드박스 또는 호스트 (exec-approvals)          │   │
│  │  • 노드 원격 실행                                       │   │
│  │  • SSRF 보호 (DNS 고정 + IP 차단)                       │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 4: 외부 콘텐츠                    │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              페치된 URL / 이메일 / 웹후크                 │   │
│  │  • 외부 콘텐츠 래핑 (XML 태그)                             │   │
│  │  • 보안 주의사항 삽입                                      │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 5: 공급망                        │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      CLAWHUB                            │   │
│  │  • 스킬 게시 (semver, SKILL.md 필수)                    │   │
│  │  • 패턴 기반 관리 플래그                                  │   │
│  │  • VirusTotal 스캐닝 (곧 지원 예정)                      │   │
│  │  • GitHub 계정 연령 검증                                 │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 데이터 흐름

| 흐름 | 출처   | 목적지     | 데이터                | 보호                        |
| ---- | ------- | ----------- | ------------------ | -------------------- |
| F1   | 채널  | 게이트웨이 | 사용자 메시지      | TLS, AllowFrom       |
| F2   | 게이트웨이 | 에이전트 | 라우팅된 메시지    | 세션 격리                    |
| F3   | 에이전트 | 도구       | 도구 호출           | 정책 실행                 |
| F4   | 에이전트 | 외부       | web_fetch 요청     | SSRF 차단                |
| F5   | ClawHub | 에이전트 | 스킬 코드            | 관리, 스캐닝               |
| F6   | 에이전트 | 채널       | 응답               | 출력 필터링             |

---

## 3. ATLAS 전술 별 위협 분석

### 3.1 정찰 (AML.TA0002)

#### T-RECON-001: 에이전트 엔드포인트 검색

| 속성                      | 값                                                                   |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0006 - Active Scanning                                 |
| **설명**                 | 공격자가 노출된 OpenClaw 게이트웨이 엔드포인트 검색       |
| **공격 벡터**           | 네트워크 스캐닝, shodan 쿼리, DNS 열거                       |
| **영향받는 구성 요소** | 게이트웨이, 노출된 API 엔드포인트                           |
| **현재 완화 방안**     | Tailscale 인증 옵션, 기본적으로 로컬 루프백 접속           |
| **잔여 리스크**         | 중간 - 공용 게이트웨이 발견 가능                             |
| **추천 사항**           | 안전한 배포 문서화, 검색 엔드포인트에 대한 속도 제한 추가 |

#### T-RECON-002: 채널 통합 탐사

| 속성                      | 값                                                                  |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0006 - Active Scanning                                 |
| **설명**                 | 공격자가 메시지 채널을 탐사하여 AI 관리 계정을 식별        |
| **공격 벡터**           | 테스트 메시지를 보내고 응답 패턴 관찰                       |
| **영향받는 구성 요소** | 모든 채널 통합                                               |
| **현재 완화 방안**     | 특정 없음                                                      |
| **잔여 리스크**         | 낮음 - 발견만으로는 제한된 가치                               |
| **추천 사항**           | 응답 타이밍 무작위화 고려                                   |

---

### 3.2 초기 접근 (AML.TA0004)

#### T-ACCESS-001: 페어링 코드 가로채기

| 속성                      | 값                                                                   |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0040 - AI Model Inference API Access                   |
| **설명**                 | 공격자가 30초 유예 기간 중 페어링 코드를 가로챔           |
| **공격 벡터**           | 어깨 너머 엿보기, 네트워크 스니핑, 사회 공학              |
| **영향받는 구성 요소** | 장치 페어링 시스템                                          |
| **현재 완화 방안**     | 30초 만료, 기존 채널을 통해 코드 전송                     |
| **잔여 리스크**         | 중간 - 유예 기간 악용 가능                                  |
| **추천 사항**           | 유예 기간 단축, 확인 단계 추가                              |

#### T-ACCESS-002: AllowFrom 스푸핑

| 속성                      | 값                                                                      |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0040 - AI Model Inference API Access                   |
| **설명**                 | 공격자가 채널에서 허용된 발신자 신원을 스푸핑                  |
| **공격 벡터**           | 채널에 따라 - 전화번호 스푸핑, 사용자명 사칭                  |
| **영향받는 구성 요소** | 채널별 AllowFrom 검증                                     |
| **현재 완화 방안**     | 채널별 신원 확인                                               |
| **잔여 리스크**         | 중간 - 일부 채널은 스푸핑에 취약                               |
| **추천 사항**           | 채널별 리스크 문서화, 가능한 경우 암호학적 검증 추가      |

#### T-ACCESS-003: 토큰 탈취

| 속성                      | 값                                                                   |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0040 - AI Model Inference API Access                   |
| **설명**                 | 공격자가 구성 파일에서 인증 토큰을 탈취                          |
| **공격 벡터**           | 맬웨어, 무단 기기 액세스, 구성 백업 노출                        |
| **영향받는 구성 요소** | ~/.openclaw/credentials/, 구성 저장소                        |
| **현재 완화 방안**     | 파일 권한 설정                                                   |
| **잔여 리스크**         | 높음 - 평문으로 저장된 토큰                                      |
| **추천 사항**           | 보관 시 토큰 암호화 구현, 토큰 회전 추가                     |

---

### 3.3 실행 (AML.TA0005)

#### T-EXEC-001: 직접 프롬프트 주입

| 속성                      | 값                                                                                    |
| ----------------------- | ----------------------------------------------------------- |
| **ATLAS ID**            | AML.T0051.000 - LLM Prompt Injection: Direct                |
| **설명**                 | 공격자가 에이전트의 행동을 조작하기 위해 설계된 프롬프트를 전송                      |
| **공격 벡터**           | 적대적 지시를 포함한 채널 메시지                             |
| **영향받는 구성 요소** | 에이전트 LLM, 모든 입력 면                                       |
| **현재 완화 방안**     | 패턴 탐지, 외부 콘텐츠 래핑                                 |
| **잔여 리스크**         | 치명적 - 탐지만 되며 차단되지 않음; 정교한 공격은 차단을 우회 |
| **추천 사항**           | 다층 방어 구현, 출력 확인, 민감한 작업에 대해 사용자 확인  |

#### T-EXEC-002: 간접 프롬프트 주입

| 속성                      | 값                                                               |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0051.001 - LLM Prompt Injection: Indirect                  |
| **설명**                 | 공격자가 악의적인 지시를 페치된 콘텐츠에 포함                     |
| **공격 벡터**           | 악의적인 URL, 오염된 이메일, 손상된 웹후크                        |
| **영향받는 구성 요소** | web_fetch, 이메일 수집, 외부 데이터 소스                         |
| **현재 완화 방안**     | XML 태그로 내용 래핑과 보안 경고 포함                          |
| **잔여 리스크**         | 높음 - LLM이 래퍼 지시를 무시할 수 있음                         |
| **추천 사항**           | 콘텐츠 정화 시행, 실행 컨텍스트 분리                             |

#### T-EXEC-003: 도구 인수 주입

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0051.000 - LLM Prompt Injection: Direct                    |
| **설명**                 | 공격자가 프롬프트 주입을 통해 도구 인수를 조작                   |
| **공격 벡터**           | 도구 매개변수 값을 조작하는 설계된 프롬프트                     |
| **영향받는 구성 요소** | 모든 도구 호출                                                   |
| **현재 완화 방안**     | 위험한 명령에 대한 실행 승인                                     |
| **잔여 리스크**         | 높음 - 사용자 판단에 의존                                        |
| **추천 사항**           | 인수 유효성 확인, 매개변수가 있는 도구 호출 구현                |

#### T-EXEC-004: 실행 승인 우회

| 속성                      | 값                                                    |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0043 - Craft Adversarial Data                              |
| **설명**                 | 공격자가 승인 허용 목록을 우회하는 명령어를 작성                |
| **공격 벡터**           | 명령어 난독화, 별칭 악용, 경로 조작                             |
| **영향받는 구성 요소** | exec-approvals.ts, 명령어 허용 목록                              |
| **현재 완화 방안**     | 허용 목록 + 질문 모드                                            |
| **잔여 리스크**         | 높음 - 명령어 정화 없음                                        |
| **추천 사항**           | 명령어 정규화 구현, 블록 목록 확장                              |

---

### 3.4 지속성 (AML.TA0006)

#### T-PERSIST-001: 악의적인 스킬 설치

| 속성                      | 값                                                               |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0010.001 - Supply Chain Compromise: AI Software            |
| **설명**                 | 공격자가 악의적인 스킬을 ClawHub에 게시                          |
| **공격 벡터**           | 계정 생성, 숨겨진 악성 코드를 포함한 스킬 게시                   |
| **영향받는 구성 요소** | ClawHub, 스킬 로딩, 에이전트 실행                              |
| **현재 완화 방안**     | GitHub 계정 연령 검증, 패턴 기반 관리 플래그                   |
| **잔여 리스크**         | 치명적 - 샌드박싱 없음, 제한된 검토                           |
| **추천 사항**           | VirusTotal 통합 (진행 중), 스킬 샌드박싱, 커뮤니티 리뷰       |

#### T-PERSIST-002: 스킬 업데이트 중독

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0010.001 - Supply Chain Compromise: AI Software            |
| **설명**                 | 공격자가 인기 있는 스킬을 손상시키고 악성 업데이트를 푸시     |
| **공격 벡터**           | 계정 손상, 스킬 소유자의 사회 공학 전략                         |
| **영향받는 구성 요소** | ClawHub 버전 관리, 자동 업데이트 흐름                           |
| **현재 완화 방안**     | 버전 지문 인식                                                   |
| **잔여 리스크**         | 높음 - 자동 업데이트로 악성 버전 다운로드 가능                  |
| **추천 사항**           | 업데이트 서명, 롤백 기능, 버전 고정 구현                         |

#### T-PERSIST-003: 에이전트 구성 조작

| 속성                      | 값                                                               |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0010.002 - Supply Chain Compromise: Data                   |
| **설명**                 | 공격자가 에이전트 구성을 수정하여 접근을 지속                          |
| **공격 벡터**           | 구성 파일 수정, 설정 주입                                          |
| **영향받는 구성 요소** | 에이전트 구성, 도구 정책                                          |
| **현재 완화 방안**     | 파일 권한 설정                                                    |
| **잔여 리스크**         | 중간 - 로컬 액세스 필요                                           |
| **추천 사항**           | 구성 무결성 확인 구현, 구성 변경에 대한 감사 로깅                 |

---

### 3.5 방어 회피 (AML.TA0007)

#### T-EVADE-001: 관리 패턴 우회

| 속성                      | 값                                                                  |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0043 - Craft Adversarial Data                               |
| **설명**                 | 공격자가 관리 패턴을 우회할 수 있는 스킬 콘텐츠 작성                 |
| **공격 벡터**           | 유니코드 허모글리프, 인코딩 트릭, 동적 로딩                       |
| **영향받는 구성 요소** | ClawHub moderation.ts                                         |
| **현재 완화 방안**     | 패턴 기반 FLAG_RULES                                          |
| **잔여 리스크**         | 높음 - 단순 정규 표현식은 쉽게 우회 가능                           |
| **추천 사항**           | 행동 분석 추가 (VirusTotal 코드 인사이트), AST 기반 탐지          |

#### T-EVADE-002: 콘텐츠 래퍼 이스케이프

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0043 - Craft Adversarial Data                              |
| **설명**                 | 공격자가 XML 래퍼 컨텍스트를 이스케이프할 수 있는 콘텐츠를 작성 |
| **공격 벡터**           | 태그 조작, 컨텍스트 혼란, 지시 무시                             |
| **영향받는 구성 요소** | 외부 콘텐츠 래핑                                               |
| **현재 완화 방안**     | XML 태그 + 보안 주의사항                                        |
| **잔여 리스크**         | 중간 - 새롭고 흔한 이스케이프 발견                              |
| **추천 사항**           | 다중 래퍼 레이어, 출력 측 유효성 검사                             |

---

### 3.6 검색 (AML.TA0008)

#### T-DISC-001: 도구 나열

| 속성                      | 값                                  |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0040 - AI Model Inference API Access                       |
| **설명**                 | 공격자가 프롬프트를 통해 사용 가능한 도구 나열                  |
| **공격 벡터**           | "어떤 도구가 있습니까?" 스타일의 쿼리                             |
| **영향받는 구성 요소** | 에이전트 도구 레지스트리                                            |
| **현재 완화 방안**     | 특정 없음                                                             |
| **잔여 리스크**         | 낮음 - 도구는 일반적으로 문서화됨                                |
| **추천 사항**           | 도구 가시성 제어 고려                                         |

#### T-DISC-002: 세션 데이터 추출

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0040 - AI Model Inference API Access                       |
| **설명**                 | 공격자가 세션 컨텍스트에서 민감한 데이터를 추출                |
| **공격 벡터**           | "우리가 무엇을 논의했습니까?" 쿼리, 컨텍스트 탐사            |
| **영향받는 구성 요소** | 세션 대본, 컨텍스트 창                                            |
| **현재 완화 방안**     | 보낸 사람 별 세션 격리                                           |
| **잔여 리스크**         | 중간 - 세션 내 데이터 접근 가능                                 |
| **추천 사항**           | 컨텍스트 내 민감한 데이터의 삭제 구현                           |

---

### 3.7 수집 및 유출 (AML.TA0009, AML.TA0010)

#### T-EXFIL-001: web_fetch를 통한 데이터 절도

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0009 - Collection                                          |
| **설명**                 | 공격자가 에이전트에 외부 URL로 데이터를 보내도록 지시하여 유출 |
| **공격 벡터**           | 프롬프트 주입으로 에이전트가 데이터를 공격자 서버에 POST하도록 유도  |
| **영향받는 구성 요소** | web_fetch 도구                                                   |
| **현재 완화 방안**     | 내부 네트워크에 대한 SSRF 차단                                 |
| **잔여 리스크**         | 높음 - 외부 URL 허용                                             |
| **추천 사항**           | URL 허용 목록화, 데이터 분류 인식 구현                           |

#### T-EXFIL-002: 무단 메시지 전송

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0009 - Collection                                          |
| **설명**                 | 공격자가 에이전트가 민감한 데이터를 포함한 메시지를 전송하도록 유도 |
| **공격 벡터**           | 프롬프트 주입으로 에이전트가 공격자에게 메시지를 보내도록 유도      |
| **영향받는 구성 요소** | 메시지 도구, 채널 통합                                          |
| **현재 완화 방안**     | 출력 메시지 게이트                                               |
| **잔여 리스크**         | 중간 - 게이트가 우회될 수 있음                                  |
| **추천 사항**           | 새 수신자에 대해 명시적인 확인 필요                              |

#### T-EXFIL-003: 자격 증명 수집

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0009 - Collection                                          |
| **설명**                 | 악의적인 스킬이 에이전트 컨텍스트에서 자격 증명을 수집         |
| **공격 벡터**           | 스킬 코드가 환경 변수, 구성 파일을 읽음                         |
| **영향받는 구성 요소** | 스킬 실행 환경                                                  |
| **현재 완화 방안**     | 스킬에 대한 특정 없음                                           |
| **잔여 리스크**         | 치명적 - 스킬이 에이전트 권한으로 실행                   |
| **추천 사항**           | 스킬 샌드박싱, 자격 증명 격리                                |

---

### 3.8 영향 (AML.TA0011)

#### T-IMPACT-001: 무단 명령 실행

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - Erode AI Model Integrity                            |
| **설명**                 | 공격자가 사용자 시스템에서 임의의 명령을 실행                   |
| **공격 벡터**           | 프롬프트 주입과 실행 승인 우회 조합                              |
| **영향받는 구성 요소** | Bash 도구, 명령 실행                                            |
| **현재 완화 방안**     | 실행 승인, Docker 샌드박스 옵션                              |
| **잔여 리스크**         | 치명적 - 샌드박스 없이 호스트 실행                               |
| **추천 사항**           | 샌드박스를 기본값으로 설정, 승인 UX 개선                    |

#### T-IMPACT-002: 자원 고갈 (DoS)

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - Erode AI Model Integrity                            |
| **설명**                 | 공격자가 API 크레딧이나 컴퓨팅 자원을 고갈시킴               |
| **공격 벡터**           | 자동 메시지 플러딩, 비싼 도구 호출                              |
| **영향받는 구성 요소** | 게이트웨이, 에이전트 세션, API 프로바이더                        |
| **현재 완화 방안**     | 없음                                                            |
| **잔여 리스크**         | 높음 - 속도 제한 없음                                           |
| **추천 사항**           | 발신자 별 속도 제한, 비용 예산 적용                           |

#### T-IMPACT-003: 평판 손상

| 속성                      | 값                                                             |
| ----------------------- | --------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - Erode AI Model Integrity                            |
| **설명**                 | 공격자가 에이전트에게 유해하거나 공격적인 콘텐츠를 보내도록 유도   |
| **공격 벡터**           | 부적절한 응답을 유도하는 프롬프트 주입                             |
| **영향받는 구성 요소** | 출력 생성, 채널 메시징                                           |
| **현재 완화 방안**     | LLM 프로바이더 콘텐츠 정책                                    |
| **잔여 리스크**         | 중간 - 프로바이더 필터 불완전                                    |
| **추천 사항**           | 출력 필터링 레이어, 사용자 제어 추가                          |

---

## 4. ClawHub 공급망 분석

### 4.1 현재 보안 통제

| 통제                      | 구현                                           | 효율성                                                     |
| -------------------- | --------------------------------------------- | ------------------------------------------------------ |
| GitHub 계정 연령    | `requireGitHubAccountAge()` | 중간 - 새로운 공격자에 대한 기준 상향               |
| 경로 정화                | `sanitizePath()`                          | 높음 - 경로 탐색 방지                                           |
| 파일 유형 확인            | `isTextFile()`                          | 중간 - 텍스트 파일만, 하지만 여전히 악성일 수 있음     |
| 크기 제한                 | 총 번들 50MB                             | 높음 - 자원 소모 방지                                           |
| 필수 SKILL.md        | 필수 설명서                                   | 낮음 - 정보 제공 외 보안 가치 없음                      |
| 패턴 관리                | moderation.ts의 FLAG_RULES          | 낮음 - 쉽게 우회 가능                                        |
| 관리 상태                 | `moderationStatus` 필드                  | 중간 - 수동 검토 가능                                        |

### 4.2 관리 플래그 패턴

현재 `moderation.ts`의 패턴:

```javascript
// 알려진 악성 식별자
/(keepcold131\/ClawdAuthenticatorTool|ClawdAuthenticatorTool)/i

// 의심스러운 키워드
/(malware|stealer|phish|phishing|keylogger)/i
/(api[-_ ]?key|token|password|private key|secret)/i
/(wallet|seed phrase|mnemonic|crypto)/i
/(discord\.gg|webhook|hooks\.slack)/i
/(curl[^\n]+\|\s*(sh|bash))/i
/(bit\.ly|tinyurl\.com|t\.co|goo\.gl|is\.gd)/i
```

**제한 사항:**

- 슬러그, displayName, 요약, frontmatter, 메타데이터, 파일 경로만 검사
- 실제 스킬 코드 내용 분석하지 않음
- 단순 정규 표현식으로 쉽게 우회 가능
- 행동 분석 없음

### 4.3 계획된 개선 사항

| 개선 사항                   | 상태                              | 영향                                                                    |
| ---------------------- | --------------------------------- | --------------------------------------------------------------------- |
| VirusTotal 통합         | 진행 중                           | 높음 - 코드 인사이트 행동 분석                                        |
| 커뮤니티 보고            | 부분적 (`skillReports` 테이블 존재) | 중간                                                                  |
| 감사 로깅                | 부분적 (`auditLogs` 테이블 존재) | 중간                                                                  |
| 배지 시스템               | 구현됨                             | 중간 - `highlighted`, `official`, `deprecated`, `redactionApproved` |

---

## 5. 리스크 매트릭스

### 5.1 가능성 대 영향력

| 위협 ID        | 가능성     | 영향력   | 리스크 수준   | 우선 순위 |
| ------------- | ---------- | -------- | ------------ | -------- |
| T-EXEC-001    | 높음       | 치명적 | **치명적** | P0       |
| T-PERSIST-001 | 높음       | 치명적 | **치명적** | P0       |
| T-EXFIL-003   | 중간       | 치명적 | **치명적** | P0       |
| T-IMPACT-001  | 중간       | 치명적 | **높음**   | P1       |
| T-EXEC-002    | 높음       | 높음     | **높음**   | P1       |
| T-EXEC-004    | 중간       | 높음     | **높음**   | P1       |
| T-ACCESS-003  | 중간       | 높음     | **높음**   | P1       |
| T-EXFIL-001   | 중간       | 높음     | **높음**   | P1       |
| T-IMPACT-002  | 높음       | 중간     | **높음**   | P1       |
| T-EVADE-001   | 높음       | 중간     | **중간**   | P2       |
| T-ACCESS-001  | 낮음       | 높음     | **중간**   | P2       |
| T-ACCESS-002  | 낮음       | 높음     | **중간**   | P2       |
| T-PERSIST-002 | 낮음       | 높음     | **중간**   | P2       |

### 5.2 중요 경로 공격 체인

**공격 체인 1: 스킬 기반 데이터 절도**

```
T-PERSIST-001 → T-EVADE-001 → T-EXFIL-003
(악성 스킬 게시) → (관리 우회) → (자격 증명 수확)
```

**공격 체인 2: 프롬프트 주입에서 RCE로**

```
T-EXEC-001 → T-EXEC-004 → T-IMPACT-001
(프롬프트 주입) → (실행 승인 우회) → (명령 실행)
```

**공격 체인 3: 페치된 콘텐츠를 통한 간접 주입**

```
T-EXEC-002 → T-EXFIL-001 → 외부 유출
(오염된 URL 콘텐츠) → (에이전트가 지시 따라감) → (데이터가 공격자에게 전송)
```

---

## 6. 추천사항 요약

### 6.1 즉시 (P0)

| ID    | 추천사항                                         | 대응                        |
| ----- | ------------------------------------------- | -------------------------- |
| R-001 | VirusTotal 통합 완료                          | T-PERSIST-001, T-EVADE-001 |
| R-002 | 스킬 샌드박싱 구현                              | T-PERSIST-001, T-EXFIL-003 |
| R-003 | 민감한 작업에 대한 출력 검증 추가                | T-EXEC-001, T-EXEC-002     |

### 6.2 단기 (P1)

| ID    | 추천사항                                      | 대응          |
| ----- | ---------------------------------------- | ------------ |
| R-004 | 속도 제한 구현                            | T-IMPACT-002 |
| R-005 | 보관 시 토큰 암호화 추가                   | T-ACCESS-003 |
| R-006 | 실행 승인 UX 및 검증 개선                  | T-EXEC-004   |
| R-007 | web_fetch에 대한 URL 허용 목록화 구현      | T-EXFIL-001  |

### 6.3 중기 (P2)

| ID    | 추천사항                                | 대응           |
| ----- | ------------------------------------- | ------------- |
| R-008 | 가능한 곳에 채널 암호학적 검증 추가   | T-ACCESS-002  |
| R-009 | 구성 무결성 확인 구현                 | T-PERSIST-003 |
| R-010 | 업데이트 서명 및 버전 고정화 추가      | T-PERSIST-002 |

---

## 7. 부록

### 7.1 ATLAS 기술 매핑

| ATLAS ID      | 기술 이름                         | OpenClaw 위협                                                   |
| ------------- | ------------------------------ | ---------------------------------------------------------------- |
| AML.T0006     | Active Scanning              | T-RECON-001, T-RECON-002                                         |
| AML.T0009     | Collection                     | T-EXFIL-001, T-EXFIL-002, T-EXFIL-003                            |
| AML.T0010.001 | 공급망: AI 소프트웨어          | T-PERSIST-001, T-PERSIST-002                                     |
| AML.T0010.002 | 공급망: 데이터                   | T-PERSIST-003                                                    |
| AML.T0031     | AI 모델 무결성 침식            | T-IMPACT-001, T-IMPACT-002, T-IMPACT-003                         |
| AML.T0040     | AI 모델 추론 API 접근        | T-ACCESS-001, T-ACCESS-002, T-ACCESS-003, T-DISC-001, T-DISC-002 |
| AML.T0043     | 적대적 데이터 작성              | T-EXEC-004, T-EVADE-001, T-EVADE-002                             |
| AML.T0051.000 | LLM 프롬프트 주입: 직접        | T-EXEC-001, T-EXEC-003                                           |
| AML.T0051.001 | LLM 프롬프트 주입: 간접        | T-EXEC-002                                                       |

### 7.2 주요 보안 파일

| 경로                                | 목적                          | 리스크 수준   |
| ----------------------------------- | --------------------------- | ------------ |
| `src/infra/exec-approvals.ts`       | 명령어 승인 로직            | **치명적** |
| `src/gateway/auth.ts`               | 게이트웨이 인증             | **치명적** |
| `src/web/inbound/access-control.ts` | 채널 접근 제어              | **치명적** |
| `src/infra/net/ssrf.ts`             | SSRF 보호                   | **치명적** |
| `src/security/external-content.ts`  | 프롬프트 주입 완화          | **치명적** |
| `src/agents/sandbox/tool-policy.ts` | 도구 정책 실행             | **치명적** |
| `convex/lib/moderation.ts`          | ClawHub 관리              | **높음**     |
| `convex/lib/skillPublish.ts`        | 스킬 게시 흐름            | **높음**     |
| `src/routing/resolve-route.ts`      | 세션 격리                 | **중간**   |

### 7.3 용어집

| 용어                      | 정의                                                    |
| -------------------- | ------------------------------------------------------- |
| **ATLAS**            | MITRE의 AI 시스템 적대적 위협 환경.                      |
| **ClawHub**          | OpenClaw의 스킬 마켓플레이스                              |
| **Gateway**          | OpenClaw의 메시지 라우팅 및 인증 계층                      |
| **MCP**              | 모델 컨텍스트 프로토콜 - 도구 프로바이더 인터페이스          |
| **프롬프트 주입**    | 악의적인 지시가 입력에 삽입되는 공격                         |
| **스킬**             | OpenClaw 에이전트용 다운로드 가능한 확장 프로그램          |
| **SSRF**             | 서버 사이드 요청 위조                                  |

---

_이 위협 모델은 살아있는 문서입니다. 보안 문제는 security@openclaw.ai로 신고하세요._
