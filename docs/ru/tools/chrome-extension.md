---
summary: "Расширение Chrome: позвольте OpenClaw управлять вашей существующей вкладкой Chrome"
read_when:
  - Вы хотите, чтобы агент управлял существующей вкладкой Chrome (кнопка на панели инструментов)
  - Вам нужен удалённый Gateway + локальная автоматизация браузера через Tailscale
  - Вы хотите понять последствия для безопасности при перехвате управления браузером
title: "Расширение Chrome"
---

# Расширение Chrome (браузерный релей)

Расширение OpenClaw для Chrome позволяет агенту управлять вашими **существующими вкладками Chrome** (обычное окно Chrome) вместо запуска отдельного профиля Chrome, управляемого OpenClaw.

Подключение и отключение выполняются через **одну кнопку на панели инструментов Chrome**.

## Что это такое (концепция)

Есть три части:

- **Служба управления браузером** (Gateway или узел): API, который вызывает агент/инструмент (через Gateway)
- **Локальный релей-сервер** (loopback CDP): связывает сервер управления и расширение (`http://127.0.0.1:18792` по умолчанию)
- **Расширение Chrome MV3**: подключается к активной вкладке с использованием `chrome.debugger` и передаёт сообщения CDP в релей

Затем OpenClaw управляет подключённой вкладкой через обычную поверхность инструмента `browser` (с выбором нужного профиля).

## Установка / загрузка (распакованное)

1. Установите расширение в стабильный локальный путь:

```bash
openclaw browser extension install
```

2. Выведите путь к установленному каталогу расширения:

```bash
openclaw browser extension path
```

3. Chrome → `chrome://extensions`

- Включите «Developer mode»
- «Load unpacked» → выберите каталог, напечатанный выше

4. Закрепите расширение.

## Обновления (без шага сборки)

Расширение поставляется внутри релиза OpenClaw (npm‑пакет) как статические файлы. Отдельного шага «сборки» нет.

После обновления OpenClaw:

- Повторно запустите `openclaw browser extension install`, чтобы обновить установленные файлы в каталоге состояния OpenClaw.
- Chrome → `chrome://extensions` → нажмите «Reload» у расширения.

## Использование (без дополнительной конфигурации)

OpenClaw поставляется со встроенным профилем браузера с именем `chrome`, который нацелен на релей расширения на порту по умолчанию.

Использование:

- CLI: `openclaw browser --browser-profile chrome tabs`
- Инструмент агента: `browser` с `profile="chrome"`

Если вам нужно другое имя или другой порт релея, создайте собственный профиль:

```bash
openclaw browser create-profile \
  --name my-chrome \
  --driver extension \
  --cdp-url http://127.0.0.1:18792 \
  --color "#00AA00"
```

## Подключение / отключение (кнопка панели инструментов)

- Откройте вкладку, которой должен управлять OpenClaw.
- Нажмите на иконку расширения.
  - Значок показывает `ON` при подключении.
- Нажмите ещё раз, чтобы отключиться.

## Какой вкладкой он управляет?

- Он **не** управляет автоматически «той вкладкой, на которую вы смотрите».
- Он управляет **только вкладкой(ами), которые вы явно подключили**, нажав кнопку панели инструментов.
- Чтобы переключиться: откройте другую вкладку и нажмите там иконку расширения.

## Значок и распространённые ошибки

- `ON`: подключено; OpenClaw может управлять этой вкладкой.
- `…`: подключение к локальному релею.
- `!`: релей недоступен (чаще всего: сервер браузерного релея не запущен на этой машине).

Если вы видите `!`:

- Убедитесь, что Gateway запущен локально (настройка по умолчанию), либо запустите хост узла на этой машине, если Gateway работает где‑то ещё.
- Откройте страницу Options расширения; она показывает, доступен ли релей.

## Удалённый Gateway (использование хоста узла)

### Локальный Gateway (та же машина, что и Chrome) — обычно **без дополнительных шагов**

Если Gateway работает на той же машине, что и Chrome, он запускает службу управления браузером на loopback
и автоматически запускает релей‑сервер. Расширение общается с локальным релеем; вызовы CLI/инструментов идут к Gateway.

### Удалённый Gateway (Gateway работает на другой машине) — **запустите хост узла**

Если ваш Gateway работает на другой машине, запустите хост узла на машине с Chrome.
Gateway будет проксировать действия браузера на этот узел; расширение и релей остаются локальными для машины с браузером.

Если подключено несколько узлов, закрепите один с помощью `gateway.nodes.browser.node` или задайте `gateway.nodes.browser.mode`.

## Sandboxing (контейнеры инструментов)

Если сеанс агента изолирован (`agents.defaults.sandbox.mode != "off"`), инструмент `browser` может быть ограничен:

- По умолчанию изолированные сеансы часто нацелены на **sandbox‑браузер** (`target="sandbox"`), а не на ваш хостовый Chrome.
- Захват управления через релей расширения Chrome требует управления службой управления браузером **хоста**.

Варианты:

- Проще всего: использовать расширение из **неизолированного** сеанса/агента.
- Либо разрешить управление браузером хоста для изолированных сеансов:

```json5
{
  agents: {
    defaults: {
      sandbox: {
        browser: {
          allowHostControl: true,
        },
      },
    },
  },
}
```

Затем убедитесь, что инструмент не запрещён политикой инструментов, и (при необходимости) вызовите `browser` с `target="host"`.

Отладка: `openclaw sandbox explain`

## Советы по удалённому доступу

- Держите Gateway и хост узла в одном tailnet; избегайте открытия портов релея в LAN или публичный Интернет.
- Сопрягайте узлы осознанно; отключите проксирование браузера, если не хотите удалённого управления (`gateway.nodes.browser.mode="off"`).

## Как работает «путь расширения»

`openclaw browser extension path` выводит **установленный** на диске каталог, содержащий файлы расширения.

CLI намеренно **не** выводит путь `node_modules`. Всегда сначала запускайте `openclaw browser extension install`, чтобы скопировать расширение в стабильное расположение внутри каталога состояния OpenClaw.

Если вы переместите или удалите этот каталог установки, Chrome пометит расширение как сломанное, пока вы не перезагрузите его из корректного пути.

## Последствия для безопасности (прочитайте это)

Это мощно и рискованно. Относитесь к этому как к предоставлению модели «рук в вашем браузере».

- Расширение использует API отладки Chrome (`chrome.debugger`). При подключении модель может:
  - кликать/вводить текст/переходить по страницам в этой вкладке
  - читать содержимое страницы
  - получать доступ ко всему, к чему имеет доступ сессия входа во вкладке
- **Это не изолировано**, в отличие от выделенного профиля, управляемого OpenClaw.
  - Если вы подключаетесь к своему повседневному профилю/вкладке, вы предоставляете доступ к состоянию этого аккаунта.

Рекомендации:

- Предпочитайте выделенный профиль Chrome (отдельный от личного браузинга) для использования релея расширения.
- Держите Gateway и любые хосты узлов доступными только в tailnet; полагайтесь на аутентификацию Gateway и сопряжение узлов.
- Избегайте открытия портов релея в LAN (`0.0.0.0`) и избегайте Funnel (публичного).
- Релей блокирует источники, отличные от расширения, и требует внутренний токен аутентификации для клиентов CDP.

Связанное:

- Обзор браузерного инструмента: [Browser](/tools/browser)
- Аудит безопасности: [Security](/gateway/security)
- Настройка Tailscale: [Tailscale](/gateway/tailscale)
