# Cloud.ru AI Fabric — Архитектура

> **Платформа:** Cloud.ru Evolution AI Factory
> **Версия документа:** 1.0
> **Дата:** Февраль 2026

---

## Обзор

Cloud.ru Evolution AI Factory — комплексная платформа для полного цикла работы с искусственным интеллектом: от создания и обучения моделей до запуска, масштабирования и мониторинга AI-приложений в продакшене. Платформа объединяет шесть интегрированных сервисов в единую экосистему.

---

## Состав платформы

| Сервис                | Назначение                     | Ключевые возможности                                                |
| --------------------- | ------------------------------ | ------------------------------------------------------------------- |
| **Foundation Models** | Доступ к генеративным моделям  | 20+ моделей, OpenAI-совместимый API, AI Playground                  |
| **ML Inference**      | Инференс моделей               | Деплой кастомных моделей, автомасштабирование, GPU (V100/A100/H100) |
| **Managed RAG**       | Построение баз знаний          | Индексация документов, векторный поиск, интеграция с агентами       |
| **ML Finetuning**     | Дообучение моделей             | Fine-tuning на собственных данных, LoRA/QLoRA                       |
| **Notebooks**         | Интерактивная среда разработки | Jupyter-подобная среда, GPU-ноутбуки                                |
| **AI Agents**         | Создание и управление агентами | Конструктор агентов, MCP-серверы, мультиагентные системы, A2A       |

---

## Высокоуровневая архитектура

```
┌─────────────────────────────────────────────────────────────┐
│                  Cloud.ru Evolution AI Factory                │
│                                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  Notebooks   │  │  Finetuning  │  │  Foundation   │       │
│  │  (обучение)  │  │  (дообучение)│  │  Models       │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                 │                  │                │
│         ▼                 ▼                  ▼                │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ ML Inference │  │  AI Agents   │  │ Managed RAG  │       │
│  │ (деплой)     │  │  (агенты)    │  │ (знания)     │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
│                                                               │
│  ┌───────────────────────────────────────────────────────┐   │
│  │         Object Storage (S3-compatible, 15 GB free)     │   │
│  └───────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌───────────────────────────────────────────────────────┐   │
│  │  Сеть: Magic Router / Load Balancer v2 / Private Net  │   │
│  └───────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## Архитектура AI-агента

Каждый AI-агент состоит из четырёх компонентов:

```
┌─────────────────────────────────────────────────┐
│                   AI Agent                       │
│                                                  │
│  ┌──────────────┐    ┌──────────────────────┐   │
│  │     LLM      │    │      Промпты         │   │
│  │ (интеллект.  │    │   (инструкции для    │   │
│  │  ядро)       │◄──▶│    поведения)        │   │
│  └──────┬───────┘    └──────────────────────┘   │
│         │                                        │
│         ▼                                        │
│  ┌──────────────┐    ┌──────────────────────┐   │
│  │ Инструменты  │    │   MCP-серверы        │   │
│  │ (tools /     │◄──▶│ (внешние источники   │   │
│  │  function    │    │  данных и сервисов)  │   │
│  │  calling)    │    │                      │   │
│  └──────────────┘    └──────────────────────┘   │
│                                                  │
└─────────────────────────────────────────────────┘
```

- **LLM** — любая модель из каталога Foundation Models или кастомная через ML Inference
- **Промпты** — системный промпт, шаблоны переменных, автоулучшение инструкций
- **Инструменты** — встроенные инструменты, кастомные функции (OpenAI function calling), API-интеграции
- **MCP-серверы** — подключение к базам знаний (Managed RAG), внешним API, файловым хранилищам, БД

---

## Типы агентов

Cloud.ru поддерживает пять архитектурных типов:

### 1. Simple Reactive (Стимул-реакция)

```
Вход (стимул) → LLM → Выход (реакция)
```

Stateless, минимальная задержка. Подходит для FAQ-ботов и классификаторов.

### 2. Model-Based (С накопленным опытом)

```
Вход → [Внутренняя модель + История] → LLM → Выход
                    ↑                      │
                    └──────────────────────┘
```

Сохранение контекста разговора, адаптация поведения.

### 3. Goal-Directed (Целенаправленные)

```
Цель → Планировщик → [Подзадача 1] → [Подзадача 2] → ... → Результат
```

Декомпозиция задач, многошаговое планирование, множество инструментов.

### 4. Utility-Maximizing (Оптимизирующие)

```
Вход → Оценка вариантов → Выбор оптимального → Действие → Результат
```

Принятие решений на основе функции полезности с учётом ограничений.

### 5. Learning AI Agents (Самообучающиеся через MCP)

```
Вход → Агент → Действие → Среда → Обратная связь
                  ↑                      │
                  └─ Обучение (MCP) ─────┘
```

Накопление опыта, адаптация стратегий, интеграция с внешними хранилищами знаний.

---

## Мультиагентные системы

### Протоколы взаимодействия

| Протокол | Направление   | Назначение                                        |
| -------- | ------------- | ------------------------------------------------- |
| **MCP**  | Agent → Tool  | Взаимодействие агента с инструментами и сервисами |
| **A2A**  | Agent → Agent | Прямое взаимодействие между агентами              |

### Модели оркестрации

**Централизованная (Hub-and-Spoke):**

```
         Оркестратор
        /     |     \
    Agent A  Agent B  Agent C
```

**Последовательная (Pipeline):**

```
Agent A → Agent B → Agent C → Результат
```

**Параллельная (Fan-out/Fan-in):**

```
              ┌─ Agent A ─┐
Задача ───────┼─ Agent B ─┼─── Агрегация
              └─ Agent C ─┘
```

### A2A Router MCP Server

Cloud.ru предоставляет A2A Router MCP Server (от cloud-ru-tech, на базе Google ADK) — маршрутизатор между агентами:

- **Discovery** — автоматическое обнаружение агентов по Agent Cards
- **Routing** — маршрутизация запросов к подходящему агенту
- **Load Balancing** — балансировка нагрузки
- **Error Handling** — обработка ошибок и fallback-стратегии

---

## Механизмы устойчивости

| Механизм                 | Описание                                          |
| ------------------------ | ------------------------------------------------- |
| **Circuit Breaker**      | Отключение агента при превышении порога ошибок    |
| **Retry with Backoff**   | Повторные попытки с экспоненциальной задержкой    |
| **Timeout Management**   | Таймауты на уровне агента и системы               |
| **Fallback Agents**      | Резервные агенты при недоступности основных       |
| **Health Checks**        | Проверки здоровья агентов                         |
| **Graceful Degradation** | Деградация функциональности вместо полного отказа |

---

## Архитектура интеграции с OpenClaw

```
┌──────────────────────────────────────────────────────────────┐
│                   Cloud.ru Evolution Cloud                     │
│                                                                │
│  ┌────────────────────────────────────────────────────────┐   │
│  │           Evolution VM (OpenClaw Bot Host)              │   │
│  │                                                          │   │
│  │  ┌──────────────┐      ┌──────────────────────┐        │   │
│  │  │   Bot Core   │      │  Claude Code CLI      │        │   │
│  │  │   Engine     │──────│  (Optional Swarm)     │        │   │
│  │  └──────┬───────┘      └──────────┬───────────┘        │   │
│  │         │                         │                      │   │
│  │         ▼                         ▼                      │   │
│  │  ┌──────────────────────────────────────────────┐       │   │
│  │  │     Cloud.ru AI Services Client              │       │   │
│  │  │  - Foundation Models  - AI Agents            │       │   │
│  │  │  - Managed RAG        - ML Inference         │       │   │
│  │  └──────────────────────────────────────────────┘       │   │
│  └─────────────────────────┬────────────────────────────────┘   │
│                            │ API Calls (Private Network)        │
│                            ▼                                    │
│  ┌────────────────────────────────────────────────────────┐   │
│  │           Evolution AI Factory Services                 │   │
│  │  Foundation Models │ AI Agents │ Managed RAG │ ML Inf. │   │
│  └────────────────────────────────────────────────────────┘   │
└──────────────────────────────────────────────────────────────┘
```

### Сетевые аспекты

- **Внутренняя сеть** — VM и AI-сервисы в одном облаке = низкая задержка
- **Magic Router** — связность ресурсов в частной сети
- **Load Balancer v2** — балансировка трафика между зонами доступности
- **Private Network** — рекомендуется для вызовов AI-сервисов

---

## Ссылки

- [Cloud.ru Evolution AI Factory](https://cloud.ru/products/evolution-ai-factory)
- [Evolution AI Agents](https://cloud.ru/products/evolution-ai-agents)
- [Foundation Models](https://cloud.ru/products/evolution-foundation-models)
- [Managed RAG](https://cloud.ru/docs/rag/ug/index)
- [ML Inference](https://cloud.ru/products/evolution-ml-inference)
