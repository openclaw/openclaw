---
summary: "Обработка даты и времени в конвертах, промптах, инструментах и коннекторах"
read_when:
  - Вы изменяете способ отображения временных меток для модели или пользователей
  - Вы отлаживаете форматирование времени в сообщениях или выводе системного промпта
title: "Дата и время"
---

# Дата и время

По умолчанию OpenClaw использует **локальное время хоста для временных меток транспорта** и **часовой пояс пользователя только в системном промпте**.
Временные метки провайдера сохраняются, чтобы инструменты сохраняли свою нативную семантику (текущее время доступно через `session_status`).

## Конверты сообщений (по умолчанию — локальные)

Входящие сообщения оборачиваются временной меткой (с точностью до минуты):

```
[Provider ... 2026-01-05 16:26 PST] message text
```

Эта временная метка конверта **по умолчанию локальна для хоста**, независимо от часового пояса провайдера.

Вы можете переопределить это поведение:

```json5
{
  agents: {
    defaults: {
      envelopeTimezone: "local", // "utc" | "local" | "user" | IANA timezone
      envelopeTimestamp: "on", // "on" | "off"
      envelopeElapsed: "on", // "on" | "off"
    },
  },
}
```

- `envelopeTimezone: "utc"` использует UTC.
- `envelopeTimezone: "local"` использует часовой пояс хоста.
- `envelopeTimezone: "user"` использует `agents.defaults.userTimezone` (с откатом к часовому поясу хоста).
- Используйте явный IANA‑часовой пояс (например, `"America/Chicago"`) для фиксированной зоны.
- `envelopeTimestamp: "off"` удаляет абсолютные временные метки из заголовков конвертов.
- `envelopeElapsed: "off"` удаляет суффиксы прошедшего времени (стиль `+2m`).

### Примеры

**Локально (по умолчанию):**

```
[WhatsApp +1555 2026-01-18 00:19 PST] hello
```

**Часовой пояс пользователя:**

```
[WhatsApp +1555 2026-01-18 00:19 CST] hello
```

**С включённым прошедшим временем:**

```
[WhatsApp +1555 +30s 2026-01-18T05:19Z] follow-up
```

## Системный промпт: текущие дата и время

Если часовой пояс пользователя известен, системный промпт включает отдельный раздел
**«Текущие дата и время»** только с **часовым поясом** (без часов/формата времени),
чтобы сохранить стабильность кэширования промпта:

```
Time zone: America/Chicago
```

Когда агенту требуется текущее время, используйте инструмент `session_status`; карточка
статуса включает строку с временной меткой.

## Строки системных событий (по умолчанию — локальные)

Поставленные в очередь системные события, вставляемые в контекст агента, предваряются временной меткой с использованием
того же выбора часового пояса, что и для конвертов сообщений (по умолчанию: локальный часовой пояс хоста).

```
System: [2026-01-12 12:19:17 PST] Model switched.
```

### Настройка часового пояса пользователя и формата

```json5
{
  agents: {
    defaults: {
      userTimezone: "America/Chicago",
      timeFormat: "auto", // auto | 12 | 24
    },
  },
}
```

- `userTimezone` задаёт **локальный часовой пояс пользователя** для контекста промпта.
- `timeFormat` управляет **отображением 12ч/24ч** в промпте. `auto` следует настройкам ОС.

## Определение формата времени (авто)

Когда `timeFormat: "auto"`, OpenClaw проверяет предпочтения ОС (macOS/Windows)
и при необходимости использует форматирование по локали. Определённое значение **кэшируется на процесс**
во избежание повторных системных вызовов.

## Полезные нагрузки инструментов и коннекторы (сырое время провайдера + нормализованные поля)

Инструменты каналов возвращают **нативные для провайдера временные метки** и добавляют нормализованные поля для согласованности:

- `timestampMs`: миллисекунды эпохи (UTC)
- `timestampUtc`: строка ISO 8601 UTC

Сырые поля провайдера сохраняются, чтобы ничего не терялось.

- Slack: строкоподобные значения эпохи из API
- Discord: временные метки ISO в UTC
- Telegram/WhatsApp: специфичные для провайдера числовые/ISO‑временные метки

Если вам нужно локальное время, преобразуйте его ниже по конвейеру, используя известный часовой пояс.

## Связанная документация

- [System Prompt](/concepts/system-prompt)
- [Timezones](/concepts/timezone)
- [Messages](/concepts/messages)
